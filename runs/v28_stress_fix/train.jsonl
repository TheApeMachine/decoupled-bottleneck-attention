{"type":"meta","step":0,"env":{"time":"2025-12-17T07:22:00+01:00","python":"3.12.12 (main, Oct  9 2025, 11:07:00) [Clang 17.0.0 (clang-1700.0.13.3)]","platform":"macOS-15.6-arm64-arm-64bit","torch":"2.9.1","device":"mps","triton_available":false},"argv":["v28_transformer_decoupled_bottleneck_instrumented.py","--data","fineweb_100m.tokens","--data-format","text","--out-dir","runs/v28_stress_fix","--attn-mode","standard","--d-model","1024","--layers","12","--block","2048","--batch-size","1","--grad-accum","32","--optimizer","lion","--lr","1e-4","--grad-checkpoint","--amp","--amp-dtype","bf16","--instrument","basic"],"args":{"size":null,"exp":null,"run_root":"runs","run_tag":null,"print_config":false,"data":"fineweb_100m.tokens","data_format":"text","data_dtype":"uint16","vocab_size":null,"val_frac":0.1,"out_dir":"runs/v28_stress_fix","seed":1337,"device":null,"compile":false,"compile_mode":"default","amp":true,"amp_dtype":"bf16","param_dtype":"fp32","matmul_precision":"high","layers":12,"d_model":1024,"n_head":8,"d_ff":2048,"block":2048,"embed_dim":512,"attn_mode":"standard","kv_head":null,"attn_dim":512,"sem_dim":32,"geo_dim":64,"no_rope":false,"rope":false,"rope_base":10000.0,"tie_qk":false,"no_tie_qk":false,"null_attn":false,"no_null_attn":false,"no_learned_temp":false,"mlp":"swiglu","dropout":0.0,"steps":6000,"batch_size":1,"grad_accum":32,"train_seq_len":0,"seq_schedule":null,"eval_seq_len":0,"grad_checkpoint":true,"optimizer":"lion","adam_betas":"0.9,0.95","adam_eps":1e-08,"lion_betas":"0.9,0.99","lr":0.0001,"lr_schedule":"constant","warmup_steps":0,"min_lr":0.0,"opt_foreach":false,"opt_fused":false,"weight_decay":0.1,"grad_clip":1.0,"save_every":0,"eval_every":200,"eval_iters":20,"log_every":100,"instrument":"basic","analysis_every":100,"analysis_max_tokens":256,"analysis_layers":"0,-1","analysis_heads":"0","analysis_topk":8,"analysis_local_window":32,"analysis_save_scores":false,"live":"auto","live_update_every":1,"sync_timing":false,"live_plot":false,"tb":false,"mode":"train","ckpt":null,"prompt_tokens":"0","max_new_tokens":50,"temperature":1.0,"top_k":null,"kv_cache":"fp16","kv_qblock":32,"kv_residual":128,"kv_decode_block":1024,"kv_fused":"auto","self_opt":"none","self_opt_cache":null,"self_opt_decode_blocks":"256,512,1024,2048","self_opt_block_n":"128","self_opt_warps":"4,8","self_opt_stages":"2,3","self_opt_warmup":1,"self_opt_iters":3,"self_opt_interval":256,"self_opt_hysteresis":0.03,"self_opt_verbose":false,"self_opt_verify":false,"self_opt_verify_tol":0.005,"self_opt_scope":"all","self_opt_residuals":"0,32,64,128","self_opt_qblocks":"16,32,64","self_opt_k_sem_kinds":"q4_0,nf4,q8_0,fp16","self_opt_k_geo_kinds":"q8_0,q4_0,fp16","self_opt_v_kinds":"q4_0,q8_0,fp16","self_opt_mem_budget_mb":null,"self_opt_mem_overhead_frac":0.1,"self_opt_policy_prefix_len":null,"self_opt_policy_warmup":1,"self_opt_policy_iters":3,"self_opt_policy_hysteresis":0.02,"self_opt_prefer_low_mem_within":0.02,"self_opt_policy_quality":false,"self_opt_calib_tokens":null,"self_opt_calib_prefill":64,"self_opt_calib_decode":8,"self_opt_quality_tol":0.5,"kv_cache_k":null,"kv_cache_v":null,"kv_cache_k_sem":null,"kv_cache_k_geo":null,"kv_qblock_k":null,"kv_qblock_v":null,"kv_qblock_k_sem":null,"kv_qblock_k_geo":null,"tokenizer":"word"},"config":{"vocab_size":50257,"block_size":2048,"n_layer":12,"n_head":8,"kv_head":null,"d_model":1024,"d_ff":2048,"embed_dim":512,"attn_mode":"standard","attn_dim":512,"sem_dim":32,"geo_dim":64,"rope":true,"rope_base":10000.0,"tie_qk":false,"null_attn":false,"learned_temp":true,"mlp":"swiglu","dropout":0.0},"wall_time":"2025-12-17T07:22:00+01:00"}
{"type":"mem","step":0,"kv_ctx_bytes":100663296,"kv_128k_bytes":6291456000,"data_format":"text","data_dtype":"uint16","n_tokens_total":100002129,"n_tokens_train":90001916,"n_tokens_val":10000213,"vocab_size":50257,"wall_time":"2025-12-17T07:22:00+01:00"}
{"type":"eval","step":0,"train_loss":10.893952941894531,"val_loss":10.879713439941407,"val_ppl":53088.38472754124,"best_val":10.879713439941407,"wall_time":"2025-12-17T07:22:05+01:00"}
{"type":"train","step":1,"loss":10.886886596679688,"ppl":53470.56511334885,"lr":0.0001,"tok_s":4505.859491742265,"seq_len":2048,"grad_accum":32,"global_batch":32,"step_ms":14544.616875005886,"data_ms":101.81970614939928,"fwd_ms":4698.105668881908,"bwd_ms":9547.734373772983,"opt_ms":183.8272499735467,"grad_clip_norm":Infinity,"opt_state_bytes":610642304,"mps_mem_alloc_bytes":2403908096.0,"mps_mem_driver_bytes":6060965888.0,"cpu_rss_bytes":2921037824.0,"grad_norm_embed":0.0,"grad_norm_attn":0.0,"grad_norm_ffn":0.0,"grad_norm_attn_sem":0.0,"grad_norm_attn_geo":0.0,"grad_norm_total":0.0,"wall_time":"2025-12-17T07:22:20+01:00"}
