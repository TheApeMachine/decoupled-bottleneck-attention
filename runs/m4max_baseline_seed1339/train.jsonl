{"type":"meta","step":0,"env":{"time":"2025-12-17T22:06:59+01:00","python":"3.12.12 (main, Oct  9 2025, 11:07:00) [Clang 17.0.0 (clang-1700.0.13.3)]","platform":"macOS-15.6-arm64-arm-64bit","torch":"2.9.1","device":"mps","triton_available":false},"argv":["v29_transformer_decoupled_bottleneck_instrumented.py","--mode","train","--device","mps","--data","fineweb_100m.npy","--data-format","npy","--vocab-size","50257","--steps","6000","--d-model","768","--layers","12","--n-head","12","--d-ff","3072","--embed-dim","512","--optimizer","lion","--lr","3e-4","--batch-size","8","--grad-accum","2","--train-seq-len","512","--seq-schedule","256@0,512@500,1024@2000","--eval-every","200","--eval-iters","20","--log-every","10","--instrument","full","--analysis-every","100","--live","rich","--param-dtype","bf16","--amp","--amp-dtype","bf16","--seed","1339","--out-dir","runs/m4max_baseline_seed1339","--attn-mode","standard"],"args":{"size":null,"exp":null,"run_root":"runs","run_tag":null,"print_config":false,"data":"fineweb_100m.npy","data_format":"npy","data_dtype":"uint16","vocab_size":50257,"val_frac":0.1,"out_dir":"runs/m4max_baseline_seed1339","seed":1339,"device":"mps","compile":false,"compile_mode":"default","amp":true,"amp_dtype":"bf16","param_dtype":"bf16","matmul_precision":"high","layers":12,"d_model":768,"n_head":12,"d_ff":3072,"block":256,"embed_dim":512,"attn_mode":"standard","kv_head":null,"attn_dim":512,"sem_dim":32,"geo_dim":64,"no_rope":false,"rope":false,"rope_base":10000.0,"tie_qk":false,"no_tie_qk":false,"null_attn":false,"no_null_attn":false,"no_learned_temp":false,"mlp":"swiglu","dropout":0.0,"steps":6000,"batch_size":8,"grad_accum":2,"train_seq_len":512,"seq_schedule":"256@0,512@500,1024@2000","eval_seq_len":0,"grad_checkpoint":false,"optimizer":"lion","adam_betas":"0.9,0.95","adam_eps":1e-08,"lion_betas":"0.9,0.99","lr":0.0003,"lr_schedule":"constant","warmup_steps":0,"min_lr":0.0,"opt_foreach":false,"opt_fused":false,"weight_decay":0.1,"grad_clip":1.0,"save_every":0,"eval_every":200,"eval_iters":20,"log_every":10,"instrument":"full","analysis_every":100,"analysis_max_tokens":256,"analysis_layers":"0,-1","analysis_heads":"0","analysis_topk":8,"analysis_local_window":32,"analysis_save_scores":false,"live":"rich","live_update_every":1,"sync_timing":false,"live_plot":false,"tb":false,"mode":"train","ckpt":null,"prompt_tokens":"0","max_new_tokens":50,"temperature":1.0,"top_k":null,"kv_cache":"fp16","kv_qblock":32,"kv_residual":128,"kv_decode_block":1024,"kv_fused":"auto","self_opt":"none","self_opt_cache":null,"self_opt_decode_blocks":"256,512,1024,2048","self_opt_block_n":"128","self_opt_warps":"4,8","self_opt_stages":"2,3","self_opt_warmup":1,"self_opt_iters":3,"self_opt_interval":256,"self_opt_hysteresis":0.03,"self_opt_verbose":false,"self_opt_verify":false,"self_opt_verify_tol":0.005,"self_opt_scope":"all","self_opt_residuals":"0,32,64,128","self_opt_qblocks":"16,32,64","self_opt_k_sem_kinds":"q4_0,nf4,q8_0,fp16","self_opt_k_geo_kinds":"q8_0,q4_0,fp16","self_opt_v_kinds":"q4_0,q8_0,fp16","self_opt_mem_budget_mb":null,"self_opt_mem_overhead_frac":0.1,"self_opt_policy_prefix_len":null,"self_opt_policy_warmup":1,"self_opt_policy_iters":3,"self_opt_policy_hysteresis":0.02,"self_opt_prefer_low_mem_within":0.02,"self_opt_policy_quality":false,"self_opt_calib_tokens":null,"self_opt_calib_prefill":128,"self_opt_calib_decode":32,"self_opt_quality_tol":0.5,"self_opt_quality_delta_nll_tol":0.02,"self_opt_quality_ppl_ratio_tol":1.02,"self_opt_quality_kl_tol":null,"self_opt_quality_kl":false,"kv_cache_k":null,"kv_cache_v":null,"kv_cache_k_sem":null,"kv_cache_k_geo":null,"kv_qblock_k":null,"kv_qblock_v":null,"kv_qblock_k_sem":null,"kv_qblock_k_geo":null,"tokenizer":"word"},"config":{"vocab_size":50257,"block_size":256,"n_layer":12,"n_head":12,"kv_head":null,"d_model":768,"d_ff":3072,"embed_dim":512,"attn_mode":"standard","attn_dim":512,"sem_dim":32,"geo_dim":64,"rope":true,"rope_base":10000.0,"tie_qk":false,"null_attn":false,"learned_temp":true,"mlp":"swiglu","dropout":0.0},"wall_time":"2025-12-17T22:06:59+01:00"}
{"type":"mem","step":0,"kv_ctx_bytes":9437184,"kv_128k_bytes":4718592000,"data_format":"npy","data_dtype":"uint16","n_tokens_total":100000000,"n_tokens_train":90000000,"n_tokens_val":10000000,"vocab_size":50257,"wall_time":"2025-12-17T22:06:59+01:00"}
{"type":"eval","step":0,"train_loss":10.855601501464843,"val_loss":10.856346130371094,"val_ppl":51862.23372460416,"best_val":10.856346130371094,"wall_time":"2025-12-17T22:07:03+01:00"}
{"type":"train","step":1,"loss":10.5455322265625,"ppl":38007.250630095215,"lr":0.0003,"tok_s":7410.973549644468,"seq_len":256,"grad_accum":2,"global_batch":16,"step_ms":552.6939170085825,"data_ms":2.6835830067284405,"fwd_ms":104.4604589114897,"bwd_ms":250.11775002349168,"opt_ms":194.82316600624472,"grad_clip_norm":3.359375,"opt_state_bytes":279605536,"mps_mem_alloc_bytes":1555405824.0,"mps_mem_driver_bytes":5955076096.0,"cpu_rss_bytes":1033797632.0,"grad_norm_embed":0.554962748080662,"grad_norm_attn":0.6846436503690364,"grad_norm_ffn":0.46453136578336135,"grad_norm_attn_sem":0.0,"grad_norm_attn_geo":0.0,"grad_norm_total":0.996247945816921,"wall_time":"2025-12-17T22:07:04+01:00"}
{"type":"train","step":10,"loss":8.551868438720703,"ppl":5176.4172155609585,"lr":0.0003,"tok_s":9021.766354726838,"seq_len":256,"grad_accum":2,"global_batch":16,"step_ms":454.0130877867341,"data_ms":4.52199500028251,"fwd_ms":90.13180987029854,"bwd_ms":251.00881011328764,"opt_ms":107.65629634261131,"grad_clip_norm":5.375,"opt_state_bytes":279605536,"mps_mem_alloc_bytes":1553469440.0,"mps_mem_driver_bytes":7037206528.0,"cpu_rss_bytes":1045774336.0,"grad_norm_embed":1.0016301721182488,"grad_norm_attn":0.02486479989185926,"grad_norm_ffn":0.031964055427523695,"grad_norm_attn_sem":0.0,"grad_norm_attn_geo":0.0,"grad_norm_total":1.0024484828711493,"wall_time":"2025-12-17T22:07:08+01:00"}
{"type":"train","step":20,"loss":7.8805389404296875,"ppl":2645.2978335502653,"lr":0.0003,"tok_s":9067.327536938912,"seq_len":256,"grad_accum":2,"global_batch":16,"step_ms":451.73177910619415,"data_ms":4.569737397832796,"fwd_ms":92.2399915929418,"bwd_ms":249.0423292038031,"opt_ms":105.20352508756332,"grad_clip_norm":10.0625,"opt_state_bytes":279605536,"mps_mem_alloc_bytes":1553469440.0,"mps_mem_driver_bytes":7012040704.0,"cpu_rss_bytes":1053081600.0,"grad_norm_embed":1.0041851078878226,"grad_norm_attn":0.008896123149857679,"grad_norm_ffn":0.016439548710836527,"grad_norm_attn_sem":0.0,"grad_norm_attn_geo":0.0,"grad_norm_total":1.0043590646141405,"wall_time":"2025-12-17T22:07:12+01:00"}
{"type":"train","step":30,"loss":8.016353607177734,"ppl":3030.108199215002,"lr":0.0003,"tok_s":9263.425298267153,"seq_len":256,"grad_accum":2,"global_batch":16,"step_ms":442.16905389912426,"data_ms":4.558653983986005,"fwd_ms":88.29338739742525,"bwd_ms":245.74455009424128,"opt_ms":102.91442910092883,"grad_clip_norm":3.765625,"opt_state_bytes":279605536,"mps_mem_alloc_bytes":1553469440.0,"mps_mem_driver_bytes":7012040704.0,"cpu_rss_bytes":1058258944.0,"grad_norm_embed":0.9952537648745352,"grad_norm_attn":0.026216751800116875,"grad_norm_ffn":0.06639857054795836,"grad_norm_attn_sem":0.0,"grad_norm_attn_geo":0.0,"grad_norm_total":0.9978106758011249,"wall_time":"2025-12-17T22:07:17+01:00"}
{"type":"train","step":40,"loss":7.885368347167969,"ppl":2658.1039508169556,"lr":0.0003,"tok_s":9250.169517871527,"seq_len":256,"grad_accum":2,"global_batch":16,"step_ms":442.8026958950795,"data_ms":4.522807995090261,"fwd_ms":89.1112876823172,"bwd_ms":243.4235876018647,"opt_ms":105.0363170041237,"grad_clip_norm":2.28125,"opt_state_bytes":279605536,"mps_mem_alloc_bytes":1553469440.0,"mps_mem_driver_bytes":7012040704.0,"cpu_rss_bytes":1064124416.0,"grad_norm_embed":0.990059878383632,"grad_norm_attn":0.027058466484355073,"grad_norm_ffn":0.06334580741298018,"grad_norm_attn_sem":0.0,"grad_norm_attn_geo":0.0,"grad_norm_total":0.9924532304901322,"wall_time":"2025-12-17T22:07:21+01:00"}
{"type":"train","step":50,"loss":6.819171905517578,"ppl":915.2268019256431,"lr":0.0003,"tok_s":9110.908292811931,"seq_len":256,"grad_accum":2,"global_batch":16,"step_ms":449.57098330487497,"data_ms":4.874758201185614,"fwd_ms":90.93473758548498,"bwd_ms":248.21492520277388,"opt_ms":104.90710400626995,"grad_clip_norm":13.125,"opt_state_bytes":279605536,"mps_mem_alloc_bytes":1553469440.0,"mps_mem_driver_bytes":7012040704.0,"cpu_rss_bytes":1068580864.0,"grad_norm_embed":1.0005058050279994,"grad_norm_attn":0.003708578354358961,"grad_norm_ffn":0.009973721300382694,"grad_norm_attn_sem":0.0,"grad_norm_attn_geo":0.0,"grad_norm_total":1.0005623891415831,"wall_time":"2025-12-17T22:07:26+01:00"}
{"type":"train","step":60,"loss":7.835124969482422,"ppl":2527.851393905229,"lr":0.0003,"tok_s":9264.212293915636,"seq_len":256,"grad_accum":2,"global_batch":16,"step_ms":442.1314915991388,"data_ms":4.832195694325492,"fwd_ms":87.81101259519346,"bwd_ms":245.40670799906366,"opt_ms":103.4374668088276,"grad_clip_norm":1.9765625,"opt_state_bytes":279605536,"mps_mem_alloc_bytes":1553469440.0,"mps_mem_driver_bytes":7012040704.0,"cpu_rss_bytes":1073790976.0,"grad_norm_embed":1.001793205938208,"grad_norm_attn":0.019898091901686794,"grad_norm_ffn":0.047634140417171726,"grad_norm_attn_sem":0.0,"grad_norm_attn_geo":0.0,"grad_norm_total":1.0031224117018638,"wall_time":"2025-12-17T22:07:30+01:00"}
{"type":"train","step":70,"loss":7.95496940612793,"ppl":2849.701144336258,"lr":0.0003,"tok_s":9274.470697247983,"seq_len":256,"grad_accum":2,"global_batch":16,"step_ms":441.64245418505743,"data_ms":4.319612309336662,"fwd_ms":89.14915818022564,"bwd_ms":244.923254288733,"opt_ms":102.67060429905541,"grad_clip_norm":4.0,"opt_state_bytes":279605536,"mps_mem_alloc_bytes":1553469440.0,"mps_mem_driver_bytes":7012040704.0,"cpu_rss_bytes":1078181888.0,"grad_norm_embed":0.9985699865712577,"grad_norm_attn":0.012803655458484862,"grad_norm_ffn":0.026366271885141658,"grad_norm_attn_sem":0.0,"grad_norm_attn_geo":0.0,"grad_norm_total":0.9990000660496188,"wall_time":"2025-12-17T22:07:34+01:00"}
{"type":"train","step":80,"loss":3.9153785705566406,"ppl":50.16806006698108,"lr":0.0003,"tok_s":9166.349405840332,"seq_len":256,"grad_accum":2,"global_batch":16,"step_ms":446.85182929970324,"data_ms":4.046233091503382,"fwd_ms":89.89731661276892,"bwd_ms":247.7239916974213,"opt_ms":104.53764998819679,"grad_clip_norm":1.8125,"opt_state_bytes":279605536,"mps_mem_alloc_bytes":1553469440.0,"mps_mem_driver_bytes":7012040704.0,"cpu_rss_bytes":1082949632.0,"grad_norm_embed":0.9976186656042882,"grad_norm_attn":0.05440559967234298,"grad_norm_ffn":0.04616711028422269,"grad_norm_attn_sem":0.0,"grad_norm_attn_geo":0.0,"grad_norm_total":1.000167172681539,"wall_time":"2025-12-17T22:07:39+01:00"}
{"type":"train","step":90,"loss":8.030441284179688,"ppl":3073.0974834033786,"lr":0.0003,"tok_s":9040.154116844564,"seq_len":256,"grad_accum":2,"global_batch":16,"step_ms":453.0896207143087,"data_ms":4.191587487002835,"fwd_ms":90.00260400935076,"bwd_ms":252.7009250130504,"opt_ms":105.57483769371174,"grad_clip_norm":1.5546875,"opt_state_bytes":279605536,"mps_mem_alloc_bytes":1553469440.0,"mps_mem_driver_bytes":7012040704.0,"cpu_rss_bytes":1087356928.0,"grad_norm_embed":0.9997324205743748,"grad_norm_attn":0.020000670929645897,"grad_norm_ffn":0.026881084788880533,"grad_norm_attn_sem":0.0,"grad_norm_attn_geo":0.0,"grad_norm_total":1.0002937230156759,"wall_time":"2025-12-17T22:07:44+01:00"}
{"type":"analysis","step":100,"attn_entropy_mean":0.903578907251358,"attn_topk_mass_mean":0.9545537829399109,"attn_local_mass_mean":0.7888211011886597,"attn_erank_mean":67.46551895141602,"proj_stable_rank_mean":24.085521271961234,"wall_time":"2025-12-17T22:07:48+01:00"}
{"type":"train","step":100,"loss":7.655353546142578,"ppl":2111.92164903366,"lr":0.0003,"tok_s":9020.920425036722,"seq_len":256,"grad_accum":2,"global_batch":16,"step_ms":454.0556625055615,"data_ms":4.199541616253555,"fwd_ms":91.47640349110588,"bwd_ms":252.3086498840712,"opt_ms":105.42475820984691,"grad_clip_norm":0.9140625,"opt_state_bytes":279605536,"mps_mem_alloc_bytes":1554272256.0,"mps_mem_driver_bytes":7035240448.0,"cpu_rss_bytes":1104936960.0,"grad_norm_embed":0.9125972933281207,"grad_norm_attn":0.032679804590323394,"grad_norm_ffn":0.022378189967040784,"grad_norm_attn_sem":0.0,"grad_norm_attn_geo":0.0,"grad_norm_total":0.913456388014269,"wall_time":"2025-12-17T22:07:48+01:00"}
{"type":"train","step":110,"loss":7.979686737060547,"ppl":2921.015874722403,"lr":0.0003,"tok_s":9049.606219157788,"seq_len":256,"grad_accum":2,"global_batch":16,"step_ms":452.61637918883935,"data_ms":4.025616671424359,"fwd_ms":91.69306259136647,"bwd_ms":250.56667101453056,"opt_ms":105.73844569153152,"grad_clip_norm":3.890625,"opt_state_bytes":279605536,"mps_mem_alloc_bytes":1554329600.0,"mps_mem_driver_bytes":7035224064.0,"cpu_rss_bytes":1111998464.0,"grad_norm_embed":1.0009289932541678,"grad_norm_attn":0.006393522648293428,"grad_norm_ffn":0.01265555593342266,"grad_norm_attn_sem":0.0,"grad_norm_attn_geo":0.0,"grad_norm_total":1.0010294150346635,"wall_time":"2025-12-17T22:07:53+01:00"}
{"type":"train","step":120,"loss":7.726554870605469,"ppl":2267.775945726568,"lr":0.0003,"tok_s":9103.488201836897,"seq_len":256,"grad_accum":2,"global_batch":16,"step_ms":449.93742060032673,"data_ms":4.090825002640486,"fwd_ms":90.85928351269104,"bwd_ms":249.3917622952722,"opt_ms":104.97829990345053,"grad_clip_norm":1.4921875,"opt_state_bytes":279605536,"mps_mem_alloc_bytes":1554329600.0,"mps_mem_driver_bytes":7020544000.0,"cpu_rss_bytes":1116340224.0,"grad_norm_embed":1.000138687015304,"grad_norm_attn":0.021602252531900033,"grad_norm_ffn":0.025628854851435227,"grad_norm_attn_sem":0.0,"grad_norm_attn_geo":0.0,"grad_norm_total":1.0007001992505768,"wall_time":"2025-12-17T22:07:57+01:00"}
{"type":"train","step":130,"loss":7.5606231689453125,"ppl":1921.0422743306945,"lr":0.0003,"tok_s":9160.27709278772,"seq_len":256,"grad_accum":2,"global_batch":16,"step_ms":447.14804568793625,"data_ms":4.356312414165586,"fwd_ms":90.60593728790991,"bwd_ms":247.2740708035417,"opt_ms":104.3118790956214,"grad_clip_norm":1.4921875,"opt_state_bytes":279605536,"mps_mem_alloc_bytes":1554329600.0,"mps_mem_driver_bytes":7020544000.0,"cpu_rss_bytes":1120534528.0,"grad_norm_embed":0.9976634028514586,"grad_norm_attn":0.038826072964221636,"grad_norm_ffn":0.022633895947817253,"grad_norm_attn_sem":0.0,"grad_norm_attn_geo":0.0,"grad_norm_total":0.998675133652957,"wall_time":"2025-12-17T22:08:02+01:00"}
{"type":"train","step":140,"loss":7.622051239013672,"ppl":2042.747999635703,"lr":0.0003,"tok_s":9210.393342969306,"seq_len":256,"grad_accum":2,"global_batch":16,"step_ms":444.7149918007199,"data_ms":3.725883405422792,"fwd_ms":89.12981650209986,"bwd_ms":247.68937099725008,"opt_ms":103.5236207768321,"grad_clip_norm":1.21875,"opt_state_bytes":279605536,"mps_mem_alloc_bytes":1554329600.0,"mps_mem_driver_bytes":7020544000.0,"cpu_rss_bytes":1124941824.0,"grad_norm_embed":0.9953429609823478,"grad_norm_attn":0.02424997634558113,"grad_norm_ffn":0.02149500551795432,"grad_norm_attn_sem":0.0,"grad_norm_attn_geo":0.0,"grad_norm_total":0.9958703261931674,"wall_time":"2025-12-17T22:08:06+01:00"}
{"type":"train","step":150,"loss":7.64103889465332,"ppl":2081.90557402738,"lr":0.0003,"tok_s":9187.582353084628,"seq_len":256,"grad_accum":2,"global_batch":16,"step_ms":445.81913310685195,"data_ms":3.578416584059596,"fwd_ms":89.24711670260876,"bwd_ms":247.35935010248795,"opt_ms":104.96871648938395,"grad_clip_norm":2.453125,"opt_state_bytes":279605536,"mps_mem_alloc_bytes":1554329600.0,"mps_mem_driver_bytes":7020544000.0,"cpu_rss_bytes":1129644032.0,"grad_norm_embed":1.0010912081437653,"grad_norm_attn":0.025268982010553703,"grad_norm_ffn":0.025053966352974667,"grad_norm_attn_sem":0.0,"grad_norm_attn_geo":0.0,"grad_norm_total":1.0017234297472577,"wall_time":"2025-12-17T22:08:11+01:00"}
{"type":"train","step":160,"loss":7.552070617675781,"ppl":1904.682520326922,"lr":0.0003,"tok_s":9158.699853576805,"seq_len":256,"grad_accum":2,"global_batch":16,"step_ms":447.2250500053633,"data_ms":4.492662288248539,"fwd_ms":96.86873739119619,"bwd_ms":236.5792081982363,"opt_ms":108.45535840489902,"grad_clip_norm":2.90625,"opt_state_bytes":279605536,"mps_mem_alloc_bytes":1554329600.0,"mps_mem_driver_bytes":7020544000.0,"cpu_rss_bytes":1135820800.0,"grad_norm_embed":0.9952567889098798,"grad_norm_attn":0.01913574955404246,"grad_norm_ffn":0.023723067672900493,"grad_norm_attn_sem":0.0,"grad_norm_attn_geo":0.0,"grad_norm_total":0.9957233735942995,"wall_time":"2025-12-17T22:08:15+01:00"}
{"type":"train","step":170,"loss":4.6356048583984375,"ppl":103.09025414707423,"lr":0.0003,"tok_s":9153.718158145415,"seq_len":256,"grad_accum":2,"global_batch":16,"step_ms":447.46844170149416,"data_ms":3.5979123902507126,"fwd_ms":97.52922918996774,"bwd_ms":237.77226690435782,"opt_ms":107.73216231027618,"grad_clip_norm":5.1875,"opt_state_bytes":279605536,"mps_mem_alloc_bytes":1554329600.0,"mps_mem_driver_bytes":7020544000.0,"cpu_rss_bytes":1140129792.0,"grad_norm_embed":1.0017048878002563,"grad_norm_attn":0.009233741291586007,"grad_norm_ffn":0.014310097198986713,"grad_norm_attn_sem":0.0,"grad_norm_attn_geo":0.0,"grad_norm_total":1.001849650947191,"wall_time":"2025-12-17T22:08:20+01:00"}
{"type":"train","step":180,"loss":7.3274736404418945,"ppl":1521.5329729433365,"lr":0.0003,"tok_s":9171.077056575894,"seq_len":256,"grad_accum":2,"global_batch":16,"step_ms":446.62147910567,"data_ms":4.613150015939027,"fwd_ms":97.9356293042656,"bwd_ms":235.62957480899058,"opt_ms":107.60196230839938,"grad_clip_norm":0.9921875,"opt_state_bytes":279605536,"mps_mem_alloc_bytes":1554329600.0,"mps_mem_driver_bytes":7020544000.0,"cpu_rss_bytes":1144193024.0,"grad_norm_embed":0.9921150637499299,"grad_norm_attn":0.051309043146995637,"grad_norm_ffn":0.029831672307756105,"grad_norm_attn_sem":0.0,"grad_norm_attn_geo":0.0,"grad_norm_total":0.9938887494588441,"wall_time":"2025-12-17T22:08:24+01:00"}
{"type":"train","step":190,"loss":7.533088684082031,"ppl":1868.8689440099672,"lr":0.0003,"tok_s":9146.192879776701,"seq_len":256,"grad_accum":2,"global_batch":16,"step_ms":447.83660850371234,"data_ms":4.073095781495795,"fwd_ms":98.82418749039061,"bwd_ms":236.16304159513675,"opt_ms":107.8849125013221,"grad_clip_norm":1.25,"opt_state_bytes":279605536,"mps_mem_alloc_bytes":1554329600.0,"mps_mem_driver_bytes":7020544000.0,"cpu_rss_bytes":1147994112.0,"grad_norm_embed":0.9988480069675331,"grad_norm_attn":0.045639217082981166,"grad_norm_ffn":0.03969413888862531,"grad_norm_attn_sem":0.0,"grad_norm_attn_geo":0.0,"grad_norm_total":1.0006777222568064,"wall_time":"2025-12-17T22:08:29+01:00"}
{"type":"eval","step":200,"train_loss":7.498321151733398,"val_loss":7.407881832122802,"val_ppl":1648.9299347582844,"best_val":7.407881832122802,"wall_time":"2025-12-17T22:08:36+01:00"}
{"type":"analysis","step":200,"attn_entropy_mean":0.2880207821726799,"attn_topk_mass_mean":0.9990640878677368,"attn_local_mass_mean":0.8301207423210144,"attn_erank_mean":78.70690155029297,"proj_stable_rank_mean":19.484682922310604,"wall_time":"2025-12-17T22:08:36+01:00"}
{"type":"train","step":200,"loss":3.728961944580078,"ppl":41.63586538798419,"lr":0.0003,"tok_s":9179.170017247307,"seq_len":256,"grad_accum":2,"global_batch":16,"step_ms":446.22770820278674,"data_ms":3.4703205921687186,"fwd_ms":89.71443349728361,"bwd_ms":247.71738328854553,"opt_ms":104.68746650149114,"grad_clip_norm":0.85546875,"opt_state_bytes":279605536,"mps_mem_alloc_bytes":1554329600.0,"mps_mem_driver_bytes":7035224064.0,"cpu_rss_bytes":1157791744.0,"grad_norm_embed":0.8529509096342224,"grad_norm_attn":0.042696296494955106,"grad_norm_ffn":0.02688309995907575,"grad_norm_attn_sem":0.0,"grad_norm_attn_geo":0.0,"grad_norm_total":0.854441881606726,"wall_time":"2025-12-17T22:08:36+01:00"}
{"type":"train","step":210,"loss":7.547527313232422,"ppl":1896.0485958942581,"lr":0.0003,"tok_s":9204.133972956866,"seq_len":256,"grad_accum":2,"global_batch":16,"step_ms":445.0174249999691,"data_ms":3.521125193219632,"fwd_ms":95.87284589651972,"bwd_ms":237.27176670217887,"opt_ms":107.58439599885605,"grad_clip_norm":1.3359375,"opt_state_bytes":279605536,"mps_mem_alloc_bytes":1554329600.0,"mps_mem_driver_bytes":7035224064.0,"cpu_rss_bytes":1161773056.0,"grad_norm_embed":0.9980158498919229,"grad_norm_attn":0.039845160144756295,"grad_norm_ffn":0.0404984109150132,"grad_norm_attn_sem":0.0,"grad_norm_attn_geo":0.0,"grad_norm_total":0.9996316295061395,"wall_time":"2025-12-17T22:08:41+01:00"}
{"type":"train","step":220,"loss":7.488197326660156,"ppl":1786.8281194184015,"lr":0.0003,"tok_s":9251.524003244778,"seq_len":256,"grad_accum":2,"global_batch":16,"step_ms":442.73786660050973,"data_ms":3.693866787943989,"fwd_ms":97.94847901212052,"bwd_ms":232.85456250305288,"opt_ms":106.85026669525541,"grad_clip_norm":4.625,"opt_state_bytes":279605536,"mps_mem_alloc_bytes":1554329600.0,"mps_mem_driver_bytes":7020544000.0,"cpu_rss_bytes":1165230080.0,"grad_norm_embed":0.9930056306076221,"grad_norm_attn":0.02299106250869432,"grad_norm_ffn":0.029290045265620287,"grad_norm_attn_sem":0.0,"grad_norm_attn_geo":0.0,"grad_norm_total":0.9937035162086236,"wall_time":"2025-12-17T22:08:45+01:00"}
{"type":"train","step":230,"loss":4.828180313110352,"ppl":124.98332308858276,"lr":0.0003,"tok_s":9157.887421496427,"seq_len":256,"grad_accum":2,"global_batch":16,"step_ms":447.2647250921,"data_ms":4.807112616254017,"fwd_ms":97.30260001961142,"bwd_ms":233.86533350567333,"opt_ms":110.42475819704123,"grad_clip_norm":6.0,"opt_state_bytes":279605536,"mps_mem_alloc_bytes":1554329600.0,"mps_mem_driver_bytes":7020544000.0,"cpu_rss_bytes":1169457152.0,"grad_norm_embed":0.9985746259753798,"grad_norm_attn":0.011635822919784381,"grad_norm_ffn":0.02067173380615003,"grad_norm_attn_sem":0.0,"grad_norm_attn_geo":0.0,"grad_norm_total":0.9988563443235682,"wall_time":"2025-12-17T22:08:50+01:00"}
{"type":"train","step":240,"loss":7.659424781799316,"ppl":2120.5373060401043,"lr":0.0003,"tok_s":9076.913849819459,"seq_len":256,"grad_accum":2,"global_batch":16,"step_ms":451.25469600898214,"data_ms":3.431712288875133,"fwd_ms":93.99908729828894,"bwd_ms":245.42795420857146,"opt_ms":107.66732930787839,"grad_clip_norm":1.2890625,"opt_state_bytes":279605536,"mps_mem_alloc_bytes":1554329600.0,"mps_mem_driver_bytes":7020544000.0,"cpu_rss_bytes":1173291008.0,"grad_norm_embed":0.9988952500408802,"grad_norm_attn":0.04586134753660111,"grad_norm_ffn":0.05622317635973209,"grad_norm_attn_sem":0.0,"grad_norm_attn_geo":0.0,"grad_norm_total":1.0015268490220735,"wall_time":"2025-12-17T22:08:54+01:00"}
{"type":"train","step":250,"loss":5.17381477355957,"ppl":176.58719438412564,"lr":0.0003,"tok_s":8698.337475300696,"seq_len":256,"grad_accum":2,"global_batch":16,"step_ms":470.89458320406266,"data_ms":3.263208200223744,"fwd_ms":100.29075810452923,"bwd_ms":252.2784918022808,"opt_ms":114.21473759692162,"grad_clip_norm":3.578125,"opt_state_bytes":279605536,"mps_mem_alloc_bytes":1554329600.0,"mps_mem_driver_bytes":7020544000.0,"cpu_rss_bytes":1178550272.0,"grad_norm_embed":0.9970030526290024,"grad_norm_attn":0.011806013159879685,"grad_norm_ffn":0.015081915877532373,"grad_norm_attn_sem":0.0,"grad_norm_attn_geo":0.0,"grad_norm_total":0.9971870100862813,"wall_time":"2025-12-17T22:08:59+01:00"}
{"type":"train","step":260,"loss":7.391622543334961,"ppl":1622.336289502534,"lr":0.0003,"tok_s":8923.261742410099,"seq_len":256,"grad_accum":2,"global_batch":16,"step_ms":459.0249751985539,"data_ms":3.202745702583343,"fwd_ms":98.3170454914216,"bwd_ms":246.6700209013652,"opt_ms":110.04938329569995,"grad_clip_norm":3.53125,"opt_state_bytes":279605536,"mps_mem_alloc_bytes":1554329600.0,"mps_mem_driver_bytes":7020544000.0,"cpu_rss_bytes":1181712384.0,"grad_norm_embed":0.9980453174629301,"grad_norm_attn":0.0365019271995674,"grad_norm_ffn":0.02061361376082385,"grad_norm_attn_sem":0.0,"grad_norm_attn_geo":0.0,"grad_norm_total":0.9989253062522963,"wall_time":"2025-12-17T22:09:04+01:00"}
{"type":"train","step":270,"loss":7.233449935913086,"ppl":1384.9924064697477,"lr":0.0003,"tok_s":8866.828051550077,"seq_len":256,"grad_accum":2,"global_batch":16,"step_ms":461.9464791903738,"data_ms":3.6082084174267948,"fwd_ms":97.58180410135537,"bwd_ms":249.52118330984376,"opt_ms":110.40736230206676,"grad_clip_norm":1.4140625,"opt_state_bytes":279605536,"mps_mem_alloc_bytes":1554329600.0,"mps_mem_driver_bytes":7020544000.0,"cpu_rss_bytes":1185415168.0,"grad_norm_embed":0.9990461810451271,"grad_norm_attn":0.04667590079200288,"grad_norm_ffn":0.03486556083217505,"grad_norm_attn_sem":0.0,"grad_norm_attn_geo":0.0,"grad_norm_total":1.0007434830703321,"wall_time":"2025-12-17T22:09:08+01:00"}
{"type":"train","step":280,"loss":7.420677185058594,"ppl":1670.1641350772509,"lr":0.0003,"tok_s":8552.22714872109,"seq_len":256,"grad_accum":2,"global_batch":16,"step_ms":478.93957080086693,"data_ms":3.302937082480639,"fwd_ms":100.91177080757916,"bwd_ms":259.5060872088652,"opt_ms":114.4256251049228,"grad_clip_norm":1.6171875,"opt_state_bytes":279605536,"mps_mem_alloc_bytes":1554329600.0,"mps_mem_driver_bytes":7020544000.0,"cpu_rss_bytes":1188855808.0,"grad_norm_embed":0.9970623750678945,"grad_norm_attn":0.04093990266877802,"grad_norm_ffn":0.02430317708752392,"grad_norm_attn_sem":0.0,"grad_norm_attn_geo":0.0,"grad_norm_total":0.9981984270790589,"wall_time":"2025-12-17T22:09:13+01:00"}
{"type":"train","step":290,"loss":7.142304420471191,"ppl":1264.338602390771,"lr":0.0003,"tok_s":9125.258003228606,"seq_len":256,"grad_accum":2,"global_batch":16,"step_ms":448.864021000918,"data_ms":3.3319790149107575,"fwd_ms":90.71280009811744,"bwd_ms":248.49988760543056,"opt_ms":105.70709989988245,"grad_clip_norm":0.8515625,"opt_state_bytes":279605536,"mps_mem_alloc_bytes":1554329600.0,"mps_mem_driver_bytes":7020544000.0,"cpu_rss_bytes":1192853504.0,"grad_norm_embed":0.8483532627867219,"grad_norm_attn":0.06588871452190061,"grad_norm_ffn":0.03707235400166204,"grad_norm_attn_sem":0.0,"grad_norm_attn_geo":0.0,"grad_norm_total":0.8517152931663547,"wall_time":"2025-12-17T22:09:18+01:00"}
{"type":"analysis","step":300,"attn_entropy_mean":0.19890334457159042,"attn_topk_mass_mean":0.9998752474784851,"attn_local_mass_mean":0.7675867080688477,"attn_erank_mean":63.379722595214844,"proj_stable_rank_mean":15.59698732395134,"wall_time":"2025-12-17T22:09:22+01:00"}
{"type":"train","step":300,"loss":6.89932918548584,"ppl":991.6093065317484,"lr":0.0003,"tok_s":9211.966767232077,"seq_len":256,"grad_accum":2,"global_batch":16,"step_ms":444.6390334982425,"data_ms":2.616533206310123,"fwd_ms":89.74566690158099,"bwd_ms":246.9467416871339,"opt_ms":104.71189989475533,"grad_clip_norm":0.81640625,"opt_state_bytes":279605536,"mps_mem_alloc_bytes":1554329600.0,"mps_mem_driver_bytes":7035224064.0,"cpu_rss_bytes":1203503104.0,"grad_norm_embed":0.8149706630700606,"grad_norm_attn":0.046544446591519635,"grad_norm_ffn":0.026847250314870383,"grad_norm_attn_sem":0.0,"grad_norm_attn_geo":0.0,"grad_norm_total":0.8167400700485035,"wall_time":"2025-12-17T22:09:22+01:00"}
{"type":"train","step":310,"loss":3.944222927093506,"ppl":51.63619742799221,"lr":0.0003,"tok_s":9172.158914646623,"seq_len":256,"grad_accum":2,"global_batch":16,"step_ms":446.5688000083901,"data_ms":3.104558098129928,"fwd_ms":96.2166789046023,"bwd_ms":237.35694570932537,"opt_ms":109.04410831280984,"grad_clip_norm":2.71875,"opt_state_bytes":279605536,"mps_mem_alloc_bytes":1554329600.0,"mps_mem_driver_bytes":7035224064.0,"cpu_rss_bytes":1208221696.0,"grad_norm_embed":0.9982109728166524,"grad_norm_attn":0.016991486939071612,"grad_norm_ffn":0.021157713686065477,"grad_norm_attn_sem":0.0,"grad_norm_attn_geo":0.0,"grad_norm_total":0.9985797443010698,"wall_time":"2025-12-17T22:09:27+01:00"}
{"type":"train","step":320,"loss":7.434803009033203,"ppl":1693.9239983980822,"lr":0.0003,"tok_s":9091.900472532834,"seq_len":256,"grad_accum":2,"global_batch":16,"step_ms":450.51087089814246,"data_ms":3.2123373879585415,"fwd_ms":98.04411238874309,"bwd_ms":239.02883770642802,"opt_ms":109.45747069781646,"grad_clip_norm":5.125,"opt_state_bytes":279605536,"mps_mem_alloc_bytes":1554329600.0,"mps_mem_driver_bytes":7020544000.0,"cpu_rss_bytes":1211662336.0,"grad_norm_embed":1.001407962404384,"grad_norm_attn":0.02047080295250452,"grad_norm_ffn":0.024489568052686157,"grad_norm_attn_sem":0.0,"grad_norm_attn_geo":0.0,"grad_norm_total":1.00191651343005,"wall_time":"2025-12-17T22:09:31+01:00"}
{"type":"train","step":330,"loss":4.980576992034912,"ppl":145.5583434334176,"lr":0.0003,"tok_s":8848.956568624377,"seq_len":256,"grad_accum":2,"global_batch":16,"step_ms":462.8794330987148,"data_ms":4.109166696434841,"fwd_ms":96.09508359571919,"bwd_ms":249.5178249082528,"opt_ms":112.2811125125736,"grad_clip_norm":3.578125,"opt_state_bytes":279605536,"mps_mem_alloc_bytes":1554329600.0,"mps_mem_driver_bytes":7020544000.0,"cpu_rss_bytes":1214693376.0,"grad_norm_embed":1.0003710797123315,"grad_norm_attn":0.01597175358536599,"grad_norm_ffn":0.022303606751405507,"grad_norm_attn_sem":0.0,"grad_norm_attn_geo":0.0,"grad_norm_total":1.0007471433441761,"wall_time":"2025-12-17T22:09:36+01:00"}
{"type":"train","step":340,"loss":5.008085250854492,"ppl":149.61798080348427,"lr":0.0003,"tok_s":8834.757783388563,"seq_len":256,"grad_accum":2,"global_batch":16,"step_ms":463.62335000303574,"data_ms":4.3215832964051515,"fwd_ms":99.38357500359416,"bwd_ms":247.85532069508918,"opt_ms":111.18154159048572,"grad_clip_norm":14.0,"opt_state_bytes":279605536,"mps_mem_alloc_bytes":1554329600.0,"mps_mem_driver_bytes":7020544000.0,"cpu_rss_bytes":1218330624.0,"grad_norm_embed":0.9974423068365834,"grad_norm_attn":0.008905938003060615,"grad_norm_ffn":0.017693414222859166,"grad_norm_attn_sem":0.0,"grad_norm_attn_geo":0.0,"grad_norm_total":0.9976389768378444,"wall_time":"2025-12-17T22:09:41+01:00"}
{"type":"train","step":350,"loss":7.078133583068848,"ppl":1185.7533418171631,"lr":0.0003,"tok_s":9095.691093564037,"seq_len":256,"grad_accum":2,"global_batch":16,"step_ms":450.3231209004298,"data_ms":3.085053904214874,"fwd_ms":99.24945418606512,"bwd_ms":240.77846640138887,"opt_ms":106.32796671707183,"grad_clip_norm":2.125,"opt_state_bytes":279605536,"mps_mem_alloc_bytes":1554329600.0,"mps_mem_driver_bytes":7020544000.0,"cpu_rss_bytes":1221410816.0,"grad_norm_embed":1.001658893720901,"grad_norm_attn":0.02979123856644863,"grad_norm_ffn":0.03132338177248082,"grad_norm_attn_sem":0.0,"grad_norm_attn_geo":0.0,"grad_norm_total":1.0025912484712636,"wall_time":"2025-12-17T22:09:45+01:00"}
{"type":"train","step":360,"loss":7.171191692352295,"ppl":1301.394541017692,"lr":0.0003,"tok_s":9202.926265502312,"seq_len":256,"grad_accum":2,"global_batch":16,"step_ms":445.0758249964565,"data_ms":3.707533498527482,"fwd_ms":97.59269149508327,"bwd_ms":235.99394991178997,"opt_ms":106.35960409417748,"grad_clip_norm":3.0,"opt_state_bytes":279605536,"mps_mem_alloc_bytes":1554329600.0,"mps_mem_driver_bytes":7020544000.0,"cpu_rss_bytes":1224671232.0,"grad_norm_embed":0.9995412751702365,"grad_norm_attn":0.02878031984538019,"grad_norm_ffn":0.021864448059120543,"grad_norm_attn_sem":0.0,"grad_norm_attn_geo":0.0,"grad_norm_total":1.0001945419108598,"wall_time":"2025-12-17T22:09:50+01:00"}
{"type":"train","step":370,"loss":6.9899702072143555,"ppl":1085.6891300005548,"lr":0.0003,"tok_s":9067.702149042967,"seq_len":256,"grad_accum":2,"global_batch":16,"step_ms":451.7131168046035,"data_ms":3.0195792205631733,"fwd_ms":97.36055839457549,"bwd_ms":241.09246678999625,"opt_ms":109.37728739809245,"grad_clip_norm":1.0,"opt_state_bytes":279605536,"mps_mem_alloc_bytes":1554329600.0,"mps_mem_driver_bytes":7020544000.0,"cpu_rss_bytes":1228079104.0,"grad_norm_embed":1.0015172419238674,"grad_norm_attn":0.06132190232305344,"grad_norm_ffn":0.03572929282839873,"grad_norm_attn_sem":0.0,"grad_norm_attn_geo":0.0,"grad_norm_total":1.0040287565310697,"wall_time":"2025-12-17T22:09:54+01:00"}
{"type":"train","step":380,"loss":7.288119316101074,"ppl":1462.817012208175,"lr":0.0003,"tok_s":9073.22662761065,"seq_len":256,"grad_accum":2,"global_batch":16,"step_ms":451.43807909917086,"data_ms":2.8477168001700193,"fwd_ms":93.12681677984074,"bwd_ms":247.60750849964097,"opt_ms":107.18683339073323,"grad_clip_norm":1.0703125,"opt_state_bytes":279605536,"mps_mem_alloc_bytes":1554329600.0,"mps_mem_driver_bytes":7020544000.0,"cpu_rss_bytes":1231224832.0,"grad_norm_embed":0.993235968768986,"grad_norm_attn":0.07215066106056221,"grad_norm_ffn":0.04103349239504701,"grad_norm_attn_sem":0.0,"grad_norm_attn_geo":0.0,"grad_norm_total":0.9966981263381991,"wall_time":"2025-12-17T22:09:59+01:00"}
{"type":"train","step":390,"loss":5.031803607940674,"ppl":153.20909278698548,"lr":0.0003,"tok_s":8804.54456407579,"seq_len":256,"grad_accum":2,"global_batch":16,"step_ms":465.2142958890181,"data_ms":3.5768835921771824,"fwd_ms":96.2671834975481,"bwd_ms":253.7157915299758,"opt_ms":110.87347060674801,"grad_clip_norm":2.734375,"opt_state_bytes":279605536,"mps_mem_alloc_bytes":1554329600.0,"mps_mem_driver_bytes":7020544000.0,"cpu_rss_bytes":1234206720.0,"grad_norm_embed":0.9934389947969312,"grad_norm_attn":0.02210299468517506,"grad_norm_ffn":0.02182773463568135,"grad_norm_attn_sem":0.0,"grad_norm_attn_geo":0.0,"grad_norm_total":0.9939245588858924,"wall_time":"2025-12-17T22:10:03+01:00"}
{"type":"eval","step":400,"train_loss":7.033960485458374,"val_loss":7.075505352020263,"val_ppl":1182.6409998367171,"best_val":7.075505352020263,"wall_time":"2025-12-17T22:10:11+01:00"}
{"type":"analysis","step":400,"attn_entropy_mean":0.13832957670092583,"attn_topk_mass_mean":0.9999742805957794,"attn_local_mass_mean":0.810379147529602,"attn_erank_mean":49.96457481384277,"proj_stable_rank_mean":13.018640338487206,"wall_time":"2025-12-17T22:10:11+01:00"}
{"type":"train","step":400,"loss":7.386966705322266,"ppl":1614.8005108315322,"lr":0.0003,"tok_s":8950.579516948916,"seq_len":256,"grad_accum":2,"global_batch":16,"step_ms":457.6239999034442,"data_ms":3.195808397140354,"fwd_ms":91.99619581922889,"bwd_ms":254.84623308293519,"opt_ms":106.9720458064694,"grad_clip_norm":3.6875,"opt_state_bytes":279605536,"mps_mem_alloc_bytes":1554329600.0,"mps_mem_driver_bytes":7035224064.0,"cpu_rss_bytes":1260191744.0,"grad_norm_embed":0.998591543362499,"grad_norm_attn":0.019396834474487323,"grad_norm_ffn":0.020889823520692834,"grad_norm_attn_sem":0.0,"grad_norm_attn_geo":0.0,"grad_norm_total":0.9989983445378947,"wall_time":"2025-12-17T22:10:11+01:00"}
{"type":"train","step":410,"loss":7.753367900848389,"ppl":2329.404421624309,"lr":0.0003,"tok_s":8783.243368488573,"seq_len":256,"grad_accum":2,"global_batch":16,"step_ms":466.3425375067163,"data_ms":3.9378290122840554,"fwd_ms":97.82505438779481,"bwd_ms":252.652295504231,"opt_ms":111.18565850192681,"grad_clip_norm":1.6015625,"opt_state_bytes":279605536,"mps_mem_alloc_bytes":1554329600.0,"mps_mem_driver_bytes":7035224064.0,"cpu_rss_bytes":1263845376.0,"grad_norm_embed":0.9962751838643417,"grad_norm_attn":0.044673844524648926,"grad_norm_ffn":0.03172741911872843,"grad_norm_attn_sem":0.0,"grad_norm_attn_geo":0.0,"grad_norm_total":0.9977808494316153,"wall_time":"2025-12-17T22:10:16+01:00"}
{"type":"train","step":420,"loss":7.101908206939697,"ppl":1214.2819664188014,"lr":0.0003,"tok_s":9110.282289388802,"seq_len":256,"grad_accum":2,"global_batch":16,"step_ms":449.601875100052,"data_ms":2.4990211881231517,"fwd_ms":97.51793760806322,"bwd_ms":239.34725440340117,"opt_ms":109.37078339629807,"grad_clip_norm":1.921875,"opt_state_bytes":279605536,"mps_mem_alloc_bytes":1554329600.0,"mps_mem_driver_bytes":7020544000.0,"cpu_rss_bytes":1266843648.0,"grad_norm_embed":0.9952612760642531,"grad_norm_attn":0.030131174914602352,"grad_norm_ffn":0.01869595756377574,"grad_norm_attn_sem":0.0,"grad_norm_attn_geo":0.0,"grad_norm_total":0.9958927824640593,"wall_time":"2025-12-17T22:10:20+01:00"}
{"type":"train","step":430,"loss":7.39091682434082,"ppl":1621.1917798667441,"lr":0.0003,"tok_s":9057.001951908862,"seq_len":256,"grad_accum":2,"global_batch":16,"step_ms":452.24678340018727,"data_ms":3.0305960099212825,"fwd_ms":101.9888544047717,"bwd_ms":239.05447070719674,"opt_ms":107.34490829636343,"grad_clip_norm":3.8125,"opt_state_bytes":279605536,"mps_mem_alloc_bytes":1554329600.0,"mps_mem_driver_bytes":7020544000.0,"cpu_rss_bytes":1270005760.0,"grad_norm_embed":0.9927966513486348,"grad_norm_attn":0.025210264960087866,"grad_norm_ffn":0.01852366315732123,"grad_norm_attn_sem":0.0,"grad_norm_attn_geo":0.0,"grad_norm_total":0.9932894213094119,"wall_time":"2025-12-17T22:10:25+01:00"}
{"type":"train","step":440,"loss":3.4713640213012695,"ppl":32.18060755567293,"lr":0.0003,"tok_s":9136.099212989988,"seq_len":256,"grad_accum":2,"global_batch":16,"step_ms":448.33138350513764,"data_ms":2.803858183324337,"fwd_ms":98.34064161987044,"bwd_ms":237.09845421253704,"opt_ms":108.83966659894213,"grad_clip_norm":1.0234375,"opt_state_bytes":279605536,"mps_mem_alloc_bytes":1554329600.0,"mps_mem_driver_bytes":7020544000.0,"cpu_rss_bytes":1273151488.0,"grad_norm_embed":0.9927738350487123,"grad_norm_attn":0.050940394032376476,"grad_norm_ffn":0.025607777901299762,"grad_norm_attn_sem":0.0,"grad_norm_attn_geo":0.0,"grad_norm_total":0.9944096588381188,"wall_time":"2025-12-17T22:10:29+01:00"}
{"type":"train","step":450,"loss":7.191152095794678,"ppl":1327.6318839565643,"lr":0.0003,"tok_s":9187.626146182087,"seq_len":256,"grad_accum":2,"global_batch":16,"step_ms":445.8170080964919,"data_ms":2.519541879883036,"fwd_ms":98.0888290097937,"bwd_ms":236.77414600388147,"opt_ms":107.55048338323832,"grad_clip_norm":1.09375,"opt_state_bytes":279605536,"mps_mem_alloc_bytes":1554329600.0,"mps_mem_driver_bytes":7020544000.0,"cpu_rss_bytes":1276182528.0,"grad_norm_embed":0.9973789885242238,"grad_norm_attn":0.0732455668970985,"grad_norm_ffn":0.033576099814302686,"grad_norm_attn_sem":0.0,"grad_norm_attn_geo":0.0,"grad_norm_total":1.0006283597312347,"wall_time":"2025-12-17T22:10:34+01:00"}
{"type":"train","step":460,"loss":4.636355876922607,"ppl":103.16770591781693,"lr":0.0003,"tok_s":8793.976411787391,"seq_len":256,"grad_accum":2,"global_batch":16,"step_ms":465.7733667001594,"data_ms":3.2583084073849022,"fwd_ms":95.94705840572715,"bwd_ms":253.85335853206925,"opt_ms":111.94800429511815,"grad_clip_norm":3.90625,"opt_state_bytes":279605536,"mps_mem_alloc_bytes":1554329600.0,"mps_mem_driver_bytes":7020544000.0,"cpu_rss_bytes":1280081920.0,"grad_norm_embed":0.9980568351846113,"grad_norm_attn":0.015592381261001969,"grad_norm_ffn":0.0225679574422662,"grad_norm_attn_sem":0.0,"grad_norm_attn_geo":0.0,"grad_norm_total":0.9984337140317462,"wall_time":"2025-12-17T22:10:39+01:00"}
{"type":"train","step":470,"loss":4.002208709716797,"ppl":54.718874771514315,"lr":0.0003,"tok_s":9068.95795961794,"seq_len":256,"grad_accum":2,"global_batch":16,"step_ms":451.65056649711914,"data_ms":3.005371004110202,"fwd_ms":96.52066669659689,"bwd_ms":242.9524414939806,"opt_ms":108.36162089835852,"grad_clip_norm":2.140625,"opt_state_bytes":279605536,"mps_mem_alloc_bytes":1554329600.0,"mps_mem_driver_bytes":7020544000.0,"cpu_rss_bytes":1282949120.0,"grad_norm_embed":0.9991342198742691,"grad_norm_attn":0.023830545843811345,"grad_norm_ffn":0.02928115365724023,"grad_norm_attn_sem":0.0,"grad_norm_attn_geo":0.0,"grad_norm_total":0.9998472234288983,"wall_time":"2025-12-17T22:10:43+01:00"}
{"type":"train","step":480,"loss":7.044604301452637,"ppl":1146.6550163096388,"lr":0.0003,"tok_s":8822.705355097296,"seq_len":256,"grad_accum":2,"global_batch":16,"step_ms":464.2566916998476,"data_ms":2.8558085032273084,"fwd_ms":105.61793749220669,"bwd_ms":239.95483329636045,"opt_ms":114.85864579444751,"grad_clip_norm":1.296875,"opt_state_bytes":279605536,"mps_mem_alloc_bytes":1554329600.0,"mps_mem_driver_bytes":7020544000.0,"cpu_rss_bytes":1286111232.0,"grad_norm_embed":0.9944727816779154,"grad_norm_attn":0.058259556315056416,"grad_norm_ffn":0.032738570989135705,"grad_norm_attn_sem":0.0,"grad_norm_attn_geo":0.0,"grad_norm_total":0.9967156582650083,"wall_time":"2025-12-17T22:10:48+01:00"}
{"type":"train","step":490,"loss":6.771932601928711,"ppl":872.9974212396006,"lr":0.0003,"tok_s":9090.613000298641,"seq_len":256,"grad_accum":2,"global_batch":16,"step_ms":450.5746752023697,"data_ms":2.0456873113289475,"fwd_ms":98.56787120806985,"bwd_ms":239.00469581130892,"opt_ms":110.05899149458855,"grad_clip_norm":1.9453125,"opt_state_bytes":279605536,"mps_mem_alloc_bytes":1554329600.0,"mps_mem_driver_bytes":7020544000.0,"cpu_rss_bytes":1288814592.0,"grad_norm_embed":1.002028267373002,"grad_norm_attn":0.0328923898207858,"grad_norm_ffn":0.024872166790204066,"grad_norm_attn_sem":0.0,"grad_norm_attn_geo":0.0,"grad_norm_total":1.0028764543070612,"wall_time":"2025-12-17T22:10:52+01:00"}
{"type":"analysis","step":500,"attn_entropy_mean":0.13171818479895592,"attn_topk_mass_mean":0.9999927878379822,"attn_local_mass_mean":0.7671112716197968,"attn_erank_mean":62.382869720458984,"proj_stable_rank_mean":11.547433319874624,"wall_time":"2025-12-17T22:10:57+01:00"}
{"type":"train","step":500,"loss":7.114540100097656,"ppl":1229.717933976281,"lr":0.0003,"tok_s":8563.650810596246,"seq_len":256,"grad_accum":2,"global_batch":16,"step_ms":478.30067930044606,"data_ms":2.8616083902306855,"fwd_ms":102.90910848998465,"bwd_ms":257.0925708860159,"opt_ms":114.58710432052612,"grad_clip_norm":4.3125,"opt_state_bytes":279605536,"mps_mem_alloc_bytes":1554329600.0,"mps_mem_driver_bytes":7035224064.0,"cpu_rss_bytes":1291747328.0,"grad_norm_embed":0.994147907630424,"grad_norm_attn":0.022881472138738507,"grad_norm_ffn":0.017932983460191804,"grad_norm_attn_sem":0.0,"grad_norm_attn_geo":0.0,"grad_norm_total":0.9945728811449513,"wall_time":"2025-12-17T22:10:57+01:00"}
{"type":"train","step":510,"loss":7.066409111022949,"ppl":1171.9321910800827,"lr":0.0003,"tok_s":8847.185313576874,"seq_len":256,"grad_accum":2,"global_batch":16,"step_ms":462.97210410120897,"data_ms":3.4099500044249,"fwd_ms":98.46260418999009,"bwd_ms":247.5324417115189,"opt_ms":112.7570790995378,"grad_clip_norm":2.4375,"opt_state_bytes":279605536,"mps_mem_alloc_bytes":1554329600.0,"mps_mem_driver_bytes":7035224064.0,"cpu_rss_bytes":1294303232.0,"grad_norm_embed":1.000049095792629,"grad_norm_attn":0.023931405663988107,"grad_norm_ffn":0.023093168183574778,"grad_norm_attn_sem":0.0,"grad_norm_attn_geo":0.0,"grad_norm_total":1.0006019191414055,"wall_time":"2025-12-17T22:11:02+01:00"}
{"type":"train","step":520,"loss":7.314631462097168,"ppl":1502.1181065624633,"lr":0.0003,"tok_s":9047.062449329407,"seq_len":256,"grad_accum":2,"global_batch":16,"step_ms":452.7436417003628,"data_ms":2.9417086974717677,"fwd_ms":99.46120410459116,"bwd_ms":239.32114589842968,"opt_ms":110.17500410089269,"grad_clip_norm":1.359375,"opt_state_bytes":279605536,"mps_mem_alloc_bytes":1554329600.0,"mps_mem_driver_bytes":7020544000.0,"cpu_rss_bytes":1297334272.0,"grad_norm_embed":0.9953016001105081,"grad_norm_attn":0.03704539932178018,"grad_norm_ffn":0.022917938604417636,"grad_norm_attn_sem":0.0,"grad_norm_attn_geo":0.0,"grad_norm_total":0.9962544196656413,"wall_time":"2025-12-17T22:11:06+01:00"}
{"type":"train","step":530,"loss":4.726276397705078,"ppl":112.87447919233146,"lr":0.0003,"tok_s":9103.476899904093,"seq_len":256,"grad_accum":2,"global_batch":16,"step_ms":449.93797919596545,"data_ms":2.7627040981315076,"fwd_ms":98.8237332960125,"bwd_ms":240.46601679874584,"opt_ms":107.07115840050392,"grad_clip_norm":3.625,"opt_state_bytes":279605536,"mps_mem_alloc_bytes":1554329600.0,"mps_mem_driver_bytes":7020544000.0,"cpu_rss_bytes":1301135360.0,"grad_norm_embed":0.9966770059884887,"grad_norm_attn":0.01239863832086315,"grad_norm_ffn":0.01894712907774101,"grad_norm_attn_sem":0.0,"grad_norm_attn_geo":0.0,"grad_norm_total":0.9969341874961848,"wall_time":"2025-12-17T22:11:11+01:00"}
{"type":"train","step":540,"loss":7.218099117279053,"ppl":1363.8939925059444,"lr":0.0003,"tok_s":9114.094004205728,"seq_len":256,"grad_accum":2,"global_batch":16,"step_ms":449.4138416950591,"data_ms":2.483124705031514,"fwd_ms":95.9000623843167,"bwd_ms":243.66194579633884,"opt_ms":106.59124158555642,"grad_clip_norm":3.90625,"opt_state_bytes":279605536,"mps_mem_alloc_bytes":1554329600.0,"mps_mem_driver_bytes":7020544000.0,"cpu_rss_bytes":1303674880.0,"grad_norm_embed":0.9977793481667898,"grad_norm_attn":0.020807338223864057,"grad_norm_ffn":0.0224889625615822,"grad_norm_attn_sem":0.0,"grad_norm_attn_geo":0.0,"grad_norm_total":0.998249631299307,"wall_time":"2025-12-17T22:11:15+01:00"}
{"type":"train","step":550,"loss":4.464483261108398,"ppl":86.87612566607928,"lr":0.0003,"tok_s":9177.250745915107,"seq_len":256,"grad_accum":2,"global_batch":16,"step_ms":446.3210294023156,"data_ms":2.3366538109257817,"fwd_ms":97.88713320158422,"bwd_ms":237.04043708276004,"opt_ms":108.20407089195214,"grad_clip_norm":0.78125,"opt_state_bytes":279605536,"mps_mem_alloc_bytes":1554329600.0,"mps_mem_driver_bytes":7020544000.0,"cpu_rss_bytes":1306886144.0,"grad_norm_embed":0.7764286541373445,"grad_norm_attn":0.038570690389505266,"grad_norm_ffn":0.03639894379303163,"grad_norm_attn_sem":0.0,"grad_norm_attn_geo":0.0,"grad_norm_total":0.7782377761532135,"wall_time":"2025-12-17T22:11:20+01:00"}
