{"type":"meta","step":0,"env":{"time":"2025-12-18T02:34:32+01:00","python":"3.12.12 (main, Oct  9 2025, 11:07:00) [Clang 17.0.0 (clang-1700.0.13.3)]","platform":"macOS-15.6-arm64-arm-64bit","torch":"2.9.1","device":"mps","triton_available":false},"argv":["v29_transformer_decoupled_bottleneck_instrumented.py","--mode","train","--device","mps","--data","fineweb_100m.npy","--data-format","npy","--vocab-size","50257","--steps","12000","--d-model","768","--layers","12","--n-head","12","--d-ff","3072","--embed-dim","512","--optimizer","lion","--lr","3e-4","--batch-size","8","--grad-accum","2","--train-seq-len","512","--seq-schedule","256@0,512@500,1024@2000","--eval-every","200","--eval-iters","20","--log-every","10","--instrument","full","--analysis-every","100","--live","rich","--param-dtype","bf16","--amp","--amp-dtype","bf16","--seed","1337","--out-dir","runs/m4max_long12k_decoupled_48_96_seed1337","--attn-mode","decoupled","--attn-dim","144","--sem-dim","48","--geo-dim","96"],"args":{"size":null,"exp":null,"run_root":"runs","run_tag":null,"print_config":false,"data":"fineweb_100m.npy","data_format":"npy","data_dtype":"uint16","vocab_size":50257,"val_frac":0.1,"out_dir":"runs/m4max_long12k_decoupled_48_96_seed1337","seed":1337,"device":"mps","compile":false,"compile_mode":"default","amp":true,"amp_dtype":"bf16","param_dtype":"bf16","matmul_precision":"high","layers":12,"d_model":768,"n_head":12,"d_ff":3072,"block":256,"embed_dim":512,"attn_mode":"decoupled","kv_head":null,"attn_dim":144,"sem_dim":48,"geo_dim":96,"no_rope":false,"rope":false,"rope_base":10000.0,"tie_qk":false,"no_tie_qk":false,"null_attn":false,"no_null_attn":false,"no_learned_temp":false,"mlp":"swiglu","dropout":0.0,"steps":12000,"batch_size":8,"grad_accum":2,"train_seq_len":512,"seq_schedule":"256@0,512@500,1024@2000","eval_seq_len":0,"grad_checkpoint":false,"optimizer":"lion","adam_betas":"0.9,0.95","adam_eps":1e-08,"lion_betas":"0.9,0.99","lr":0.0003,"lr_schedule":"constant","warmup_steps":0,"min_lr":0.0,"opt_foreach":false,"opt_fused":false,"weight_decay":0.1,"grad_clip":1.0,"save_every":0,"eval_every":200,"eval_iters":20,"log_every":10,"instrument":"full","analysis_every":100,"analysis_max_tokens":256,"analysis_layers":"0,-1","analysis_heads":"0","analysis_topk":8,"analysis_local_window":32,"analysis_save_scores":false,"live":"rich","live_update_every":1,"sync_timing":false,"live_plot":false,"tb":false,"mode":"train","ckpt":null,"prompt_tokens":"0","max_new_tokens":50,"temperature":1.0,"top_k":null,"kv_cache":"fp16","kv_qblock":32,"kv_residual":128,"kv_decode_block":1024,"kv_fused":"auto","self_opt":"none","self_opt_cache":null,"self_opt_decode_blocks":"256,512,1024,2048","self_opt_block_n":"128","self_opt_warps":"4,8","self_opt_stages":"2,3","self_opt_warmup":1,"self_opt_iters":3,"self_opt_interval":256,"self_opt_hysteresis":0.03,"self_opt_verbose":false,"self_opt_verify":false,"self_opt_verify_tol":0.005,"self_opt_scope":"all","self_opt_residuals":"0,32,64,128","self_opt_qblocks":"16,32,64","self_opt_k_sem_kinds":"q4_0,nf4,q8_0,fp16","self_opt_k_geo_kinds":"q8_0,q4_0,fp16","self_opt_v_kinds":"q4_0,q8_0,fp16","self_opt_mem_budget_mb":null,"self_opt_mem_overhead_frac":0.1,"self_opt_policy_prefix_len":null,"self_opt_policy_warmup":1,"self_opt_policy_iters":3,"self_opt_policy_hysteresis":0.02,"self_opt_prefer_low_mem_within":0.02,"self_opt_policy_quality":false,"self_opt_calib_tokens":null,"self_opt_calib_prefill":128,"self_opt_calib_decode":32,"self_opt_quality_tol":0.5,"self_opt_quality_delta_nll_tol":0.02,"self_opt_quality_ppl_ratio_tol":1.02,"self_opt_quality_kl_tol":null,"self_opt_quality_kl":false,"kv_cache_k":null,"kv_cache_v":null,"kv_cache_k_sem":null,"kv_cache_k_geo":null,"kv_qblock_k":null,"kv_qblock_v":null,"kv_qblock_k_sem":null,"kv_qblock_k_geo":null,"tokenizer":"word"},"config":{"vocab_size":50257,"block_size":256,"n_layer":12,"n_head":12,"kv_head":null,"d_model":768,"d_ff":3072,"embed_dim":512,"attn_mode":"decoupled","attn_dim":144,"sem_dim":48,"geo_dim":96,"rope":true,"rope_base":10000.0,"tie_qk":false,"null_attn":false,"learned_temp":true,"mlp":"swiglu","dropout":0.0},"wall_time":"2025-12-18T02:34:32+01:00"}
{"type":"mem","step":0,"kv_ctx_bytes":1769472,"kv_128k_bytes":884736000,"data_format":"npy","data_dtype":"uint16","n_tokens_total":100000000,"n_tokens_train":90000000,"n_tokens_val":10000000,"vocab_size":50257,"wall_time":"2025-12-18T02:34:32+01:00"}
{"type":"eval","step":0,"train_loss":10.455357360839844,"val_loss":10.857066345214843,"val_ppl":51899.599129106944,"best_val":10.857066345214843,"wall_time":"2025-12-18T02:34:34+01:00"}
{"type":"train","step":1,"loss":10.688629150390625,"ppl":43854.34805664145,"lr":0.0003,"tok_s":8677.44674196301,"seq_len":256,"grad_accum":2,"global_batch":16,"step_ms":472.02824999112636,"data_ms":0.3293329500593245,"fwd_ms":78.606833005324,"bwd_ms":221.33304201997817,"opt_ms":171.31474998313934,"grad_clip_norm":5.8125,"opt_state_bytes":233599264,"mps_mem_alloc_bytes":1542328064.0,"mps_mem_driver_bytes":5032443904.0,"cpu_rss_bytes":966623232.0,"grad_norm_embed":0.5698368231287257,"grad_norm_attn":0.5980546072503881,"grad_norm_ffn":0.5637112039386881,"grad_norm_attn_sem":0.013671249597389908,"grad_norm_attn_geo":0.010887846195666752,"grad_norm_total":1.0002295176374243,"wall_time":"2025-12-18T02:34:35+01:00"}
{"type":"train","step":10,"loss":8.42202377319336,"ppl":4546.094415858287,"lr":0.0003,"tok_s":11201.773378085296,"seq_len":256,"grad_accum":2,"global_batch":16,"step_ms":365.65638865835757,"data_ms":4.806018783710897,"fwd_ms":68.08468989846814,"bwd_ms":217.18479154838454,"opt_ms":75.0442406731761,"grad_clip_norm":2.46875,"opt_state_bytes":233599264,"mps_mem_alloc_bytes":1523469056.0,"mps_mem_driver_bytes":6164905984.0,"cpu_rss_bytes":983252992.0,"grad_norm_embed":0.994239491379337,"grad_norm_attn":0.019586574099565938,"grad_norm_ffn":0.04931116708858355,"grad_norm_attn_sem":0.0001897230427610888,"grad_norm_attn_geo":0.00014676222616621216,"grad_norm_total":0.9956542817850094,"wall_time":"2025-12-18T02:34:38+01:00"}
{"type":"train","step":20,"loss":8.347373962402344,"ppl":4219.08670251378,"lr":0.0003,"tok_s":11125.049485052472,"seq_len":256,"grad_accum":2,"global_batch":16,"step_ms":368.1781375897117,"data_ms":3.509495808975771,"fwd_ms":75.2677624928765,"bwd_ms":207.69785416778177,"opt_ms":80.86912091239356,"grad_clip_norm":3.5625,"opt_state_bytes":233599264,"mps_mem_alloc_bytes":1523469056.0,"mps_mem_driver_bytes":6139740160.0,"cpu_rss_bytes":991559680.0,"grad_norm_embed":0.9979366386583918,"grad_norm_attn":0.03521117540262104,"grad_norm_ffn":0.09070762016862755,"grad_norm_attn_sem":0.0006447537917430092,"grad_norm_attn_geo":0.0004173480771478336,"grad_norm_total":1.0026693492341179,"wall_time":"2025-12-18T02:34:42+01:00"}
{"type":"train","step":30,"loss":7.772308349609375,"ppl":2373.9448631602886,"lr":0.0003,"tok_s":11072.80604155981,"seq_len":256,"grad_accum":2,"global_batch":16,"step_ms":369.9152667017188,"data_ms":5.74424181249924,"fwd_ms":74.4889292807784,"bwd_ms":207.23557920427993,"opt_ms":81.6127292055171,"grad_clip_norm":2.21875,"opt_state_bytes":233599264,"mps_mem_alloc_bytes":1523469056.0,"mps_mem_driver_bytes":6139740160.0,"cpu_rss_bytes":998916096.0,"grad_norm_embed":0.9895173057572049,"grad_norm_attn":0.039722327987709916,"grad_norm_ffn":0.1321876267541746,"grad_norm_attn_sem":0.017935083995374825,"grad_norm_attn_geo":0.009604787640837867,"grad_norm_total":0.9993046830592803,"wall_time":"2025-12-18T02:34:46+01:00"}
{"type":"train","step":40,"loss":8.043815612792969,"ppl":3114.474174980684,"lr":0.0003,"tok_s":11084.049811617228,"seq_len":256,"grad_accum":2,"global_batch":16,"step_ms":369.54002098646015,"data_ms":5.1947333791758865,"fwd_ms":75.22364190081134,"bwd_ms":207.38306692801416,"opt_ms":80.77154989587143,"grad_clip_norm":3.171875,"opt_state_bytes":233599264,"mps_mem_alloc_bytes":1523469056.0,"mps_mem_driver_bytes":6139740160.0,"cpu_rss_bytes":1004257280.0,"grad_norm_embed":0.9791329780582604,"grad_norm_attn":0.035011441734005014,"grad_norm_ffn":0.14599126500243534,"grad_norm_attn_sem":0.015184077893989715,"grad_norm_attn_geo":0.008582790821380021,"grad_norm_total":0.9907294584044208,"wall_time":"2025-12-18T02:34:49+01:00"}
{"type":"train","step":50,"loss":7.697044372558594,"ppl":2201.8305742359753,"lr":0.0003,"tok_s":10730.676856002352,"seq_len":256,"grad_accum":2,"global_batch":16,"step_ms":381.7093790974468,"data_ms":4.6017371758352965,"fwd_ms":73.45825808588415,"bwd_ms":222.58730001049116,"opt_ms":80.3195457905531,"grad_clip_norm":2.0,"opt_state_bytes":233599264,"mps_mem_alloc_bytes":1523469056.0,"mps_mem_driver_bytes":6139740160.0,"cpu_rss_bytes":1010073600.0,"grad_norm_embed":0.9947647757649186,"grad_norm_attn":0.05181014667605498,"grad_norm_ffn":0.09577316100808363,"grad_norm_attn_sem":0.04157056561969732,"grad_norm_attn_geo":0.021028585765006203,"grad_norm_total":1.001790428241317,"wall_time":"2025-12-18T02:34:53+01:00"}
{"type":"train","step":60,"loss":7.769670486450195,"ppl":2367.690973542727,"lr":0.0003,"tok_s":10835.362300717734,"seq_len":256,"grad_accum":2,"global_batch":16,"step_ms":378.02150830975734,"data_ms":4.297449794830754,"fwd_ms":73.47219989169389,"bwd_ms":219.57657100865617,"opt_ms":79.98425831319764,"grad_clip_norm":2.671875,"opt_state_bytes":233599264,"mps_mem_alloc_bytes":1523469056.0,"mps_mem_driver_bytes":6139740160.0,"cpu_rss_bytes":1014808576.0,"grad_norm_embed":0.9977237592954542,"grad_norm_attn":0.03430528731142057,"grad_norm_ffn":0.06286709643909696,"grad_norm_attn_sem":0.028898501322530003,"grad_norm_attn_geo":0.014361688156732699,"grad_norm_total":1.0008112738574915,"wall_time":"2025-12-18T02:34:57+01:00"}
{"type":"train","step":70,"loss":3.9247512817382812,"ppl":50.64048127990255,"lr":0.0003,"tok_s":11049.985584960239,"seq_len":256,"grad_accum":2,"global_batch":16,"step_ms":370.6792165932711,"data_ms":4.721545707434416,"fwd_ms":70.67953329533339,"bwd_ms":216.79890820523724,"opt_ms":77.76772079523653,"grad_clip_norm":1.2578125,"opt_state_bytes":233599264,"mps_mem_alloc_bytes":1523469056.0,"mps_mem_driver_bytes":6139740160.0,"cpu_rss_bytes":1020477440.0,"grad_norm_embed":0.9968116432135997,"grad_norm_attn":0.037823563203805324,"grad_norm_ffn":0.07904434311180511,"grad_norm_attn_sem":0.03083023967756703,"grad_norm_attn_geo":0.01622246174794177,"grad_norm_total":1.0012620806269183,"wall_time":"2025-12-18T02:35:01+01:00"}
{"type":"train","step":80,"loss":6.975555419921875,"ppl":1070.151407649806,"lr":0.0003,"tok_s":10843.264092511434,"seq_len":256,"grad_accum":2,"global_batch":16,"step_ms":377.74603339494206,"data_ms":3.149641607888043,"fwd_ms":78.15597050939687,"bwd_ms":211.4213791966904,"opt_ms":84.12021270487458,"grad_clip_norm":6.40625,"opt_state_bytes":233599264,"mps_mem_alloc_bytes":1523469056.0,"mps_mem_driver_bytes":6139740160.0,"cpu_rss_bytes":1025343488.0,"grad_norm_embed":1.0009511686620658,"grad_norm_attn":0.013278339109698332,"grad_norm_ffn":0.01786512780049876,"grad_norm_attn_sem":0.00966911135408079,"grad_norm_attn_geo":0.0059340889787059346,"grad_norm_total":1.0012629146498837,"wall_time":"2025-12-18T02:35:05+01:00"}
{"type":"train","step":90,"loss":6.934635162353516,"ppl":1027.2444062178042,"lr":0.0003,"tok_s":10913.795083997355,"seq_len":256,"grad_accum":2,"global_batch":16,"step_ms":375.30482920701616,"data_ms":3.9465251902583987,"fwd_ms":78.77399589633569,"bwd_ms":208.17603780305944,"opt_ms":83.50389150436968,"grad_clip_norm":6.15625,"opt_state_bytes":233599264,"mps_mem_alloc_bytes":1523469056.0,"mps_mem_driver_bytes":6139740160.0,"cpu_rss_bytes":1031618560.0,"grad_norm_embed":0.9938209265542364,"grad_norm_attn":0.015272633003402319,"grad_norm_ffn":0.02055640119497845,"grad_norm_attn_sem":0.011795236097551579,"grad_norm_attn_geo":0.006809877002014338,"grad_norm_total":0.9942441123916429,"wall_time":"2025-12-18T02:35:08+01:00"}
{"type":"analysis","step":100,"attn_entropy_mean":3.1616604328155518,"attn_topk_mass_mean":0.546016737818718,"attn_local_mass_mean":0.42749467492103577,"sem_energy_ratio_mean":0.6539491885202258,"geo_energy_ratio_mean":0.3460508114796553,"attn_erank_mean":52.96847915649414,"proj_stable_rank_mean":22.12895398190679,"wall_time":"2025-12-18T02:35:12+01:00"}
{"type":"train","step":100,"loss":6.67547607421875,"ppl":792.7247598762473,"lr":0.0003,"tok_s":10945.336524851722,"seq_len":256,"grad_accum":2,"global_batch":16,"step_ms":374.22330420813523,"data_ms":3.390104282880202,"fwd_ms":79.07033750088885,"bwd_ms":209.27794590243138,"opt_ms":81.62657091161236,"grad_clip_norm":5.90625,"opt_state_bytes":233599264,"mps_mem_alloc_bytes":1525566208.0,"mps_mem_driver_bytes":6154551296.0,"cpu_rss_bytes":1053769728.0,"grad_norm_embed":0.9988721171218925,"grad_norm_attn":0.011190090376502884,"grad_norm_ffn":0.018348004645164492,"grad_norm_attn_sem":0.007152148536401859,"grad_norm_attn_geo":0.0038466595056846986,"grad_norm_total":0.9991362888909122,"wall_time":"2025-12-18T02:35:12+01:00"}
{"type":"train","step":110,"loss":6.949073791503906,"ppl":1042.1840013406047,"lr":0.0003,"tok_s":10869.782153583104,"seq_len":256,"grad_accum":2,"global_batch":16,"step_ms":376.82447928818874,"data_ms":6.118304107803851,"fwd_ms":74.52262491569854,"bwd_ms":208.40175858465955,"opt_ms":87.02096259803511,"grad_clip_norm":5.34375,"opt_state_bytes":233599264,"mps_mem_alloc_bytes":1525435136.0,"mps_mem_driver_bytes":6154551296.0,"cpu_rss_bytes":1062420480.0,"grad_norm_embed":1.0044804319161562,"grad_norm_attn":0.022977441760251606,"grad_norm_ffn":0.0205928701332737,"grad_norm_attn_sem":0.017856917840748412,"grad_norm_attn_geo":0.009060045705321818,"grad_norm_total":1.0051536803770822,"wall_time":"2025-12-18T02:35:16+01:00"}
{"type":"train","step":120,"loss":8.04339599609375,"ppl":3113.1675637646913,"lr":0.0003,"tok_s":10997.087624279004,"seq_len":256,"grad_accum":2,"global_batch":16,"step_ms":372.4622500012629,"data_ms":4.496779089095071,"fwd_ms":76.1876038974151,"bwd_ms":207.4393211165443,"opt_ms":83.4603667142801,"grad_clip_norm":2.9375,"opt_state_bytes":233599264,"mps_mem_alloc_bytes":1525435136.0,"mps_mem_driver_bytes":6139871232.0,"cpu_rss_bytes":1067548672.0,"grad_norm_embed":1.0011881902327557,"grad_norm_attn":0.014853808163506847,"grad_norm_ffn":0.029756338211575105,"grad_norm_attn_sem":0.009902721145970919,"grad_norm_attn_geo":0.005890389481969051,"grad_norm_total":1.0018066820083629,"wall_time":"2025-12-18T02:35:20+01:00"}
{"type":"train","step":130,"loss":6.2580718994140625,"ppl":522.2110932902534,"lr":0.0003,"tok_s":10973.303579196847,"seq_len":256,"grad_accum":2,"global_batch":16,"step_ms":373.26954188756645,"data_ms":4.7608295164536685,"fwd_ms":76.86887919553556,"bwd_ms":207.26227081031539,"opt_ms":82.87283320678398,"grad_clip_norm":1.375,"opt_state_bytes":233599264,"mps_mem_alloc_bytes":1525435136.0,"mps_mem_driver_bytes":6139871232.0,"cpu_rss_bytes":1072840704.0,"grad_norm_embed":0.9941543163209742,"grad_norm_attn":0.022381554703886843,"grad_norm_ffn":0.0316822736074909,"grad_norm_attn_sem":0.01589531490665862,"grad_norm_attn_geo":0.00927516750556705,"grad_norm_total":0.995080999155227,"wall_time":"2025-12-18T02:35:23+01:00"}
{"type":"train","step":140,"loss":7.433849334716797,"ppl":1692.3093166495007,"lr":0.0003,"tok_s":11050.673486394817,"seq_len":256,"grad_accum":2,"global_batch":16,"step_ms":370.6561419123318,"data_ms":4.295912594534457,"fwd_ms":69.86745820031501,"bwd_ms":217.67858751118183,"opt_ms":77.51356250373647,"grad_clip_norm":2.375,"opt_state_bytes":233599264,"mps_mem_alloc_bytes":1525435136.0,"mps_mem_driver_bytes":6139871232.0,"cpu_rss_bytes":1077248000.0,"grad_norm_embed":0.9973750771291208,"grad_norm_attn":0.05229715065745966,"grad_norm_ffn":0.029810707085813223,"grad_norm_attn_sem":0.03877887969954192,"grad_norm_attn_geo":0.024184716156483373,"grad_norm_total":1.0002346808167002,"wall_time":"2025-12-18T02:35:27+01:00"}
{"type":"train","step":150,"loss":7.621269226074219,"ppl":2041.1511687205425,"lr":0.0003,"tok_s":10898.511931516923,"seq_len":256,"grad_accum":2,"global_batch":16,"step_ms":375.8311249956023,"data_ms":3.74407478957437,"fwd_ms":78.79528721095994,"bwd_ms":205.52394590340555,"opt_ms":86.87236250843853,"grad_clip_norm":1.4609375,"opt_state_bytes":233599264,"mps_mem_alloc_bytes":1525435136.0,"mps_mem_driver_bytes":6139871232.0,"cpu_rss_bytes":1081344000.0,"grad_norm_embed":0.9982420830501725,"grad_norm_attn":0.03576598460880315,"grad_norm_ffn":0.03130126964069947,"grad_norm_attn_sem":0.021914651689178204,"grad_norm_attn_geo":0.01340391768170358,"grad_norm_total":0.9997030301426421,"wall_time":"2025-12-18T02:35:31+01:00"}
{"type":"train","step":160,"loss":7.436100006103516,"ppl":1696.1224382381674,"lr":0.0003,"tok_s":10852.889224837698,"seq_len":256,"grad_accum":2,"global_batch":16,"step_ms":377.411020710133,"data_ms":4.196537710959092,"fwd_ms":74.91523320204578,"bwd_ms":212.41579589550383,"opt_ms":84.4113455968909,"grad_clip_norm":0.93359375,"opt_state_bytes":233599264,"mps_mem_alloc_bytes":1525435136.0,"mps_mem_driver_bytes":6139871232.0,"cpu_rss_bytes":1086701568.0,"grad_norm_embed":0.9127989384235693,"grad_norm_attn":0.1784155503934122,"grad_norm_ffn":0.05407232532956962,"grad_norm_attn_sem":0.12957170417314604,"grad_norm_attn_geo":0.07486570293687637,"grad_norm_total":0.9435844037363547,"wall_time":"2025-12-18T02:35:35+01:00"}
{"type":"train","step":170,"loss":7.441804885864258,"ppl":1705.826266075224,"lr":0.0003,"tok_s":10863.875236026644,"seq_len":256,"grad_accum":2,"global_batch":16,"step_ms":377.02936668647453,"data_ms":3.3802209072746336,"fwd_ms":78.57546239392832,"bwd_ms":209.69521250808612,"opt_ms":84.44811240187846,"grad_clip_norm":1.9375,"opt_state_bytes":233599264,"mps_mem_alloc_bytes":1525435136.0,"mps_mem_driver_bytes":6139871232.0,"cpu_rss_bytes":1091321856.0,"grad_norm_embed":0.9915475907558409,"grad_norm_attn":0.07454795835051627,"grad_norm_ffn":0.0386413249050374,"grad_norm_attn_sem":0.0570992004747231,"grad_norm_attn_geo":0.02423024757270499,"grad_norm_total":0.9970278824639994,"wall_time":"2025-12-18T02:35:39+01:00"}
{"type":"train","step":180,"loss":7.418607711791992,"ppl":1666.7113490053835,"lr":0.0003,"tok_s":10813.989321293007,"seq_len":256,"grad_accum":2,"global_batch":16,"step_ms":378.76863739220425,"data_ms":3.758129302877933,"fwd_ms":78.74675832572393,"bwd_ms":211.91847079899162,"opt_ms":83.4585294011049,"grad_clip_norm":0.8515625,"opt_state_bytes":233599264,"mps_mem_alloc_bytes":1525435136.0,"mps_mem_driver_bytes":6139871232.0,"cpu_rss_bytes":1095647232.0,"grad_norm_embed":0.8505167152481592,"grad_norm_attn":0.056008454359281076,"grad_norm_ffn":0.029428952300451432,"grad_norm_attn_sem":0.04451574447808984,"grad_norm_attn_geo":0.021827679919171353,"grad_norm_total":0.8543066148794756,"wall_time":"2025-12-18T02:35:42+01:00"}
{"type":"train","step":190,"loss":7.020975112915039,"ppl":1119.878093095994,"lr":0.0003,"tok_s":10894.24201190629,"seq_len":256,"grad_accum":2,"global_batch":16,"step_ms":375.97842929535545,"data_ms":3.7717330851592124,"fwd_ms":79.47954160626978,"bwd_ms":208.0325746908784,"opt_ms":83.82382899872027,"grad_clip_norm":4.9375,"opt_state_bytes":233599264,"mps_mem_alloc_bytes":1525435136.0,"mps_mem_driver_bytes":6139871232.0,"cpu_rss_bytes":1100595200.0,"grad_norm_embed":0.9965169394869002,"grad_norm_attn":0.034551859026355464,"grad_norm_ffn":0.028338307552184975,"grad_norm_attn_sem":0.016809221313247275,"grad_norm_attn_geo":0.008389706402058241,"grad_norm_total":0.9976952633024315,"wall_time":"2025-12-18T02:35:46+01:00"}
{"type":"eval","step":200,"train_loss":7.348745632171631,"val_loss":7.3013608932495115,"val_ppl":1482.3158291655482,"best_val":7.3013608932495115,"wall_time":"2025-12-18T02:35:53+01:00"}
{"type":"analysis","step":200,"attn_entropy_mean":2.484858363866806,"attn_topk_mass_mean":0.6645799577236176,"attn_local_mass_mean":0.42803026735782623,"sem_energy_ratio_mean":0.688730082181022,"geo_energy_ratio_mean":0.3112699178188849,"attn_erank_mean":47.25143051147461,"proj_stable_rank_mean":22.067318650822024,"wall_time":"2025-12-18T02:35:53+01:00"}
{"type":"train","step":200,"loss":7.405618667602539,"ppl":1645.2023546880484,"lr":0.0003,"tok_s":10924.628971688613,"seq_len":256,"grad_accum":2,"global_batch":16,"step_ms":374.9326417047996,"data_ms":3.11580011039041,"fwd_ms":77.94576660380699,"bwd_ms":210.4773666127585,"opt_ms":82.53287511179224,"grad_clip_norm":2.65625,"opt_state_bytes":233599264,"mps_mem_alloc_bytes":1525435136.0,"mps_mem_driver_bytes":6154551296.0,"cpu_rss_bytes":1134854144.0,"grad_norm_embed":0.9996509078735797,"grad_norm_attn":0.036647525783775024,"grad_norm_ffn":0.028861245466381302,"grad_norm_attn_sem":0.027942671684914946,"grad_norm_attn_geo":0.013102371522432803,"grad_norm_total":1.0012144701755055,"wall_time":"2025-12-18T02:35:53+01:00"}
{"type":"train","step":210,"loss":6.58095645904541,"ppl":721.2288252929948,"lr":0.0003,"tok_s":10842.976095221471,"seq_len":256,"grad_accum":2,"global_batch":16,"step_ms":377.7560666028876,"data_ms":4.329808190232143,"fwd_ms":78.12222900683992,"bwd_ms":212.72222080733627,"opt_ms":81.72436659224331,"grad_clip_norm":8.875,"opt_state_bytes":233599264,"mps_mem_alloc_bytes":1525435136.0,"mps_mem_driver_bytes":6154551296.0,"cpu_rss_bytes":1139277824.0,"grad_norm_embed":1.0012194240987633,"grad_norm_attn":0.021844797300103965,"grad_norm_ffn":0.01991705889441455,"grad_norm_attn_sem":0.012543383411588699,"grad_norm_attn_geo":0.006014874340781242,"grad_norm_total":1.0017523320549302,"wall_time":"2025-12-18T02:35:56+01:00"}
{"type":"train","step":220,"loss":7.295567035675049,"ppl":1473.7523341616845,"lr":0.0003,"tok_s":10957.049276618704,"seq_len":256,"grad_accum":2,"global_batch":16,"step_ms":373.823270900175,"data_ms":3.2301460159942508,"fwd_ms":77.1502542833332,"bwd_ms":211.26683349721134,"opt_ms":81.31667070556432,"grad_clip_norm":1.1640625,"opt_state_bytes":233599264,"mps_mem_alloc_bytes":1525435136.0,"mps_mem_driver_bytes":6139871232.0,"cpu_rss_bytes":1143275520.0,"grad_norm_embed":0.9948881445365166,"grad_norm_attn":0.10267078520568679,"grad_norm_ffn":0.0425024509628939,"grad_norm_attn_sem":0.05431046092797998,"grad_norm_attn_geo":0.02830860509475316,"grad_norm_total":1.002946245768206,"wall_time":"2025-12-18T02:36:00+01:00"}
{"type":"train","step":230,"loss":7.291003227233887,"ppl":1467.041735410022,"lr":0.0003,"tok_s":10935.209594230033,"seq_len":256,"grad_accum":2,"global_batch":16,"step_ms":374.56986669567414,"data_ms":3.124712489079684,"fwd_ms":77.50355420866981,"bwd_ms":211.89068319508806,"opt_ms":81.17203321307898,"grad_clip_norm":1.203125,"opt_state_bytes":233599264,"mps_mem_alloc_bytes":1525435136.0,"mps_mem_driver_bytes":6139871232.0,"cpu_rss_bytes":1147011072.0,"grad_norm_embed":0.9687939430084043,"grad_norm_attn":0.24992007027034369,"grad_norm_ffn":0.03620250733051203,"grad_norm_attn_sem":0.1808478015931135,"grad_norm_attn_geo":0.1506650251682489,"grad_norm_total":1.0284640218406922,"wall_time":"2025-12-18T02:36:04+01:00"}
{"type":"train","step":240,"loss":6.207258224487305,"ppl":496.3385351678997,"lr":0.0003,"tok_s":10780.033769289286,"seq_len":256,"grad_accum":2,"global_batch":16,"step_ms":379.9617039854638,"data_ms":3.639799897791818,"fwd_ms":78.94547520554624,"bwd_ms":210.17945830826648,"opt_ms":85.8729126106482,"grad_clip_norm":4.1875,"opt_state_bytes":233599264,"mps_mem_alloc_bytes":1525435136.0,"mps_mem_driver_bytes":6139871232.0,"cpu_rss_bytes":1151057920.0,"grad_norm_embed":1.002571686526215,"grad_norm_attn":0.025476580917648105,"grad_norm_ffn":0.024527291507064026,"grad_norm_attn_sem":0.008451368855221178,"grad_norm_attn_geo":0.005012328130755589,"grad_norm_total":1.0032433303524937,"wall_time":"2025-12-18T02:36:08+01:00"}
{"type":"train","step":250,"loss":7.190308570861816,"ppl":1326.5124655558263,"lr":0.0003,"tok_s":10952.739357701474,"seq_len":256,"grad_accum":2,"global_batch":16,"step_ms":373.97037090267986,"data_ms":3.1470502028241754,"fwd_ms":76.41474548727274,"bwd_ms":211.52219180366956,"opt_ms":81.9818582967855,"grad_clip_norm":1.6015625,"opt_state_bytes":233599264,"mps_mem_alloc_bytes":1525435136.0,"mps_mem_driver_bytes":6139871232.0,"cpu_rss_bytes":1155334144.0,"grad_norm_embed":0.994451157158549,"grad_norm_attn":0.07141176057887265,"grad_norm_ffn":0.028958578250319375,"grad_norm_attn_sem":0.048647424724483176,"grad_norm_attn_geo":0.025824335685031577,"grad_norm_total":0.998951856208861,"wall_time":"2025-12-18T02:36:11+01:00"}
{"type":"train","step":260,"loss":7.175601005554199,"ppl":1307.1454666469622,"lr":0.0003,"tok_s":10834.323233616233,"seq_len":256,"grad_accum":2,"global_batch":16,"step_ms":378.05776250897907,"data_ms":4.521450214087963,"fwd_ms":80.21642919047736,"bwd_ms":209.94924569968134,"opt_ms":82.49262941535562,"grad_clip_norm":0.80078125,"opt_state_bytes":233599264,"mps_mem_alloc_bytes":1525435136.0,"mps_mem_driver_bytes":6139871232.0,"cpu_rss_bytes":1159118848.0,"grad_norm_embed":0.7959431727831665,"grad_norm_attn":0.07559632079218706,"grad_norm_ffn":0.030325293228623408,"grad_norm_attn_sem":0.05650822039906148,"grad_norm_attn_geo":0.029992333814373665,"grad_norm_total":0.8026535245591042,"wall_time":"2025-12-18T02:36:15+01:00"}
