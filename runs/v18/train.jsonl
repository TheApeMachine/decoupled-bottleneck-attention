{"type": "run_start", "time": 1765590920.801335, "device": "mps", "vocab_size": 284, "baseline_nll_logV": 5.648974238161206, "baseline_ppl": 284.00000000000006, "steps_per_epoch": 1184, "rank_update_every": 1184, "args": {"mode": "train", "data": "wiki.train.tokens", "out_dir": "runs/v18", "resume": null, "ckpt": null, "device": null, "seed": 1337, "block_size": 256, "n_layer": 6, "n_head": 8, "n_embd": 512, "dropout": 0.1, "init_rank": 64, "min_rank": 8, "max_rank": 64, "safety_factor": 1.5, "ema_decay": 0.8, "change_threshold": 2.0, "max_step": 4, "power_iters": 5, "resize_method": "svd", "rank_update_every": 0, "log_ranks_full": false, "train_frac": 0.9, "batch_size": 32, "max_steps": 30000, "grad_clip": 1.0, "lr": 0.0003, "min_lr": 3e-05, "warmup_steps": 500, "weight_decay": 0.01, "amp": false, "eval_interval": 500, "eval_iters": 50, "log_interval": 50, "sample_every": 0, "sample_len": 200, "overfit_one_batch": false, "prompt": "", "max_new_tokens": 200, "temperature": 0.8, "top_k": 0, "top_p": 0.0}, "model_cfg": {"vocab_size": 284, "block_size": 256, "n_layer": 6, "n_head": 8, "n_embd": 512, "dropout": 0.1, "init_rank": 64, "min_rank": 8, "max_rank": 64, "safety_factor": 1.5, "ema_decay": 0.8, "change_threshold": 2.0, "max_step": 4, "power_iters": 5}, "rank_stats": {"r_min": 64, "r_mean": 64.0, "r_max": 64}}
{"type": "train_step", "time": 1765590921.006092, "step": 1, "epoch": 0.0008445945945945946, "lr": 0.0, "loss": 6.673382759094238, "ppl": 791.0670727828832, "r_min": 64, "r_mean": 64.0, "r_max": 64, "tokens_per_step": 8192, "tok_per_sec": null}
{"type": "train_step", "time": 1765590925.469482, "step": 50, "epoch": 0.04222972972972973, "lr": 2.94e-05, "loss": 4.195580959320068, "ppl": 66.39229159589254, "r_min": 64, "r_mean": 64.0, "r_max": 64, "tokens_per_step": 8192, "tok_per_sec": 91767.74647893343}
{"type": "train_step", "time": 1765590930.021648, "step": 100, "epoch": 0.08445945945945946, "lr": 5.9399999999999994e-05, "loss": 3.0127899646759033, "ppl": 20.34408008545462, "r_min": 64, "r_mean": 64.0, "r_max": 64, "tokens_per_step": 8192, "tok_per_sec": 89979.81348791961}
{"type": "train_step", "time": 1765590934.579158, "step": 150, "epoch": 0.1266891891891892, "lr": 8.939999999999999e-05, "loss": 2.5990312099456787, "ppl": 13.450700815683277, "r_min": 64, "r_mean": 64.0, "r_max": 64, "tokens_per_step": 8192, "tok_per_sec": 89873.02792592815}
{"type": "train_step", "time": 1765590939.1383228, "step": 200, "epoch": 0.16891891891891891, "lr": 0.00011939999999999999, "loss": 2.491617202758789, "ppl": 12.080797430164605, "r_min": 64, "r_mean": 64.0, "r_max": 64, "tokens_per_step": 8192, "tok_per_sec": 89841.3695987041}
{"type": "train_step", "time": 1765590943.702903, "step": 250, "epoch": 0.21114864864864866, "lr": 0.00014939999999999997, "loss": 2.480299234390259, "ppl": 11.944838189497121, "r_min": 64, "r_mean": 64.0, "r_max": 64, "tokens_per_step": 8192, "tok_per_sec": 89734.6872126888}
{"type": "train_step", "time": 1765590948.266968, "step": 300, "epoch": 0.2533783783783784, "lr": 0.00017939999999999997, "loss": 2.435889720916748, "ppl": 11.425980125798302, "r_min": 64, "r_mean": 64.0, "r_max": 64, "tokens_per_step": 8192, "tok_per_sec": 89744.4795571959}
{"type": "train_step", "time": 1765590952.8281999, "step": 350, "epoch": 0.2956081081081081, "lr": 0.00020939999999999997, "loss": 2.4488892555236816, "ppl": 11.57548217304979, "r_min": 64, "r_mean": 64.0, "r_max": 64, "tokens_per_step": 8192, "tok_per_sec": 89799.71575403221}
{"type": "train_step", "time": 1765590957.396396, "step": 400, "epoch": 0.33783783783783783, "lr": 0.00023939999999999996, "loss": 2.4364004135131836, "ppl": 11.431816779496629, "r_min": 64, "r_mean": 64.0, "r_max": 64, "tokens_per_step": 8192, "tok_per_sec": 89665.85895797457}
{"type": "train_step", "time": 1765590961.985677, "step": 450, "epoch": 0.38006756756756754, "lr": 0.0002694, "loss": 2.3966684341430664, "ppl": 10.986513049639315, "r_min": 64, "r_mean": 64.0, "r_max": 64, "tokens_per_step": 8192, "tok_per_sec": 89250.86772972636}
{"type": "train_step", "time": 1765590966.580907, "step": 500, "epoch": 0.4222972972972973, "lr": 0.0002994, "loss": 2.3750181198120117, "ppl": 10.75120799417916, "r_min": 64, "r_mean": 64.0, "r_max": 64, "tokens_per_step": 8192, "tok_per_sec": 89136.77578931268}
{"type": "eval", "time": 1765590967.965569, "step": 500, "val_loss": 2.3741064977645876, "val_ppl": 10.741411421999276, "r_min": 64, "r_mean": 64.0, "r_max": 64}
{"type": "train_step", "time": 1765590972.777475, "step": 550, "epoch": 0.46452702702702703, "lr": 0.00029999816197818824, "loss": 2.337526321411133, "ppl": 10.355588455785728, "r_min": 64, "r_mean": 64.0, "r_max": 64, "tokens_per_step": 8192, "tok_per_sec": 66100.80859449411}
{"type": "train_step", "time": 1765590977.404295, "step": 600, "epoch": 0.5067567567567568, "lr": 0.0002999924971571056, "loss": 2.365954875946045, "ppl": 10.654207408244332, "r_min": 64, "r_mean": 64.0, "r_max": 64, "tokens_per_step": 8192, "tok_per_sec": 88528.09473876825}
{"type": "train_step", "time": 1765590982.038987, "step": 650, "epoch": 0.5489864864864865, "lr": 0.00029998300493183974, "loss": 2.330768585205078, "ppl": 10.285844043331632, "r_min": 64, "r_mean": 64.0, "r_max": 64, "tokens_per_step": 8192, "tok_per_sec": 88377.30412394892}
{"type": "train_step", "time": 1765590986.671369, "step": 700, "epoch": 0.5912162162162162, "lr": 0.00029996968557152124, "loss": 2.3618524074554443, "ppl": 10.610588392055993, "r_min": 64, "r_mean": 64.0, "r_max": 64, "tokens_per_step": 8192, "tok_per_sec": 88419.58254419456}
{"type": "train_step", "time": 1765590991.367913, "step": 750, "epoch": 0.6334459459459459, "lr": 0.00029995253945379005, "loss": 2.314178466796875, "ppl": 10.116608374191323, "r_min": 64, "r_mean": 64.0, "r_max": 64, "tokens_per_step": 8192, "tok_per_sec": 87214.34639202975}
{"type": "train_step", "time": 1765590996.0076108, "step": 800, "epoch": 0.6756756756756757, "lr": 0.0002999315670647853, "loss": 2.2574639320373535, "ppl": 9.55881659280333, "r_min": 64, "r_mean": 64.0, "r_max": 64, "tokens_per_step": 8192, "tok_per_sec": 88281.2672045082}
{"type": "train_step", "time": 1765591000.6672719, "step": 850, "epoch": 0.7179054054054054, "lr": 0.0002999067689991311, "loss": 2.2725841999053955, "ppl": 9.704446668550036, "r_min": 64, "r_mean": 64.0, "r_max": 64, "tokens_per_step": 8192, "tok_per_sec": 87903.96057942967}
{"type": "train_step", "time": 1765591005.306941, "step": 900, "epoch": 0.7601351351351351, "lr": 0.0002998781459599201, "loss": 2.2329952716827393, "ppl": 9.327763464270934, "r_min": 64, "r_mean": 64.0, "r_max": 64, "tokens_per_step": 8192, "tok_per_sec": 88282.61001764484}
{"type": "train_step", "time": 1765591009.946445, "step": 950, "epoch": 0.8023648648648649, "lr": 0.00029984569875869324, "loss": 2.2046406269073486, "ppl": 9.066992549136238, "r_min": 64, "r_mean": 64.0, "r_max": 64, "tokens_per_step": 8192, "tok_per_sec": 88284.30673860539}
{"type": "train_step", "time": 1765591014.569985, "step": 1000, "epoch": 0.8445945945945946, "lr": 0.00029980942831541683, "loss": 2.167207717895508, "ppl": 8.733862552657417, "r_min": 64, "r_mean": 64.0, "r_max": 64, "tokens_per_step": 8192, "tok_per_sec": 88591.12067847495}
{"type": "eval", "time": 1765591015.934817, "step": 1000, "val_loss": 2.127353515625, "val_ppl": 8.392626440284063, "r_min": 64, "r_mean": 64.0, "r_max": 64}
{"type": "train_step", "time": 1765591020.779335, "step": 1050, "epoch": 0.8868243243243243, "lr": 0.00029976933565845656, "loss": 2.1583309173583984, "ppl": 8.65667688458522, "r_min": 64, "r_mean": 64.0, "r_max": 64, "tokens_per_step": 8192, "tok_per_sec": 65964.83534525693}
{"type": "train_step", "time": 1765591025.4069471, "step": 1100, "epoch": 0.9290540540540541, "lr": 0.0002997254219245481, "loss": 2.1614787578582764, "ppl": 8.683969656786946, "r_min": 64, "r_mean": 64.0, "r_max": 64, "tokens_per_step": 8192, "tok_per_sec": 88515.17742353232}
{"type": "train_step", "time": 1765591030.014338, "step": 1150, "epoch": 0.9712837837837838, "lr": 0.00029967768835876537, "loss": 2.107318878173828, "ppl": 8.2261563643015, "r_min": 64, "r_mean": 64.0, "r_max": 64, "tokens_per_step": 8192, "tok_per_sec": 88897.80671192866}
{"type": "rank_update", "step": 1184, "changed_layers": 33, "total_layers": 36, "r_min": 60, "r_mean": 60.44444274902344, "r_max": 64, "resize_method": "svd", "took_sec": 1.2274377346038818}
{"type": "rank_change", "step": -4.0, "layer": "blocks.0.attn.q_proj", "old_rank": 64, "new_rank": 60, "stable_rank": 8.222684743333131, "fro2": 5.858501434326172, "sigma2": 0.7124803558654413, "raw_target": 12.334027114999696, "ema_target": 53.66680542299994, "delta": -10.333194577000057}
{"type": "rank_change", "step": -4.0, "layer": "blocks.0.attn.k_proj", "old_rank": 64, "new_rank": 60, "stable_rank": 3.511599111530396, "fro2": 7.498501777648926, "sigma2": 2.13535244325341, "raw_target": 8.0, "ema_target": 52.800000000000004, "delta": -11.199999999999996}
{"type": "rank_change", "step": -4.0, "layer": "blocks.0.attn.v_proj", "old_rank": 64, "new_rank": 60, "stable_rank": 10.098943960944641, "fro2": 3.63040828704834, "sigma2": 0.3594839420932203, "raw_target": 15.148415941416962, "ema_target": 54.229683188283396, "delta": -9.770316811716604}
{"type": "rank_change", "step": -4.0, "layer": "blocks.0.attn.o_proj", "old_rank": 64, "new_rank": 60, "stable_rank": 11.077580597954107, "fro2": 3.7336137294769287, "sigma2": 0.3370423339001185, "raw_target": 16.61637089693116, "ema_target": 54.523274179386235, "delta": -9.476725820613765}
{"type": "rank_change", "step": -4.0, "layer": "blocks.1.attn.q_proj", "old_rank": 64, "new_rank": 60, "stable_rank": 2.554979691153556, "fro2": 10.960384368896484, "sigma2": 4.289812706259966, "raw_target": 8.0, "ema_target": 52.800000000000004, "delta": -11.199999999999996}
{"type": "rank_change", "step": -4.0, "layer": "blocks.1.attn.k_proj", "old_rank": 64, "new_rank": 60, "stable_rank": 1.208837408833228, "fro2": 22.625242233276367, "sigma2": 18.716530491082267, "raw_target": 8.0, "ema_target": 52.800000000000004, "delta": -11.199999999999996}
{"type": "rank_change", "step": -4.0, "layer": "blocks.1.attn.v_proj", "old_rank": 64, "new_rank": 60, "stable_rank": 16.33802533813901, "fro2": 3.7147645950317383, "sigma2": 0.22736924167817563, "raw_target": 24.507038007208514, "ema_target": 56.10140760144171, "delta": -7.898592398558293}
{"type": "rank_change", "step": -4.0, "layer": "blocks.1.attn.o_proj", "old_rank": 64, "new_rank": 60, "stable_rank": 18.43982806957453, "fro2": 3.896341323852539, "sigma2": 0.21130029655120097, "raw_target": 27.659742104361797, "ema_target": 56.731948420872364, "delta": -7.268051579127636}
{"type": "rank_change", "step": -4.0, "layer": "blocks.1.mlp.fc1", "old_rank": 64, "new_rank": 60, "stable_rank": 14.628914070579192, "fro2": 13.282703399658203, "sigma2": 0.9079760253758309, "raw_target": 21.94337110586879, "ema_target": 55.58867422117376, "delta": -8.411325778826239}
{"type": "rank_change", "step": -3.0, "layer": "blocks.1.mlp.fc2", "old_rank": 64, "new_rank": 61, "stable_rank": 30.35453554316321, "fro2": 11.612881660461426, "sigma2": 0.38257483269354964, "raw_target": 45.53180331474481, "ema_target": 60.30636066294896, "delta": -3.6936393370510388}
{"type": "rank_change", "step": -4.0, "layer": "blocks.2.attn.q_proj", "old_rank": 64, "new_rank": 60, "stable_rank": 3.3330265201039477, "fro2": 4.686454772949219, "sigma2": 1.4060658417661784, "raw_target": 8.0, "ema_target": 52.800000000000004, "delta": -11.199999999999996}
{"type": "rank_change", "step": -4.0, "layer": "blocks.2.attn.k_proj", "old_rank": 64, "new_rank": 60, "stable_rank": 2.318668065659411, "fro2": 7.57460355758667, "sigma2": 3.266790812615014, "raw_target": 8.0, "ema_target": 52.800000000000004, "delta": -11.199999999999996}
{"type": "rank_change", "step": -4.0, "layer": "blocks.2.attn.v_proj", "old_rank": 64, "new_rank": 60, "stable_rank": 11.419911539807208, "fro2": 3.3066656589508057, "sigma2": 0.28955264086113175, "raw_target": 17.12986730971081, "ema_target": 54.625973461942166, "delta": -9.374026538057834}
{"type": "rank_change", "step": -4.0, "layer": "blocks.2.attn.o_proj", "old_rank": 64, "new_rank": 60, "stable_rank": 10.077746553504474, "fro2": 3.3668203353881836, "sigma2": 0.33408463060027316, "raw_target": 15.11661983025671, "ema_target": 54.223323966051346, "delta": -9.776676033948654}
{"type": "rank_change", "step": -3.0, "layer": "blocks.2.mlp.fc1", "old_rank": 64, "new_rank": 61, "stable_rank": 30.93656015697379, "fro2": 11.13722038269043, "sigma2": 0.3600018882776226, "raw_target": 46.40484023546068, "ema_target": 60.480968047092134, "delta": -3.5190319529078664}
{"type": "rank_change", "step": -4.0, "layer": "blocks.3.attn.q_proj", "old_rank": 64, "new_rank": 60, "stable_rank": 2.252008586188833, "fro2": 41.92951583862305, "sigma2": 18.618719339370728, "raw_target": 8.0, "ema_target": 52.800000000000004, "delta": -11.199999999999996}
{"type": "rank_change", "step": -4.0, "layer": "blocks.3.attn.k_proj", "old_rank": 64, "new_rank": 60, "stable_rank": 1.1334460353603282, "fro2": 44.59912109375, "sigma2": 39.34825275403364, "raw_target": 8.0, "ema_target": 52.800000000000004, "delta": -11.199999999999996}
{"type": "rank_change", "step": -4.0, "layer": "blocks.3.attn.v_proj", "old_rank": 64, "new_rank": 60, "stable_rank": 12.235622265269328, "fro2": 5.314271926879883, "sigma2": 0.43432787391681416, "raw_target": 18.35343339790399, "ema_target": 54.8706866795808, "delta": -9.1293133204192}
{"type": "rank_change", "step": -4.0, "layer": "blocks.3.attn.o_proj", "old_rank": 64, "new_rank": 60, "stable_rank": 15.889155922924346, "fro2": 5.289706707000732, "sigma2": 0.3329129988885917, "raw_target": 23.83373388438652, "ema_target": 55.96674677687731, "delta": -8.033253223122692}
{"type": "rank_change", "step": -4.0, "layer": "blocks.3.mlp.fc1", "old_rank": 64, "new_rank": 60, "stable_rank": 10.316146151375467, "fro2": 15.063140869140625, "sigma2": 1.4601519351265466, "raw_target": 15.4742192270632, "ema_target": 54.29484384541264, "delta": -9.705156154587357}
{"type": "rank_change", "step": -2.0, "layer": "blocks.3.mlp.fc2", "old_rank": 64, "new_rank": 62, "stable_rank": 34.55542067525085, "fro2": 12.033687591552734, "sigma2": 0.34824311239299277, "raw_target": 51.83313101287628, "ema_target": 61.56662620257526, "delta": -2.4333737974247427}
{"type": "rank_change", "step": -4.0, "layer": "blocks.4.attn.q_proj", "old_rank": 64, "new_rank": 60, "stable_rank": 2.047993059605927, "fro2": 34.92558288574219, "sigma2": 17.05356505064651, "raw_target": 8.0, "ema_target": 52.800000000000004, "delta": -11.199999999999996}
{"type": "rank_change", "step": -4.0, "layer": "blocks.4.attn.k_proj", "old_rank": 64, "new_rank": 60, "stable_rank": 1.259765597081916, "fro2": 39.89170837402344, "sigma2": 31.665976951450148, "raw_target": 8.0, "ema_target": 52.800000000000004, "delta": -11.199999999999996}
{"type": "rank_change", "step": -4.0, "layer": "blocks.4.attn.v_proj", "old_rank": 64, "new_rank": 60, "stable_rank": 11.946501103911036, "fro2": 4.800433158874512, "sigma2": 0.4018275307267949, "raw_target": 17.919751655866555, "ema_target": 54.783950331173315, "delta": -9.216049668826685}
{"type": "rank_change", "step": -4.0, "layer": "blocks.4.attn.o_proj", "old_rank": 64, "new_rank": 60, "stable_rank": 11.363317653188407, "fro2": 5.013879776000977, "sigma2": 0.44123378536029634, "raw_target": 17.044976479782612, "ema_target": 54.608995295956525, "delta": -9.391004704043475}
{"type": "rank_change", "step": -4.0, "layer": "blocks.4.mlp.fc1", "old_rank": 64, "new_rank": 60, "stable_rank": 9.159270583029286, "fro2": 14.863130569458008, "sigma2": 1.6227417175996948, "raw_target": 13.73890587454393, "ema_target": 53.94778117490879, "delta": -10.05221882509121}
{"type": "rank_change", "step": -4.0, "layer": "blocks.4.mlp.fc2", "old_rank": 64, "new_rank": 60, "stable_rank": 23.1075688394304, "fro2": 12.234125137329102, "sigma2": 0.5294423221787525, "raw_target": 34.6613532591456, "ema_target": 58.132270651829124, "delta": -5.867729348170876}
{"type": "rank_change", "step": -4.0, "layer": "blocks.5.attn.q_proj", "old_rank": 64, "new_rank": 60, "stable_rank": 1.2470476456597879, "fro2": 32.66471862792969, "sigma2": 26.19364122064235, "raw_target": 8.0, "ema_target": 52.800000000000004, "delta": -11.199999999999996}
{"type": "rank_change", "step": -4.0, "layer": "blocks.5.attn.k_proj", "old_rank": 64, "new_rank": 60, "stable_rank": 1.2821258202125754, "fro2": 19.92275619506836, "sigma2": 15.538846397262262, "raw_target": 8.0, "ema_target": 52.800000000000004, "delta": -11.199999999999996}
{"type": "rank_change", "step": -4.0, "layer": "blocks.5.attn.v_proj", "old_rank": 64, "new_rank": 60, "stable_rank": 12.625853021410528, "fro2": 4.328900337219238, "sigma2": 0.3428600193285867, "raw_target": 18.93877953211579, "ema_target": 54.98775590642316, "delta": -9.01224409357684}
{"type": "rank_change", "step": -4.0, "layer": "blocks.5.attn.o_proj", "old_rank": 64, "new_rank": 60, "stable_rank": 11.342799952645942, "fro2": 4.301112174987793, "sigma2": 0.3791931515601199, "raw_target": 17.014199928968914, "ema_target": 54.602839985793786, "delta": -9.397160014206214}
{"type": "rank_change", "step": -4.0, "layer": "blocks.5.mlp.fc1", "old_rank": 64, "new_rank": 60, "stable_rank": 12.534004855575962, "fro2": 15.520126342773438, "sigma2": 1.2382415992546072, "raw_target": 18.801007283363944, "ema_target": 54.96020145667279, "delta": -9.039798543327208}
{"type": "rank_change", "step": -4.0, "layer": "blocks.5.mlp.fc2", "old_rank": 64, "new_rank": 60, "stable_rank": 15.923570923644515, "fro2": 12.898457527160645, "sigma2": 0.8100229169559157, "raw_target": 23.88535638546677, "ema_target": 55.97707127709336, "delta": -8.022928722906641}
{"type": "train_step", "time": 1765591035.825879, "step": 1200, "epoch": 1.0135135135135136, "lr": 0.00029962613631448454, "loss": 2.14809513092041, "ppl": 8.568520931171447, "r_min": 60, "r_mean": 60.44444274902344, "r_max": 64, "tokens_per_step": 8192, "tok_per_sec": 70480.76280622238}
{"type": "train_step", "time": 1765591040.414196, "step": 1250, "epoch": 1.0557432432432432, "lr": 0.0002995707672533462, "loss": 2.071805477142334, "ppl": 7.939144129084785, "r_min": 60, "r_mean": 60.44444274902344, "r_max": 64, "tokens_per_step": 8192, "tok_per_sec": 89269.95165615987}
{"type": "train_step", "time": 1765591044.995824, "step": 1300, "epoch": 1.097972972972973, "lr": 0.0002995115827452137, "loss": 2.0339908599853516, "ppl": 7.644533826733698, "r_min": 60, "r_mean": 60.44444274902344, "r_max": 64, "tokens_per_step": 8192, "tok_per_sec": 89400.80906787135}
{"type": "train_step", "time": 1765591049.575901, "step": 1350, "epoch": 1.1402027027027026, "lr": 0.00029944858446812874, "loss": 2.03324556350708, "ppl": 7.638838505209774, "r_min": 60, "r_mean": 60.44444274902344, "r_max": 64, "tokens_per_step": 8192, "tok_per_sec": 89430.397863149}
{"type": "train_step", "time": 1765591054.153706, "step": 1400, "epoch": 1.1824324324324325, "lr": 0.00029938177420826373, "loss": 2.0333409309387207, "ppl": 7.639567036357254, "r_min": 60, "r_mean": 60.44444274902344, "r_max": 64, "tokens_per_step": 8192, "tok_per_sec": 89477.11055481179}
{"type": "train_step", "time": 1765591058.722368, "step": 1450, "epoch": 1.224662162162162, "lr": 0.00029931115385987105, "loss": 2.001891613006592, "ppl": 7.403046561652729, "r_min": 60, "r_mean": 60.44444274902344, "r_max": 64, "tokens_per_step": 8192, "tok_per_sec": 89653.15957256722}
{"type": "train_step", "time": 1765591063.2954, "step": 1500, "epoch": 1.2668918918918919, "lr": 0.00029923672542522947, "loss": 2.0014190673828125, "ppl": 7.39954911081501, "r_min": 60, "r_mean": 60.44444274902344, "r_max": 64, "tokens_per_step": 8192, "tok_per_sec": 89567.23153190954}
{"type": "eval", "time": 1765591064.593023, "step": 1500, "val_loss": 1.9544402599334716, "val_ppl": 7.059966171584991, "r_min": 60, "r_mean": 60.44444274902344, "r_max": 64}
{"type": "train_step", "time": 1765591069.355519, "step": 1550, "epoch": 1.3091216216216217, "lr": 0.0002991584910145875, "loss": 2.0123167037963867, "ppl": 7.480627686673601, "r_min": 60, "r_mean": 60.44444274902344, "r_max": 64, "tokens_per_step": 8192, "tok_per_sec": 67589.68806413279}
{"type": "train_step", "time": 1765591073.916959, "step": 1600, "epoch": 1.3513513513513513, "lr": 0.0002990764528461033, "loss": 1.954214096069336, "ppl": 7.0583696429003115, "r_min": 60, "r_mean": 60.44444274902344, "r_max": 64, "tokens_per_step": 8192, "tok_per_sec": 89795.87164779345}
{"type": "train_step", "time": 1765591078.485201, "step": 1650, "epoch": 1.3935810810810811, "lr": 0.00029899061324578186, "loss": 1.9636542797088623, "ppl": 7.125317451145041, "r_min": 60, "r_mean": 60.44444274902344, "r_max": 64, "tokens_per_step": 8192, "tok_per_sec": 89662.28835454931}
{"type": "train_step", "time": 1765591083.063968, "step": 1700, "epoch": 1.4358108108108107, "lr": 0.00029890097464740917, "loss": 1.9381672143936157, "ppl": 6.946008752463775, "r_min": 60, "r_mean": 60.44444274902344, "r_max": 64, "tokens_per_step": 8192, "tok_per_sec": 89456.96906858549}
{"type": "train_step", "time": 1765591087.657459, "step": 1750, "epoch": 1.4780405405405406, "lr": 0.0002988075395924831, "loss": 1.9471960067749023, "ppl": 7.009006793523605, "r_min": 60, "r_mean": 60.44444274902344, "r_max": 64, "tokens_per_step": 8192, "tok_per_sec": 89169.63330447841}
{"type": "train_step", "time": 1765591092.217312, "step": 1800, "epoch": 1.5202702702702702, "lr": 0.00029871031073014137, "loss": 1.9719440937042236, "ppl": 7.184630514935315, "r_min": 60, "r_mean": 60.44444274902344, "r_max": 64, "tokens_per_step": 8192, "tok_per_sec": 89828.38560952945}
{"type": "train_step", "time": 1765591096.779506, "step": 1850, "epoch": 1.5625, "lr": 0.00029860929081708664, "loss": 1.9352647066116333, "ppl": 6.925877138222846, "r_min": 60, "r_mean": 60.44444274902344, "r_max": 64, "tokens_per_step": 8192, "tok_per_sec": 89779.8885769795}
{"type": "train_step", "time": 1765591101.340991, "step": 1900, "epoch": 1.6047297297297298, "lr": 0.0002985044827175078, "loss": 1.9152252674102783, "ppl": 6.788467845341744, "r_min": 60, "r_mean": 60.44444274902344, "r_max": 64, "tokens_per_step": 8192, "tok_per_sec": 89796.28467395208}
{"type": "train_step", "time": 1765591105.903318, "step": 1950, "epoch": 1.6469594594594594, "lr": 0.00029839588940299946, "loss": 1.9091836214065552, "ppl": 6.74757797116335, "r_min": 60, "r_mean": 60.44444274902344, "r_max": 64, "tokens_per_step": 8192, "tok_per_sec": 89778.45291316837}
{"type": "train_step", "time": 1765591110.461641, "step": 2000, "epoch": 1.6891891891891893, "lr": 0.0002982835139524772, "loss": 1.904557466506958, "ppl": 6.716434722559868, "r_min": 60, "r_mean": 60.44444274902344, "r_max": 64, "tokens_per_step": 8192, "tok_per_sec": 89858.3568568228}
{"type": "eval", "time": 1765591111.755305, "step": 2000, "val_loss": 1.8327125024795532, "val_ppl": 6.250819045732454, "r_min": 60, "r_mean": 60.44444274902344, "r_max": 64}
{"type": "train_step", "time": 1765591116.5182688, "step": 2050, "epoch": 1.7314189189189189, "lr": 0.00029816735955209036, "loss": 1.8976749181747437, "ppl": 6.670367248618839, "r_min": 60, "r_mean": 60.44444274902344, "r_max": 64, "tokens_per_step": 8192, "tok_per_sec": 67628.45660215829}
{"type": "train_step", "time": 1765591121.0848908, "step": 2100, "epoch": 1.7736486486486487, "lr": 0.000298047429495132, "loss": 1.8418221473693848, "ppl": 6.308021940956442, "r_min": 60, "r_mean": 60.44444274902344, "r_max": 64, "tokens_per_step": 8192, "tok_per_sec": 89694.03130230668}
{"type": "train_step", "time": 1765591125.645825, "step": 2150, "epoch": 1.8158783783783783, "lr": 0.00029792372718194515, "loss": 1.8227680921554565, "ppl": 6.18896639009692, "r_min": 60, "r_mean": 60.44444274902344, "r_max": 64, "tokens_per_step": 8192, "tok_per_sec": 89807.42842729947}
{"type": "train_step", "time": 1765591130.24115, "step": 2200, "epoch": 1.8581081081081081, "lr": 0.00029779625611982665, "loss": 1.8623912334442139, "ppl": 6.439115805736283, "r_min": 60, "r_mean": 60.44444274902344, "r_max": 64, "tokens_per_step": 8192, "tok_per_sec": 89134.02411171535}
{"type": "train_step", "time": 1765591134.833492, "step": 2250, "epoch": 1.900337837837838, "lr": 0.00029766501992292737, "loss": 1.8487732410430908, "ppl": 6.352022340647411, "r_min": 60, "r_mean": 60.44444274902344, "r_max": 64, "tokens_per_step": 8192, "tok_per_sec": 89192.2340073161}
{"type": "train_step", "time": 1765591139.4128351, "step": 2300, "epoch": 1.9425675675675675, "lr": 0.0002975300223121504, "loss": 1.8129223585128784, "ppl": 6.128330467895415, "r_min": 60, "r_mean": 60.44444274902344, "r_max": 64, "tokens_per_step": 8192, "tok_per_sec": 89445.85157342334}
{"type": "train_step", "time": 1765591144.000524, "step": 2350, "epoch": 1.9847972972972974, "lr": 0.0002973912671150448, "loss": 1.8684996366500854, "ppl": 6.478568896385049, "r_min": 60, "r_mean": 60.44444274902344, "r_max": 64, "tokens_per_step": 8192, "tok_per_sec": 89282.42670444204}
{"type": "rank_update", "step": 2368, "changed_layers": 34, "total_layers": 36, "r_min": 56, "r_mean": 56.75, "r_max": 64, "resize_method": "svd", "took_sec": 1.026045799255371}
{"type": "rank_change", "step": -4.0, "layer": "blocks.0.attn.q_proj", "old_rank": 60, "new_rank": 56, "stable_rank": 2.7899329734128617, "fro2": 7.267077922821045, "sigma2": 2.604749993700409, "raw_target": 8.0, "ema_target": 44.53344433839996, "delta": -15.46655566160004}
{"type": "rank_change", "step": -4.0, "layer": "blocks.0.attn.k_proj", "old_rank": 60, "new_rank": 56, "stable_rank": 3.180691215136978, "fro2": 8.658737182617188, "sigma2": 2.7222815938885105, "raw_target": 8.0, "ema_target": 43.84000000000001, "delta": -16.15999999999999}
{"type": "rank_change", "step": -4.0, "layer": "blocks.0.attn.v_proj", "old_rank": 60, "new_rank": 56, "stable_rank": 15.289150091333402, "fro2": 3.6938984394073486, "sigma2": 0.2416025916711826, "raw_target": 22.933725137000103, "ema_target": 47.97049157802674, "delta": -12.029508421973262}
{"type": "rank_change", "step": -4.0, "layer": "blocks.0.attn.o_proj", "old_rank": 60, "new_rank": 56, "stable_rank": 14.299013191541794, "fro2": 4.059541702270508, "sigma2": 0.2839036166273132, "raw_target": 21.44851978731269, "ema_target": 47.908323300971524, "delta": -12.091676699028476}
{"type": "rank_change", "step": -3.0, "layer": "blocks.0.mlp.fc1", "old_rank": 64, "new_rank": 61, "stable_rank": 34.84716383788702, "fro2": 10.03455924987793, "sigma2": 0.28795912769510323, "raw_target": 52.27074575683052, "ema_target": 60.477664824306004, "delta": -3.5223351756939962}
{"type": "rank_change", "step": -4.0, "layer": "blocks.1.attn.q_proj", "old_rank": 60, "new_rank": 56, "stable_rank": 4.467943503821069, "fro2": 21.465641021728516, "sigma2": 4.804367145352501, "raw_target": 8.0, "ema_target": 43.84000000000001, "delta": -16.15999999999999}
{"type": "rank_change", "step": -4.0, "layer": "blocks.1.attn.k_proj", "old_rank": 60, "new_rank": 56, "stable_rank": 1.385813190385701, "fro2": 31.95979881286621, "sigma2": 23.062126281330166, "raw_target": 8.0, "ema_target": 43.84000000000001, "delta": -16.15999999999999}
{"type": "rank_change", "step": -4.0, "layer": "blocks.1.attn.v_proj", "old_rank": 60, "new_rank": 56, "stable_rank": 15.542203721770356, "fro2": 4.726036071777344, "sigma2": 0.3040775942047027, "raw_target": 23.313305582655534, "ema_target": 49.54378719768447, "delta": -10.456212802315527}
{"type": "rank_change", "step": -4.0, "layer": "blocks.1.attn.o_proj", "old_rank": 60, "new_rank": 56, "stable_rank": 16.504765344008533, "fro2": 5.26619291305542, "sigma2": 0.3190710463459858, "raw_target": 24.7571480160128, "ema_target": 50.33698833990046, "delta": -9.663011660099542}
{"type": "rank_change", "step": -4.0, "layer": "blocks.1.mlp.fc1", "old_rank": 60, "new_rank": 56, "stable_rank": 13.010174368147364, "fro2": 13.718330383300781, "sigma2": 1.0544309295950285, "raw_target": 19.515261552221048, "ema_target": 48.373991687383224, "delta": -11.626008312616776}
{"type": "rank_change", "step": -2.0, "layer": "blocks.1.mlp.fc2", "old_rank": 61, "new_rank": 59, "stable_rank": 33.63486213238044, "fro2": 10.178487777709961, "sigma2": 0.3026171893109222, "raw_target": 50.45229319857066, "ema_target": 58.3355471700733, "delta": -2.6644528299267023}
{"type": "rank_change", "step": -4.0, "layer": "blocks.2.attn.q_proj", "old_rank": 60, "new_rank": 56, "stable_rank": 3.08514509733539, "fro2": 5.994706153869629, "sigma2": 1.9430872564780657, "raw_target": 8.0, "ema_target": 43.84000000000001, "delta": -16.15999999999999}
{"type": "rank_change", "step": -4.0, "layer": "blocks.2.attn.k_proj", "old_rank": 60, "new_rank": 56, "stable_rank": 2.4082047182481308, "fro2": 11.151346206665039, "sigma2": 4.630564045524807, "raw_target": 8.0, "ema_target": 43.84000000000001, "delta": -16.15999999999999}
{"type": "rank_change", "step": -4.0, "layer": "blocks.2.attn.v_proj", "old_rank": 60, "new_rank": 56, "stable_rank": 11.306217085497549, "fro2": 3.450024127960205, "sigma2": 0.30514397422311745, "raw_target": 16.959325628246322, "ema_target": 47.092643895203, "delta": -12.907356104797003}
{"type": "rank_change", "step": -4.0, "layer": "blocks.2.attn.o_proj", "old_rank": 60, "new_rank": 56, "stable_rank": 8.271988059597543, "fro2": 3.6366357803344727, "sigma2": 0.43963260964759243, "raw_target": 12.407982089396315, "ema_target": 45.86025559072034, "delta": -14.139744409279658}
{"type": "rank_change", "step": -4.0, "layer": "blocks.2.mlp.fc1", "old_rank": 61, "new_rank": 57, "stable_rank": 21.935621257741683, "fro2": 7.922975540161133, "sigma2": 0.36119220092791693, "raw_target": 32.90343188661252, "ema_target": 54.96546081499621, "delta": -6.034539185003787}
{"type": "rank_change", "step": -4.0, "layer": "blocks.3.attn.q_proj", "old_rank": 60, "new_rank": 56, "stable_rank": 4.454101782930658, "fro2": 122.73175048828125, "sigma2": 27.5547700580355, "raw_target": 8.0, "ema_target": 43.84000000000001, "delta": -16.15999999999999}
{"type": "rank_change", "step": -4.0, "layer": "blocks.3.attn.k_proj", "old_rank": 60, "new_rank": 56, "stable_rank": 1.2709406931883198, "fro2": 73.5539321899414, "sigma2": 57.87361485193492, "raw_target": 8.0, "ema_target": 43.84000000000001, "delta": -16.15999999999999}
{"type": "rank_change", "step": -4.0, "layer": "blocks.3.attn.v_proj", "old_rank": 60, "new_rank": 56, "stable_rank": 22.22138802143934, "fro2": 8.230286598205566, "sigma2": 0.370376790507013, "raw_target": 33.33208203215901, "ema_target": 50.562965750096446, "delta": -9.437034249903554}
{"type": "rank_change", "step": -4.0, "layer": "blocks.3.attn.o_proj", "old_rank": 60, "new_rank": 56, "stable_rank": 26.887102537940127, "fro2": 8.774099349975586, "sigma2": 0.3263311496180563, "raw_target": 40.33065380691019, "ema_target": 52.83952818288388, "delta": -7.160471817116118}
{"type": "rank_change", "step": -4.0, "layer": "blocks.3.mlp.fc1", "old_rank": 60, "new_rank": 56, "stable_rank": 10.353576477597944, "fro2": 23.463211059570312, "sigma2": 2.2661938130077033, "raw_target": 15.530364716396916, "ema_target": 46.5419480196095, "delta": -13.4580519803905}
{"type": "rank_change", "step": -4.0, "layer": "blocks.3.mlp.fc2", "old_rank": 62, "new_rank": 58, "stable_rank": 23.59754223101104, "fro2": 12.325702667236328, "sigma2": 0.5223299236249659, "raw_target": 35.396313346516564, "ema_target": 56.33256363136352, "delta": -5.66743636863648}
{"type": "rank_change", "step": -4.0, "layer": "blocks.4.attn.q_proj", "old_rank": 60, "new_rank": 56, "stable_rank": 3.646389533959682, "fro2": 72.71661376953125, "sigma2": 19.94208601572609, "raw_target": 8.0, "ema_target": 43.84000000000001, "delta": -16.15999999999999}
{"type": "rank_change", "step": -4.0, "layer": "blocks.4.attn.k_proj", "old_rank": 60, "new_rank": 56, "stable_rank": 1.555464965614805, "fro2": 62.560691833496094, "sigma2": 40.219929860788625, "raw_target": 8.0, "ema_target": 43.84000000000001, "delta": -16.15999999999999}
{"type": "rank_change", "step": -4.0, "layer": "blocks.4.attn.v_proj", "old_rank": 60, "new_rank": 56, "stable_rank": 22.761739582838494, "fro2": 8.100728034973145, "sigma2": 0.3558922980325896, "raw_target": 34.142609374257745, "ema_target": 50.6556821397902, "delta": -9.344317860209799}
{"type": "rank_change", "step": -4.0, "layer": "blocks.4.attn.o_proj", "old_rank": 60, "new_rank": 56, "stable_rank": 18.08894397541681, "fro2": 9.818641662597656, "sigma2": 0.542797937516525, "raw_target": 27.133415963125216, "ema_target": 49.113879429390266, "delta": -10.886120570609734}
{"type": "rank_change", "step": -4.0, "layer": "blocks.4.mlp.fc1", "old_rank": 60, "new_rank": 56, "stable_rank": 11.936773701624874, "fro2": 30.890939712524414, "sigma2": 2.5878801395850957, "raw_target": 17.905160552437312, "ema_target": 46.7392570504145, "delta": -13.260742949585499}
{"type": "rank_change", "step": -4.0, "layer": "blocks.4.mlp.fc2", "old_rank": 60, "new_rank": 56, "stable_rank": 21.697116725676313, "fro2": 14.837970733642578, "sigma2": 0.6838683085993722, "raw_target": 32.54567508851447, "ema_target": 53.0149515391662, "delta": -6.985048460833802}
{"type": "rank_change", "step": -4.0, "layer": "blocks.5.attn.q_proj", "old_rank": 60, "new_rank": 56, "stable_rank": 2.3564832069883765, "fro2": 59.86052703857422, "sigma2": 25.40248402258385, "raw_target": 8.0, "ema_target": 43.84000000000001, "delta": -16.15999999999999}
{"type": "rank_change", "step": -4.0, "layer": "blocks.5.attn.k_proj", "old_rank": 60, "new_rank": 56, "stable_rank": 1.6639906920714542, "fro2": 35.098480224609375, "sigma2": 21.092954651252512, "raw_target": 8.0, "ema_target": 43.84000000000001, "delta": -16.15999999999999}
{"type": "rank_change", "step": -4.0, "layer": "blocks.5.attn.v_proj", "old_rank": 60, "new_rank": 56, "stable_rank": 13.634953482800386, "fro2": 7.207346439361572, "sigma2": 0.5285933913968712, "raw_target": 20.45243022420058, "ema_target": 48.080690769978645, "delta": -11.919309230021355}
{"type": "rank_change", "step": -4.0, "layer": "blocks.5.attn.o_proj", "old_rank": 60, "new_rank": 56, "stable_rank": 17.624453526368615, "fro2": 8.188969612121582, "sigma2": 0.46463678568105493, "raw_target": 26.436680289552925, "ema_target": 48.969608046545616, "delta": -11.030391953454384}
{"type": "rank_change", "step": -4.0, "layer": "blocks.5.mlp.fc1", "old_rank": 60, "new_rank": 56, "stable_rank": 17.921686020453468, "fro2": 41.33179473876953, "sigma2": 2.306244764715885, "raw_target": 26.882529030680203, "ema_target": 49.344666971474275, "delta": -10.655333028525725}
{"type": "rank_change", "step": -4.0, "layer": "blocks.5.mlp.fc2", "old_rank": 60, "new_rank": 56, "stable_rank": 17.777401987130496, "fro2": 17.714021682739258, "sigma2": 0.9964347725156273, "raw_target": 26.666102980695744, "ema_target": 50.11487761781384, "delta": -9.885122382186161}
{"type": "train_step", "time": 1765591149.588144, "step": 2400, "epoch": 2.027027027027027, "lr": 0.0002972487582656975, "loss": 1.8436660766601562, "ppl": 6.319664217849169, "r_min": 56, "r_mean": 56.75, "r_max": 64, "tokens_per_step": 8192, "tok_per_sec": 73304.79424258567}
{"type": "train_step", "time": 1765591154.1414201, "step": 2450, "epoch": 2.0692567567567566, "lr": 0.0002971024998046217, "loss": 1.8159122467041016, "ppl": 6.146680910008169, "r_min": 56, "r_mean": 56.75, "r_max": 64, "tokens_per_step": 8192, "tok_per_sec": 89956.38330486875}
{"type": "train_step", "time": 1765591158.6914382, "step": 2500, "epoch": 2.1114864864864864, "lr": 0.0002969524958786424, "loss": 1.7965301275253296, "ppl": 6.028692336031308, "r_min": 56, "r_mean": 56.75, "r_max": 64, "tokens_per_step": 8192, "tok_per_sec": 90022.29501379584}
{"type": "eval", "time": 1765591160.00492, "step": 2500, "val_loss": 1.747394323348999, "val_ppl": 5.739627560803946, "r_min": 56, "r_mean": 56.75, "r_max": 64}
{"type": "train_step", "time": 1765591164.763861, "step": 2550, "epoch": 2.1537162162162162, "lr": 0.0002967987507407785, "loss": 1.7977854013442993, "ppl": 6.036264747413901, "r_min": 56, "r_mean": 56.75, "r_max": 64, "tokens_per_step": 8192, "tok_per_sec": 67452.16919268719}
{"type": "train_step", "time": 1765591169.319401, "step": 2600, "epoch": 2.195945945945946, "lr": 0.0002966412687501224, "loss": 1.7758318185806274, "ppl": 5.905191141632845, "r_min": 56, "r_mean": 56.75, "r_max": 64, "tokens_per_step": 8192, "tok_per_sec": 89913.31455187946}
{"type": "train_step", "time": 1765591173.8804102, "step": 2650, "epoch": 2.238175675675676, "lr": 0.0002964800543717167, "loss": 1.7566704750061035, "ppl": 5.793116920671029, "r_min": 56, "r_mean": 56.75, "r_max": 64, "tokens_per_step": 8192, "tok_per_sec": 89807.0106039991}
{"type": "train_step", "time": 1765591178.4381151, "step": 2700, "epoch": 2.2804054054054053, "lr": 0.0002963151121764272, "loss": 1.81709623336792, "ppl": 6.153962808216887, "r_min": 56, "r_mean": 56.75, "r_max": 64, "tokens_per_step": 8192, "tok_per_sec": 89868.43006817602}
{"type": "train_step", "time": 1765591183.05477, "step": 2750, "epoch": 2.322635135135135, "lr": 0.00029614644684081327, "loss": 1.7445347309112549, "ppl": 5.723238010121676, "r_min": 56, "r_mean": 56.75, "r_max": 64, "tokens_per_step": 8192, "tok_per_sec": 88720.36061021482}
{"type": "train_step", "time": 1765591187.742002, "step": 2800, "epoch": 2.364864864864865, "lr": 0.0002959740631469957, "loss": 1.716644048690796, "ppl": 5.565818471138026, "r_min": 56, "r_mean": 56.75, "r_max": 64, "tokens_per_step": 8192, "tok_per_sec": 87386.59142749321}
{"type": "train_step", "time": 1765591192.3101141, "step": 2850, "epoch": 2.4070945945945947, "lr": 0.0002957979659825208, "loss": 1.7298450469970703, "ppl": 5.639779939880497, "r_min": 56, "r_mean": 56.75, "r_max": 64, "tokens_per_step": 8192, "tok_per_sec": 89665.30205615377}
{"type": "train_step", "time": 1765591196.88114, "step": 2900, "epoch": 2.449324324324324, "lr": 0.00029561816034022156, "loss": 1.720104455947876, "ppl": 5.585111831957812, "r_min": 56, "r_mean": 56.75, "r_max": 64, "tokens_per_step": 8192, "tok_per_sec": 89607.40331780456}
{"type": "train_step", "time": 1765591201.525954, "step": 2950, "epoch": 2.491554054054054, "lr": 0.00029543465131807675, "loss": 1.71389901638031, "ppl": 5.550561070210346, "r_min": 56, "r_mean": 56.75, "r_max": 64, "tokens_per_step": 8192, "tok_per_sec": 88184.82769000035}
{"type": "train_step", "time": 1765591206.303964, "step": 3000, "epoch": 2.5337837837837838, "lr": 0.00029524744411906596, "loss": 1.7105278968811035, "ppl": 5.531880969671358, "r_min": 56, "r_mean": 56.75, "r_max": 64, "tokens_per_step": 8192, "tok_per_sec": 85725.79404994588}
{"type": "eval", "time": 1765591207.595953, "step": 3000, "val_loss": 1.6698905944824218, "val_ppl": 5.3115866485048695, "r_min": 56, "r_mean": 56.75, "r_max": 64}
{"type": "train_step", "time": 1765591212.376415, "step": 3050, "epoch": 2.5760135135135136, "lr": 0.00029505654405102204, "loss": 1.6934571266174316, "ppl": 5.438248959552787, "r_min": 56, "r_mean": 56.75, "r_max": 64, "tokens_per_step": 8192, "tok_per_sec": 67452.50288383239}
{"type": "train_step", "time": 1765591216.9757462, "step": 3100, "epoch": 2.6182432432432434, "lr": 0.00029486195652648063, "loss": 1.7494369745254517, "ppl": 5.751363600029944, "r_min": 56, "r_mean": 56.75, "r_max": 64, "tokens_per_step": 8192, "tok_per_sec": 89055.67496318002}
{"type": "train_step", "time": 1765591221.7186298, "step": 3150, "epoch": 2.660472972972973, "lr": 0.00029466368706252706, "loss": 1.663201093673706, "ppl": 5.276173365975419, "r_min": 56, "r_mean": 56.75, "r_max": 64, "tokens_per_step": 8192, "tok_per_sec": 86363.87127442374}
{"type": "train_step", "time": 1765591226.2796621, "step": 3200, "epoch": 2.7027027027027026, "lr": 0.00029446174128063945, "loss": 1.7298561334609985, "ppl": 5.639842465443957, "r_min": 56, "r_mean": 56.75, "r_max": 64, "tokens_per_step": 8192, "tok_per_sec": 89806.22660897208}
{"type": "train_step", "time": 1765591230.83331, "step": 3250, "epoch": 2.7449324324324325, "lr": 0.0002942561249065296, "loss": 1.6957831382751465, "ppl": 5.450913112804542, "r_min": 56, "r_mean": 56.75, "r_max": 64, "tokens_per_step": 8192, "tok_per_sec": 89947.58541512357}
{"type": "train_step", "time": 1765591235.39769, "step": 3300, "epoch": 2.7871621621621623, "lr": 0.0002940468437699805, "loss": 1.659411072731018, "ppl": 5.256214404752934, "r_min": 56, "r_mean": 56.75, "r_max": 64, "tokens_per_step": 8192, "tok_per_sec": 89738.52139459948}
{"type": "train_step", "time": 1765591239.9620101, "step": 3350, "epoch": 2.829391891891892, "lr": 0.0002938339038046812, "loss": 1.7099765539169312, "ppl": 5.52883184665359, "r_min": 56, "r_mean": 56.75, "r_max": 64, "tokens_per_step": 8192, "tok_per_sec": 89739.23389481897}
{"type": "train_step", "time": 1765591244.5194309, "step": 3400, "epoch": 2.8716216216216215, "lr": 0.00029361731104805844, "loss": 1.6852309703826904, "ppl": 5.393696572652463, "r_min": 56, "r_mean": 56.75, "r_max": 64, "tokens_per_step": 8192, "tok_per_sec": 89875.23299599173}
{"type": "train_step", "time": 1765591249.1107001, "step": 3450, "epoch": 2.9138513513513513, "lr": 0.00029339707164110547, "loss": 1.6387250423431396, "ppl": 5.148601077520469, "r_min": 56, "r_mean": 56.75, "r_max": 64, "tokens_per_step": 8192, "tok_per_sec": 89211.40867860177}
{"type": "train_step", "time": 1765591253.690172, "step": 3500, "epoch": 2.956081081081081, "lr": 0.0002931731918282082, "loss": 1.6740293502807617, "ppl": 5.333615563249087, "r_min": 56, "r_mean": 56.75, "r_max": 64, "tokens_per_step": 8192, "tok_per_sec": 89443.18788361488}
{"type": "eval", "time": 1765591254.981278, "step": 3500, "val_loss": 1.621704909801483, "val_ppl": 5.061712727900581, "r_min": 56, "r_mean": 56.75, "r_max": 64}
{"type": "train_step", "time": 1765591259.791095, "step": 3550, "epoch": 2.998310810810811, "lr": 0.0002929456779569677, "loss": 1.6756141185760498, "ppl": 5.342074809295005, "r_min": 56, "r_mean": 56.75, "r_max": 64, "tokens_per_step": 8192, "tok_per_sec": 67137.74372007209}
{"type": "rank_update", "step": 3552, "changed_layers": 35, "total_layers": 36, "r_min": 52, "r_mean": 53.0, "r_max": 64, "resize_method": "svd", "took_sec": 0.8922879695892334}
{"type": "rank_change", "step": -4.0, "layer": "blocks.0.attn.q_proj", "old_rank": 56, "new_rank": 52, "stable_rank": 2.7559212545491167, "fro2": 8.176361083984375, "sigma2": 2.966834064263878, "raw_target": 8.0, "ema_target": 37.22675547071997, "delta": -18.773244529280028}
{"type": "rank_change", "step": -4.0, "layer": "blocks.0.attn.k_proj", "old_rank": 56, "new_rank": 52, "stable_rank": 3.5117304051650584, "fro2": 9.64813232421875, "sigma2": 2.7474011885738605, "raw_target": 8.0, "ema_target": 36.67200000000001, "delta": -19.32799999999999}
{"type": "rank_change", "step": -4.0, "layer": "blocks.0.attn.v_proj", "old_rank": 56, "new_rank": 52, "stable_rank": 13.955173048083218, "fro2": 3.709886312484741, "sigma2": 0.2658430791327646, "raw_target": 20.932759572124827, "ema_target": 42.56294517684636, "delta": -13.437054823153638}
{"type": "rank_change", "step": -4.0, "layer": "blocks.0.attn.o_proj", "old_rank": 56, "new_rank": 52, "stable_rank": 14.49876117485099, "fro2": 4.339071273803711, "sigma2": 0.2992718534009988, "raw_target": 21.748141762276486, "ema_target": 42.676286993232516, "delta": -13.323713006767484}
{"type": "rank_change", "step": -3.0, "layer": "blocks.0.mlp.fc1", "old_rank": 61, "new_rank": 58, "stable_rank": 30.509777825230106, "fro2": 8.218414306640625, "sigma2": 0.2693698409939458, "raw_target": 45.76466673784516, "ema_target": 57.53506520701384, "delta": -3.4649347929861634}
{"type": "rank_change", "step": -4.0, "layer": "blocks.1.attn.q_proj", "old_rank": 56, "new_rank": 52, "stable_rank": 4.709166621413191, "fro2": 29.61129379272461, "sigma2": 6.288011473407323, "raw_target": 8.0, "ema_target": 36.67200000000001, "delta": -19.32799999999999}
{"type": "rank_change", "step": -4.0, "layer": "blocks.1.attn.k_proj", "old_rank": 56, "new_rank": 52, "stable_rank": 1.4941007873340364, "fro2": 37.368202209472656, "sigma2": 25.01049628734131, "raw_target": 8.0, "ema_target": 36.67200000000001, "delta": -19.32799999999999}
{"type": "rank_change", "step": -4.0, "layer": "blocks.1.attn.v_proj", "old_rank": 56, "new_rank": 52, "stable_rank": 18.645306828986545, "fro2": 5.238124847412109, "sigma2": 0.28093528891762176, "raw_target": 27.967960243479816, "ema_target": 45.22862180684354, "delta": -10.771378193156458}
{"type": "rank_change", "step": -4.0, "layer": "blocks.1.attn.o_proj", "old_rank": 56, "new_rank": 52, "stable_rank": 18.58916996210938, "fro2": 6.041619777679443, "sigma2": 0.32500749652095706, "raw_target": 27.88375494316407, "ema_target": 45.84634166055318, "delta": -10.153658339446821}
{"type": "rank_change", "step": -4.0, "layer": "blocks.1.mlp.fc1", "old_rank": 56, "new_rank": 52, "stable_rank": 16.479187958357286, "fro2": 13.520586013793945, "sigma2": 0.8204643264685387, "raw_target": 24.71878193753593, "ema_target": 43.642949737413765, "delta": -12.357050262586235}
{"type": "rank_change", "step": -2.0, "layer": "blocks.1.mlp.fc2", "old_rank": 59, "new_rank": 57, "stable_rank": 32.234124935608826, "fro2": 8.659872055053711, "sigma2": 0.26865540013918476, "raw_target": 48.351187403413235, "ema_target": 56.33867521674129, "delta": -2.6613247832587135}
{"type": "rank_change", "step": -4.0, "layer": "blocks.2.attn.q_proj", "old_rank": 56, "new_rank": 52, "stable_rank": 2.8150133002203637, "fro2": 6.760283470153809, "sigma2": 2.4015103024466953, "raw_target": 8.0, "ema_target": 36.67200000000001, "delta": -19.32799999999999}
{"type": "rank_change", "step": -4.0, "layer": "blocks.2.attn.k_proj", "old_rank": 56, "new_rank": 52, "stable_rank": 2.560796360073466, "fro2": 12.596460342407227, "sigma2": 4.91896212959233, "raw_target": 8.0, "ema_target": 36.67200000000001, "delta": -19.32799999999999}
{"type": "rank_change", "step": -4.0, "layer": "blocks.2.attn.v_proj", "old_rank": 56, "new_rank": 52, "stable_rank": 13.741160901925486, "fro2": 3.5506908893585205, "sigma2": 0.25839816426640994, "raw_target": 20.61174135288823, "ema_target": 41.796463386740044, "delta": -14.203536613259956}
{"type": "rank_change", "step": -4.0, "layer": "blocks.2.attn.o_proj", "old_rank": 56, "new_rank": 52, "stable_rank": 8.386024231410191, "fro2": 3.5282750129699707, "sigma2": 0.42073273720035687, "raw_target": 12.579036347115288, "ema_target": 39.20401174199933, "delta": -16.79598825800067}
{"type": "rank_change", "step": -4.0, "layer": "blocks.2.mlp.fc1", "old_rank": 57, "new_rank": 53, "stable_rank": 18.794705446323285, "fro2": 5.051495552062988, "sigma2": 0.2687722549599272, "raw_target": 28.192058169484927, "ema_target": 49.61078028589396, "delta": -7.389219714106041}
{"type": "rank_change", "step": -2.0, "layer": "blocks.2.mlp.fc2", "old_rank": 64, "new_rank": 62, "stable_rank": 38.70056124824165, "fro2": 4.76759147644043, "sigma2": 0.123191781608889, "raw_target": 58.05084187236247, "ema_target": 61.777611277378654, "delta": -2.2223887226213463}
{"type": "rank_change", "step": -4.0, "layer": "blocks.3.attn.q_proj", "old_rank": 56, "new_rank": 52, "stable_rank": 5.130294063789861, "fro2": 175.92327880859375, "sigma2": 34.29107114911312, "raw_target": 8.0, "ema_target": 36.67200000000001, "delta": -19.32799999999999}
{"type": "rank_change", "step": -4.0, "layer": "blocks.3.attn.k_proj", "old_rank": 56, "new_rank": 52, "stable_rank": 1.4034197396171844, "fro2": 92.47550201416016, "sigma2": 65.8929751304131, "raw_target": 8.0, "ema_target": 36.67200000000001, "delta": -19.32799999999999}
{"type": "rank_change", "step": -4.0, "layer": "blocks.3.attn.v_proj", "old_rank": 56, "new_rank": 52, "stable_rank": 22.307913223029566, "fro2": 9.559925079345703, "sigma2": 0.4285441117099822, "raw_target": 33.461869834544345, "ema_target": 47.14274656698603, "delta": -8.857253433013973}
{"type": "rank_change", "step": -4.0, "layer": "blocks.3.attn.o_proj", "old_rank": 56, "new_rank": 52, "stable_rank": 32.08538062396735, "fro2": 10.44930648803711, "sigma2": 0.32567187809446807, "raw_target": 48.12807093595103, "ema_target": 51.89723673349731, "delta": -4.102763266502691}
{"type": "rank_change", "step": -4.0, "layer": "blocks.3.mlp.fc1", "old_rank": 56, "new_rank": 52, "stable_rank": 13.730401772932954, "fro2": 33.56446838378906, "sigma2": 2.4445364965686167, "raw_target": 20.595602659399432, "ema_target": 41.35267894756749, "delta": -14.64732105243251}
{"type": "rank_change", "step": -4.0, "layer": "blocks.3.mlp.fc2", "old_rank": 58, "new_rank": 54, "stable_rank": 26.092510984430593, "fro2": 12.2183256149292, "sigma2": 0.4682694341412663, "raw_target": 39.13876647664589, "ema_target": 52.89380420041999, "delta": -5.106195799580007}
{"type": "rank_change", "step": -4.0, "layer": "blocks.4.attn.q_proj", "old_rank": 56, "new_rank": 52, "stable_rank": 6.330556377628764, "fro2": 106.05766296386719, "sigma2": 16.75329253450036, "raw_target": 9.495834566443147, "ema_target": 36.97116691328864, "delta": -19.02883308671136}
{"type": "rank_change", "step": -4.0, "layer": "blocks.4.attn.k_proj", "old_rank": 56, "new_rank": 52, "stable_rank": 1.9730334694423173, "fro2": 80.45679473876953, "sigma2": 40.77822092991687, "raw_target": 8.0, "ema_target": 36.67200000000001, "delta": -19.32799999999999}
{"type": "rank_change", "step": -4.0, "layer": "blocks.4.attn.v_proj", "old_rank": 56, "new_rank": 52, "stable_rank": 23.992541530614748, "fro2": 10.602153778076172, "sigma2": 0.4418937245402823, "raw_target": 35.98881229592212, "ema_target": 47.722308171016586, "delta": -8.277691828983414}
{"type": "rank_change", "step": -4.0, "layer": "blocks.4.attn.o_proj", "old_rank": 56, "new_rank": 52, "stable_rank": 27.755828357771854, "fro2": 13.077661514282227, "sigma2": 0.4711681117260582, "raw_target": 41.63374253665778, "ema_target": 47.617852050843766, "delta": -8.382147949156234}
{"type": "rank_change", "step": -4.0, "layer": "blocks.4.mlp.fc1", "old_rank": 56, "new_rank": 52, "stable_rank": 23.79983089290132, "fro2": 53.847816467285156, "sigma2": 2.2625293629858447, "raw_target": 35.699746339351975, "ema_target": 44.531354908202, "delta": -11.468645091798003}
{"type": "rank_change", "step": -4.0, "layer": "blocks.4.mlp.fc2", "old_rank": 56, "new_rank": 52, "stable_rank": 21.78424307866067, "fro2": 17.539962768554688, "sigma2": 0.8051674087264473, "raw_target": 32.676364617991005, "ema_target": 48.94723415493116, "delta": -7.052765845068841}
{"type": "rank_change", "step": -4.0, "layer": "blocks.5.attn.q_proj", "old_rank": 56, "new_rank": 52, "stable_rank": 3.557221294937778, "fro2": 80.33378601074219, "sigma2": 22.58329727461478, "raw_target": 8.0, "ema_target": 36.67200000000001, "delta": -19.32799999999999}
{"type": "rank_change", "step": -4.0, "layer": "blocks.5.attn.k_proj", "old_rank": 56, "new_rank": 52, "stable_rank": 2.125481362643137, "fro2": 48.21893310546875, "sigma2": 22.686123685531356, "raw_target": 8.0, "ema_target": 36.67200000000001, "delta": -19.32799999999999}
{"type": "rank_change", "step": -4.0, "layer": "blocks.5.attn.v_proj", "old_rank": 56, "new_rank": 52, "stable_rank": 17.385152799818467, "fro2": 10.031079292297363, "sigma2": 0.5769911391604552, "raw_target": 26.0777291997277, "ema_target": 43.68009845592846, "delta": -12.319901544071541}
{"type": "rank_change", "step": -4.0, "layer": "blocks.5.attn.o_proj", "old_rank": 56, "new_rank": 52, "stable_rank": 17.37179362649775, "fro2": 11.820907592773438, "sigma2": 0.6804655681048786, "raw_target": 26.05769043974663, "ema_target": 44.387224525185815, "delta": -11.612775474814185}
{"type": "rank_change", "step": -4.0, "layer": "blocks.5.mlp.fc1", "old_rank": 56, "new_rank": 52, "stable_rank": 24.062951098385994, "fro2": 82.84019470214844, "sigma2": 3.4426448411423394, "raw_target": 36.09442664757899, "ema_target": 46.694618906695226, "delta": -9.305381093304774}
{"type": "rank_change", "step": -4.0, "layer": "blocks.5.mlp.fc2", "old_rank": 56, "new_rank": 52, "stable_rank": 13.929410591798149, "fro2": 24.67621612548828, "sigma2": 1.7715190333124298, "raw_target": 20.894115887697225, "ema_target": 44.27072527179052, "delta": -11.729274728209482}
{"type": "train_step", "time": 1765591265.320745, "step": 3600, "epoch": 3.0405405405405403, "lr": 0.0002927145364780206, "loss": 1.6799129247665405, "ppl": 5.36508878442364, "r_min": 52, "r_mean": 53.0, "r_max": 64, "tokens_per_step": 8192, "tok_per_sec": 74072.67008527434}
{"type": "train_step", "time": 1765591269.9176168, "step": 3650, "epoch": 3.08277027027027, "lr": 0.000292479773944856, "loss": 1.661494493484497, "ppl": 5.267176726527585, "r_min": 52, "r_mean": 53.0, "r_max": 64, "tokens_per_step": 8192, "tok_per_sec": 89104.46932334857}
{"type": "train_step", "time": 1765591274.490931, "step": 3700, "epoch": 3.125, "lr": 0.00029224139701362976, "loss": 1.6377439498901367, "ppl": 5.143552300923071, "r_min": 52, "r_mean": 53.0, "r_max": 64, "tokens_per_step": 8192, "tok_per_sec": 89563.8041863838}
{"type": "train_step", "time": 1765591279.05451, "step": 3750, "epoch": 3.16722972972973, "lr": 0.0002919994124429758, "loss": 1.6434447765350342, "ppl": 5.172958541228279, "r_min": 52, "r_mean": 53.0, "r_max": 64, "tokens_per_step": 8192, "tok_per_sec": 89754.21308073652}
{"type": "train_step", "time": 1765591283.607169, "step": 3800, "epoch": 3.2094594594594597, "lr": 0.0002917538270938144, "loss": 1.6791561841964722, "ppl": 5.3610303398669465, "r_min": 52, "r_mean": 53.0, "r_max": 64, "tokens_per_step": 8192, "tok_per_sec": 89970.37021675274}
{"type": "train_step", "time": 1765591288.157728, "step": 3850, "epoch": 3.251689189189189, "lr": 0.0002915046479291576, "loss": 1.608329176902771, "ppl": 4.994459394444062, "r_min": 52, "r_mean": 53.0, "r_max": 64, "tokens_per_step": 8192, "tok_per_sec": 90011.29594828722}
{"type": "train_step", "time": 1765591292.709097, "step": 3900, "epoch": 3.293918918918919, "lr": 0.0002912518820139119, "loss": 1.631263017654419, "ppl": 5.110325075011758, "r_min": 52, "r_mean": 53.0, "r_max": 64, "tokens_per_step": 8192, "tok_per_sec": 89994.1659659064}
{"type": "train_step", "time": 1765591297.27233, "step": 3950, "epoch": 3.3361486486486487, "lr": 0.0002909955365146781, "loss": 1.635049819946289, "ppl": 5.129713552714898, "r_min": 52, "r_mean": 53.0, "r_max": 64, "tokens_per_step": 8192, "tok_per_sec": 89763.22175300233}
{"type": "train_step", "time": 1765591301.833718, "step": 4000, "epoch": 3.3783783783783785, "lr": 0.00029073561869954773, "loss": 1.6465821266174316, "ppl": 5.189213408405273, "r_min": 52, "r_mean": 53.0, "r_max": 64, "tokens_per_step": 8192, "tok_per_sec": 89795.90919546905}
{"type": "eval", "time": 1765591303.128536, "step": 4000, "val_loss": 1.5740491771697998, "val_ppl": 4.826150621650984, "r_min": 52, "r_mean": 53.0, "r_max": 64}
{"type": "train_step", "time": 1765591307.888951, "step": 4050, "epoch": 3.420608108108108, "lr": 0.00029047213593789734, "loss": 1.6249706745147705, "ppl": 5.078270112261276, "r_min": 52, "r_mean": 53.0, "r_max": 64, "tokens_per_step": 8192, "tok_per_sec": 67643.89017855997}
{"type": "train_step", "time": 1765591312.444858, "step": 4100, "epoch": 3.4628378378378377, "lr": 0.00029020509570017926, "loss": 1.6029661893844604, "ppl": 4.967745867234477, "r_min": 52, "r_mean": 53.0, "r_max": 64, "tokens_per_step": 8192, "tok_per_sec": 89904.11576640284}
{"type": "train_step", "time": 1765591317.007904, "step": 4150, "epoch": 3.5050675675675675, "lr": 0.00028993450555771005, "loss": 1.556567907333374, "ppl": 4.742516525300117, "r_min": 52, "r_mean": 53.0, "r_max": 64, "tokens_per_step": 8192, "tok_per_sec": 89766.10153302649}
{"type": "train_step", "time": 1765591321.60866, "step": 4200, "epoch": 3.5472972972972974, "lr": 0.00028966037318245555, "loss": 1.5944913625717163, "ppl": 4.925822976895091, "r_min": 52, "r_mean": 53.0, "r_max": 64, "tokens_per_step": 8192, "tok_per_sec": 89030.04286222885}
{"type": "train_step", "time": 1765591326.241834, "step": 4250, "epoch": 3.589527027027027, "lr": 0.0002893827063468138, "loss": 1.593737006187439, "ppl": 4.922108552060837, "r_min": 52, "r_mean": 53.0, "r_max": 64, "tokens_per_step": 8192, "tok_per_sec": 88403.34412123062}
{"type": "train_step", "time": 1765591330.8770308, "step": 4300, "epoch": 3.6317567567567566, "lr": 0.00028910151292339424, "loss": 1.6370773315429688, "ppl": 5.140124657181692, "r_min": 52, "r_mean": 53.0, "r_max": 64, "tokens_per_step": 8192, "tok_per_sec": 88367.94875237189}
{"type": "train_step", "time": 1765591335.5216682, "step": 4350, "epoch": 3.6739864864864864, "lr": 0.0002888168008847945, "loss": 1.61165189743042, "ppl": 5.011082188354145, "r_min": 52, "r_mean": 53.0, "r_max": 64, "tokens_per_step": 8192, "tok_per_sec": 88186.91900842448}
{"type": "train_step", "time": 1765591340.292664, "step": 4400, "epoch": 3.7162162162162162, "lr": 0.0002885285783033749, "loss": 1.5808534622192383, "ppl": 4.859101101270993, "r_min": 52, "r_mean": 53.0, "r_max": 64, "tokens_per_step": 8192, "tok_per_sec": 85852.63350211151}
{"type": "train_step", "time": 1765591345.046726, "step": 4450, "epoch": 3.758445945945946, "lr": 0.0002882368533510288, "loss": 1.5477917194366455, "ppl": 4.70107741385966, "r_min": 52, "r_mean": 53.0, "r_max": 64, "tokens_per_step": 8192, "tok_per_sec": 86158.03110047763}
{"type": "train_step", "time": 1765591349.705239, "step": 4500, "epoch": 3.800675675675676, "lr": 0.0002879416342989516, "loss": 1.6169562339782715, "ppl": 5.037733275429872, "r_min": 52, "r_mean": 53.0, "r_max": 64, "tokens_per_step": 8192, "tok_per_sec": 87924.97467531613}
{"type": "eval", "time": 1765591351.042633, "step": 4500, "val_loss": 1.5266145467758179, "val_ppl": 4.602568635986719, "r_min": 52, "r_mean": 53.0, "r_max": 64}
{"type": "train_step", "time": 1765591355.87167, "step": 4550, "epoch": 3.8429054054054053, "lr": 0.0002876429295174056, "loss": 1.5766680240631104, "ppl": 4.838806135406581, "r_min": 52, "r_mean": 53.0, "r_max": 64, "tokens_per_step": 8192, "tok_per_sec": 66425.27012826671}
{"type": "train_step", "time": 1765591360.5126688, "step": 4600, "epoch": 3.885135135135135, "lr": 0.00028734074747548333, "loss": 1.5742883682250977, "ppl": 4.827305131779947, "r_min": 52, "r_mean": 53.0, "r_max": 64, "tokens_per_step": 8192, "tok_per_sec": 88257.56148562752}
{"type": "train_step", "time": 1765591365.146484, "step": 4650, "epoch": 3.927364864864865, "lr": 0.00028703509674086694, "loss": 1.5579066276550293, "ppl": 4.748869680148244, "r_min": 52, "r_mean": 53.0, "r_max": 64, "tokens_per_step": 8192, "tok_per_sec": 88393.02360723974}
{"type": "train_step", "time": 1765591369.7974348, "step": 4700, "epoch": 3.9695945945945947, "lr": 0.00028672598597958546, "loss": 1.5185458660125732, "ppl": 4.565581398743504, "r_min": 52, "r_mean": 53.0, "r_max": 64, "tokens_per_step": 8192, "tok_per_sec": 88067.74554748285}
{"type": "rank_update", "step": 4736, "changed_layers": 34, "total_layers": 36, "r_min": 48, "r_mean": 49.30555725097656, "r_max": 61, "resize_method": "svd", "took_sec": 0.880774974822998}
{"type": "rank_change", "step": -4.0, "layer": "blocks.0.attn.q_proj", "old_rank": 52, "new_rank": 48, "stable_rank": 3.7922774028792294, "fro2": 9.661700248718262, "sigma2": 2.5477303436346688, "raw_target": 8.0, "ema_target": 31.38140437657598, "delta": -20.61859562342402}
{"type": "rank_change", "step": -4.0, "layer": "blocks.0.attn.k_proj", "old_rank": 52, "new_rank": 48, "stable_rank": 3.505660134700756, "fro2": 11.628267288208008, "sigma2": 3.3169978852339597, "raw_target": 8.0, "ema_target": 30.93760000000001, "delta": -21.06239999999999}
{"type": "rank_change", "step": -4.0, "layer": "blocks.0.attn.v_proj", "old_rank": 52, "new_rank": 48, "stable_rank": 14.67313316613559, "fro2": 3.7305281162261963, "sigma2": 0.2542420849900431, "raw_target": 22.009699749203385, "ema_target": 38.45229609131776, "delta": -13.547703908682237}
{"type": "rank_change", "step": -4.0, "layer": "blocks.0.attn.o_proj", "old_rank": 52, "new_rank": 48, "stable_rank": 14.594680021002164, "fro2": 4.514685153961182, "sigma2": 0.3093377176832668, "raw_target": 21.892020031503247, "ema_target": 38.519433600886664, "delta": -13.480566399113336}
{"type": "rank_change", "step": -3.0, "layer": "blocks.0.mlp.fc1", "old_rank": 58, "new_rank": 55, "stable_rank": 29.791834363586666, "fro2": 6.350203990936279, "sigma2": 0.21315249056229746, "raw_target": 44.687751545379996, "ema_target": 54.96560247468707, "delta": -3.034397525312933}
{"type": "rank_change", "step": -3.0, "layer": "blocks.0.mlp.fc2", "old_rank": 64, "new_rank": 61, "stable_rank": 36.57116524393363, "fro2": 5.847670555114746, "sigma2": 0.15989838306760262, "raw_target": 54.856747865900445, "ema_target": 60.72778655157139, "delta": -3.2722134484286087}
{"type": "rank_change", "step": -4.0, "layer": "blocks.1.attn.q_proj", "old_rank": 52, "new_rank": 48, "stable_rank": 5.768959855176366, "fro2": 36.228939056396484, "sigma2": 6.279977657705388, "raw_target": 8.653439782764549, "ema_target": 31.06828795655292, "delta": -20.93171204344708}
{"type": "rank_change", "step": -4.0, "layer": "blocks.1.attn.k_proj", "old_rank": 52, "new_rank": 48, "stable_rank": 1.6394431797766322, "fro2": 41.154029846191406, "sigma2": 25.10244352317477, "raw_target": 8.0, "ema_target": 30.93760000000001, "delta": -21.06239999999999}
{"type": "rank_change", "step": -4.0, "layer": "blocks.1.attn.v_proj", "old_rank": 52, "new_rank": 48, "stable_rank": 17.313422169285342, "fro2": 5.531247615814209, "sigma2": 0.31947741980742705, "raw_target": 25.97013325392801, "ema_target": 41.37692409626044, "delta": -10.623075903739561}
{"type": "rank_change", "step": -4.0, "layer": "blocks.1.attn.o_proj", "old_rank": 52, "new_rank": 48, "stable_rank": 21.330694526414213, "fro2": 6.491795063018799, "sigma2": 0.304340528700223, "raw_target": 31.99604178962132, "ema_target": 43.07628168636681, "delta": -8.923718313633188}
{"type": "rank_change", "step": -4.0, "layer": "blocks.1.mlp.fc1", "old_rank": 52, "new_rank": 48, "stable_rank": 11.864941542082898, "fro2": 13.070032119750977, "sigma2": 1.1015673321899158, "raw_target": 17.797412313124347, "ema_target": 38.47384225255588, "delta": -13.526157747444117}
{"type": "rank_change", "step": -4.0, "layer": "blocks.2.attn.q_proj", "old_rank": 52, "new_rank": 48, "stable_rank": 2.8374082457748786, "fro2": 7.631278991699219, "sigma2": 2.689524489360565, "raw_target": 8.0, "ema_target": 30.93760000000001, "delta": -21.06239999999999}
{"type": "rank_change", "step": -4.0, "layer": "blocks.2.attn.k_proj", "old_rank": 52, "new_rank": 48, "stable_rank": 2.7959124588275297, "fro2": 13.941370964050293, "sigma2": 4.986340288328449, "raw_target": 8.0, "ema_target": 30.93760000000001, "delta": -21.06239999999999}
{"type": "rank_change", "step": -4.0, "layer": "blocks.2.attn.v_proj", "old_rank": 52, "new_rank": 48, "stable_rank": 11.645011274158401, "fro2": 3.772491693496704, "sigma2": 0.3239577436406762, "raw_target": 17.467516911237603, "ema_target": 36.93067409163955, "delta": -15.069325908360447}
{"type": "rank_change", "step": -4.0, "layer": "blocks.2.attn.o_proj", "old_rank": 52, "new_rank": 48, "stable_rank": 9.958945503468428, "fro2": 3.5564887523651123, "sigma2": 0.3571149828600859, "raw_target": 14.938418255202642, "ema_target": 34.350893044639996, "delta": -17.649106955360004}
{"type": "rank_change", "step": -4.0, "layer": "blocks.2.mlp.fc1", "old_rank": 53, "new_rank": 49, "stable_rank": 13.946241282755857, "fro2": 3.0011329650878906, "sigma2": 0.21519295161889218, "raw_target": 20.919361924133785, "ema_target": 43.87249661354193, "delta": -9.127503386458073}
{"type": "rank_change", "step": -4.0, "layer": "blocks.2.mlp.fc2", "old_rank": 62, "new_rank": 58, "stable_rank": 25.582913774415626, "fro2": 2.940220832824707, "sigma2": 0.11492907347934533, "raw_target": 38.37437066162344, "ema_target": 57.09696315422761, "delta": -4.903036845772391}
{"type": "rank_change", "step": -4.0, "layer": "blocks.3.attn.q_proj", "old_rank": 52, "new_rank": 48, "stable_rank": 6.126826958343857, "fro2": 210.59698486328125, "sigma2": 34.37292847241429, "raw_target": 9.190240437515786, "ema_target": 31.175648087503166, "delta": -20.824351912496834}
{"type": "rank_change", "step": -4.0, "layer": "blocks.3.attn.k_proj", "old_rank": 52, "new_rank": 48, "stable_rank": 1.5225371556716805, "fro2": 104.87303161621094, "sigma2": 68.88044157761124, "raw_target": 8.0, "ema_target": 30.93760000000001, "delta": -21.06239999999999}
{"type": "rank_change", "step": -4.0, "layer": "blocks.3.attn.v_proj", "old_rank": 52, "new_rank": 48, "stable_rank": 23.491599417516962, "fro2": 10.180763244628906, "sigma2": 0.4333788784990702, "raw_target": 35.23739912627544, "ema_target": 44.76167707884391, "delta": -7.23832292115609}
{"type": "rank_change", "step": -4.0, "layer": "blocks.3.mlp.fc1", "old_rank": 52, "new_rank": 48, "stable_rank": 15.925734222484843, "fro2": 46.28498077392578, "sigma2": 2.906301208349987, "raw_target": 23.888601333727266, "ema_target": 37.85986342479945, "delta": -14.14013657520055}
{"type": "rank_change", "step": -3.0, "layer": "blocks.3.mlp.fc2", "old_rank": 54, "new_rank": 51, "stable_rank": 28.498314436548945, "fro2": 12.308895111083984, "sigma2": 0.4319165911902054, "raw_target": 42.747471654823414, "ema_target": 50.86453769130068, "delta": -3.135462308699317}
{"type": "rank_change", "step": -4.0, "layer": "blocks.4.attn.q_proj", "old_rank": 52, "new_rank": 48, "stable_rank": 7.91686089905688, "fro2": 127.02388000488281, "sigma2": 16.04472802355872, "raw_target": 11.875291348585321, "ema_target": 31.951991800347976, "delta": -20.048008199652024}
{"type": "rank_change", "step": -4.0, "layer": "blocks.4.attn.k_proj", "old_rank": 52, "new_rank": 48, "stable_rank": 2.438942049999606, "fro2": 91.0791015625, "sigma2": 37.34369233501275, "raw_target": 8.0, "ema_target": 30.93760000000001, "delta": -21.06239999999999}
{"type": "rank_change", "step": -4.0, "layer": "blocks.4.attn.v_proj", "old_rank": 52, "new_rank": 48, "stable_rank": 27.29559202591578, "fro2": 12.02750015258789, "sigma2": 0.44063890859053245, "raw_target": 40.94338803887367, "ema_target": 46.366524144588, "delta": -5.6334758554120015}
{"type": "rank_change", "step": -4.0, "layer": "blocks.4.attn.o_proj", "old_rank": 52, "new_rank": 48, "stable_rank": 29.577577195548688, "fro2": 14.643752098083496, "sigma2": 0.4950963936461825, "raw_target": 44.366365793323034, "ema_target": 46.96755479933962, "delta": -5.0324452006603835}
{"type": "rank_change", "step": -4.0, "layer": "blocks.4.mlp.fc1", "old_rank": 52, "new_rank": 48, "stable_rank": 19.24357667624268, "fro2": 87.89482116699219, "sigma2": 4.567488801760419, "raw_target": 28.865365014364016, "ema_target": 41.3981569294344, "delta": -10.6018430705656}
{"type": "rank_change", "step": -4.0, "layer": "blocks.4.mlp.fc2", "old_rank": 52, "new_rank": 48, "stable_rank": 27.807136391223562, "fro2": 20.79673194885254, "sigma2": 0.7478918856723773, "raw_target": 41.71070458683534, "ema_target": 47.499928241312, "delta": -4.5000717586880015}
{"type": "rank_change", "step": -4.0, "layer": "blocks.5.attn.q_proj", "old_rank": 52, "new_rank": 48, "stable_rank": 4.819078271730765, "fro2": 97.04888916015625, "sigma2": 20.138475376352517, "raw_target": 8.0, "ema_target": 30.93760000000001, "delta": -21.06239999999999}
{"type": "rank_change", "step": -4.0, "layer": "blocks.5.attn.k_proj", "old_rank": 52, "new_rank": 48, "stable_rank": 2.7019900730969386, "fro2": 58.142982482910156, "sigma2": 21.518577375544737, "raw_target": 8.0, "ema_target": 30.93760000000001, "delta": -21.06239999999999}
{"type": "rank_change", "step": -4.0, "layer": "blocks.5.attn.v_proj", "old_rank": 52, "new_rank": 48, "stable_rank": 21.921733716967058, "fro2": 12.36657428741455, "sigma2": 0.5641239067978319, "raw_target": 32.88260057545059, "ema_target": 41.52059887983289, "delta": -10.479401120167111}
{"type": "rank_change", "step": -4.0, "layer": "blocks.5.attn.o_proj", "old_rank": 52, "new_rank": 48, "stable_rank": 16.96837498097273, "fro2": 14.733465194702148, "sigma2": 0.8682896884079696, "raw_target": 25.452562471459096, "ema_target": 40.60029211444048, "delta": -11.399707885559522}
{"type": "rank_change", "step": -4.0, "layer": "blocks.5.mlp.fc1", "old_rank": 52, "new_rank": 48, "stable_rank": 16.790483196099323, "fro2": 142.27938842773438, "sigma2": 8.473811420321908, "raw_target": 25.185724794148985, "ema_target": 42.39284008418598, "delta": -9.607159915814023}
{"type": "rank_change", "step": -4.0, "layer": "blocks.5.mlp.fc2", "old_rank": 52, "new_rank": 48, "stable_rank": 12.149395381637646, "fro2": 34.0380859375, "sigma2": 2.8016279614581094, "raw_target": 18.22409307245647, "ema_target": 39.06139883192371, "delta": -12.93860116807629}
{"type": "train_step", "time": 1765591375.279221, "step": 4750, "epoch": 4.011824324324325, "lr": 0.00028641342395576905, "loss": 1.5399425029754639, "ppl": 4.664322078637069, "r_min": 48, "r_mean": 49.30555725097656, "r_max": 61, "tokens_per_step": 8192, "tok_per_sec": 74719.61418289978}
{"type": "train_step", "time": 1765591379.8881989, "step": 4800, "epoch": 4.054054054054054, "lr": 0.00028609741953140064, "loss": 1.5754001140594482, "ppl": 4.832674852480581, "r_min": 48, "r_mean": 49.30555725097656, "r_max": 61, "tokens_per_step": 8192, "tok_per_sec": 88870.12305450284}
{"type": "train_step", "time": 1765591384.5240672, "step": 4850, "epoch": 4.096283783783784, "lr": 0.0002857779816660645, "loss": 1.5530506372451782, "ppl": 4.725865114703589, "r_min": 48, "r_mean": 49.30555725097656, "r_max": 61, "tokens_per_step": 8192, "tok_per_sec": 88356.33684592733}
{"type": "train_step", "time": 1765591389.1514251, "step": 4900, "epoch": 4.138513513513513, "lr": 0.00028545511941669224, "loss": 1.5605336427688599, "ppl": 4.761361433399886, "r_min": 48, "r_mean": 49.30555725097656, "r_max": 61, "tokens_per_step": 8192, "tok_per_sec": 88515.1181366385}
{"type": "train_step", "time": 1765591393.802264, "step": 4950, "epoch": 4.180743243243243, "lr": 0.0002851288419373062, "loss": 1.561406135559082, "ppl": 4.765517499727474, "r_min": 48, "r_mean": 49.30555725097656, "r_max": 61, "tokens_per_step": 8192, "tok_per_sec": 88069.9035524686}
{"type": "train_step", "time": 1765591398.4438012, "step": 5000, "epoch": 4.222972972972973, "lr": 0.00028479915847875965, "loss": 1.5611060857772827, "ppl": 4.76408782173953, "r_min": 48, "r_mean": 49.30555725097656, "r_max": 61, "tokens_per_step": 8192, "tok_per_sec": 88246.89874510722}
{"type": "eval", "time": 1765591399.788115, "step": 5000, "val_loss": 1.5046227955818177, "val_ppl": 4.502454964031317, "r_min": 48, "r_mean": 49.30555725097656, "r_max": 61}
{"type": "train_step", "time": 1765591404.607438, "step": 5050, "epoch": 4.265202702702703, "lr": 0.0002844660783884747, "loss": 1.488236427307129, "ppl": 4.429277274558245, "r_min": 48, "r_mean": 49.30555725097656, "r_max": 61, "tokens_per_step": 8192, "tok_per_sec": 66454.74424147657}
{"type": "train_step", "time": 1765591409.251349, "step": 5100, "epoch": 4.3074324324324325, "lr": 0.00028412961111017705, "loss": 1.519709825515747, "ppl": 4.570898644529149, "r_min": 48, "r_mean": 49.30555725097656, "r_max": 61, "tokens_per_step": 8192, "tok_per_sec": 88200.81385636095}
{"type": "train_step", "time": 1765591413.8901749, "step": 5150, "epoch": 4.349662162162162, "lr": 0.00028378976618362864, "loss": 1.517981767654419, "ppl": 4.5630066880357685, "r_min": 48, "r_mean": 49.30555725097656, "r_max": 61, "tokens_per_step": 8192, "tok_per_sec": 88298.43197648757}
{"type": "train_step", "time": 1765591418.530765, "step": 5200, "epoch": 4.391891891891892, "lr": 0.00028344655324435676, "loss": 1.4985594749450684, "ppl": 4.475237732716175, "r_min": 48, "r_mean": 49.30555725097656, "r_max": 61, "tokens_per_step": 8192, "tok_per_sec": 88265.89581215724}
{"type": "train_step", "time": 1765591423.1778612, "step": 5250, "epoch": 4.434121621621622, "lr": 0.000283099982023381, "loss": 1.524914026260376, "ppl": 4.594748524611904, "r_min": 48, "r_mean": 49.30555725097656, "r_max": 61, "tokens_per_step": 8192, "tok_per_sec": 88139.58987587511}
{"type": "train_step", "time": 1765591427.827169, "step": 5300, "epoch": 4.476351351351352, "lr": 0.0002827500623469374, "loss": 1.5343927145004272, "ppl": 4.638507775937999, "r_min": 48, "r_mean": 49.30555725097656, "r_max": 61, "tokens_per_step": 8192, "tok_per_sec": 88099.49423428522}
{"type": "train_step", "time": 1765591432.48909, "step": 5350, "epoch": 4.518581081081081, "lr": 0.0002823968041361999, "loss": 1.5545196533203125, "ppl": 4.732812588251774, "r_min": 48, "r_mean": 49.30555725097656, "r_max": 61, "tokens_per_step": 8192, "tok_per_sec": 87861.56708384011}
{"type": "train_step", "time": 1765591437.1243079, "step": 5400, "epoch": 4.5608108108108105, "lr": 0.00028204021740699877, "loss": 1.5035983324050903, "ppl": 4.497844726628235, "r_min": 48, "r_mean": 49.30555725097656, "r_max": 61, "tokens_per_step": 8192, "tok_per_sec": 88367.94420699736}
{"type": "train_step", "time": 1765591441.7476008, "step": 5450, "epoch": 4.60304054054054, "lr": 0.0002816803122695369, "loss": 1.5009636878967285, "ppl": 4.486010101580395, "r_min": 48, "r_mean": 49.30555725097656, "r_max": 61, "tokens_per_step": 8192, "tok_per_sec": 88594.53337656862}
{"type": "train_step", "time": 1765591446.378012, "step": 5500, "epoch": 4.64527027027027, "lr": 0.0002813170989281033, "loss": 1.512896180152893, "ppl": 4.539860025330203, "r_min": 48, "r_mean": 49.30555725097656, "r_max": 61, "tokens_per_step": 8192, "tok_per_sec": 88458.95897326685}
{"type": "eval", "time": 1765591447.722858, "step": 5500, "val_loss": 1.4723076820373535, "val_ppl": 4.359283382487881, "r_min": 48, "r_mean": 49.30555725097656, "r_max": 61}
{"type": "train_step", "time": 1765591452.5185611, "step": 5550, "epoch": 4.6875, "lr": 0.00028095058768078313, "loss": 1.463658094406128, "ppl": 4.321739980403183, "r_min": 48, "r_mean": 49.30555725097656, "r_max": 61, "tokens_per_step": 8192, "tok_per_sec": 66704.56916965109}
{"type": "train_step", "time": 1765591457.152777, "step": 5600, "epoch": 4.72972972972973, "lr": 0.0002805807889191665, "loss": 1.4734368324279785, "ppl": 4.364208449069209, "r_min": 48, "r_mean": 49.30555725097656, "r_max": 61, "tokens_per_step": 8192, "tok_per_sec": 88385.67927072513}
{"type": "train_step", "time": 1765591461.785791, "step": 5650, "epoch": 4.77195945945946, "lr": 0.00028020771312805334, "loss": 1.4556748867034912, "ppl": 4.287375982475179, "r_min": 48, "r_mean": 49.30555725097656, "r_max": 61, "tokens_per_step": 8192, "tok_per_sec": 88409.94523739255}
{"type": "train_step", "time": 1765591466.421186, "step": 5700, "epoch": 4.8141891891891895, "lr": 0.0002798313708851563, "loss": 1.4730345010757446, "ppl": 4.362452944353438, "r_min": 48, "r_mean": 49.30555725097656, "r_max": 61, "tokens_per_step": 8192, "tok_per_sec": 88362.67643223976}
{"type": "train_step", "time": 1765591471.090692, "step": 5750, "epoch": 4.856418918918919, "lr": 0.00027945177286080075, "loss": 1.4534552097320557, "ppl": 4.277869946806218, "r_min": 48, "r_mean": 49.30555725097656, "r_max": 61, "tokens_per_step": 8192, "tok_per_sec": 87717.0224449555}
{"type": "train_step", "time": 1765591475.870479, "step": 5800, "epoch": 4.898648648648648, "lr": 0.00027906892981762247, "loss": 1.4778656959533691, "ppl": 4.383579797552058, "r_min": 48, "r_mean": 49.30555725097656, "r_max": 61, "tokens_per_step": 8192, "tok_per_sec": 85696.59634271277}
{"type": "train_step", "time": 1765591480.534347, "step": 5850, "epoch": 4.940878378378378, "lr": 0.0002786828526102621, "loss": 1.4418721199035645, "ppl": 4.228604866677115, "r_min": 48, "r_mean": 49.30555725097656, "r_max": 61, "tokens_per_step": 8192, "tok_per_sec": 87820.66895118012}
{"type": "train_step", "time": 1765591485.200346, "step": 5900, "epoch": 4.983108108108108, "lr": 0.0002782935521850579, "loss": 1.4500075578689575, "ppl": 4.263146735351432, "r_min": 48, "r_mean": 49.30555725097656, "r_max": 61, "tokens_per_step": 8192, "tok_per_sec": 87784.57228046638}
{"type": "rank_update", "step": 5920, "changed_layers": 34, "total_layers": 36, "r_min": 44, "r_mean": 45.69444274902344, "r_max": 57, "resize_method": "svd", "took_sec": 0.8891570568084717}
{"type": "rank_change", "step": -4.0, "layer": "blocks.0.attn.q_proj", "old_rank": 48, "new_rank": 44, "stable_rank": 3.164230001318009, "fro2": 11.059545516967773, "sigma2": 3.495177493645784, "raw_target": 8.0, "ema_target": 26.705123501260786, "delta": -21.294876498739214}
{"type": "rank_change", "step": -4.0, "layer": "blocks.0.attn.k_proj", "old_rank": 48, "new_rank": 44, "stable_rank": 3.4647114166978312, "fro2": 13.17832088470459, "sigma2": 3.8035839829389175, "raw_target": 8.0, "ema_target": 26.350080000000013, "delta": -21.649919999999987}
{"type": "rank_change", "step": -4.0, "layer": "blocks.0.attn.v_proj", "old_rank": 48, "new_rank": 44, "stable_rank": 15.644781505828465, "fro2": 3.7227442264556885, "sigma2": 0.23795436635666434, "raw_target": 23.4671722587427, "ema_target": 35.45527132480275, "delta": -12.544728675197248}
{"type": "rank_change", "step": -4.0, "layer": "blocks.0.attn.o_proj", "old_rank": 48, "new_rank": 44, "stable_rank": 15.156811968856337, "fro2": 4.618663311004639, "sigma2": 0.3047252396431901, "raw_target": 22.735217953284504, "ema_target": 35.36259047136623, "delta": -12.637409528633768}
{"type": "rank_change", "step": -4.0, "layer": "blocks.0.mlp.fc1", "old_rank": 55, "new_rank": 51, "stable_rank": 22.42113477587235, "fro2": 4.595722198486328, "sigma2": 0.20497276432326217, "raw_target": 33.63170216380853, "ema_target": 50.69882241251136, "delta": -4.301177587488638}
{"type": "rank_change", "step": -4.0, "layer": "blocks.0.mlp.fc2", "old_rank": 61, "new_rank": 57, "stable_rank": 23.228894470208022, "fro2": 4.087618827819824, "sigma2": 0.17597129302788872, "raw_target": 34.843341705312035, "ema_target": 55.55089758231952, "delta": -5.4491024176804785}
{"type": "rank_change", "step": -4.0, "layer": "blocks.1.attn.q_proj", "old_rank": 48, "new_rank": 44, "stable_rank": 6.589099029865158, "fro2": 42.33162307739258, "sigma2": 6.424493366943352, "raw_target": 9.883648544797737, "ema_target": 26.831360074201882, "delta": -21.168639925798118}
{"type": "rank_change", "step": -4.0, "layer": "blocks.1.attn.k_proj", "old_rank": 48, "new_rank": 44, "stable_rank": 1.7779704080614114, "fro2": 44.40044021606445, "sigma2": 24.972541723400354, "raw_target": 8.0, "ema_target": 26.350080000000013, "delta": -21.649919999999987}
{"type": "rank_change", "step": -4.0, "layer": "blocks.1.attn.v_proj", "old_rank": 48, "new_rank": 44, "stable_rank": 19.740047339207848, "fro2": 5.712536811828613, "sigma2": 0.28938819225027146, "raw_target": 29.610071008811772, "ema_target": 39.0235534787707, "delta": -8.976446521229299}
{"type": "rank_change", "step": -4.0, "layer": "blocks.1.attn.o_proj", "old_rank": 48, "new_rank": 44, "stable_rank": 21.41344786102898, "fro2": 6.75862979888916, "sigma2": 0.3156254718351512, "raw_target": 32.12017179154347, "ema_target": 40.88505970740215, "delta": -7.114940292597851}
{"type": "rank_change", "step": -4.0, "layer": "blocks.1.mlp.fc1", "old_rank": 48, "new_rank": 44, "stable_rank": 12.243624832157034, "fro2": 12.848223686218262, "sigma2": 1.0493806972945663, "raw_target": 18.36543724823555, "ema_target": 34.45216125169182, "delta": -13.54783874830818}
{"type": "rank_change", "step": -4.0, "layer": "blocks.1.mlp.fc2", "old_rank": 57, "new_rank": 53, "stable_rank": 24.026894681216696, "fro2": 6.435311317443848, "sigma2": 0.26783781935023754, "raw_target": 36.04034202182504, "ema_target": 51.45487238559512, "delta": -5.545127614404883}
{"type": "rank_change", "step": -4.0, "layer": "blocks.2.attn.q_proj", "old_rank": 48, "new_rank": 44, "stable_rank": 4.642217961334686, "fro2": 8.922521591186523, "sigma2": 1.9220384779604416, "raw_target": 8.0, "ema_target": 26.350080000000013, "delta": -21.649919999999987}
{"type": "rank_change", "step": -4.0, "layer": "blocks.2.attn.k_proj", "old_rank": 48, "new_rank": 44, "stable_rank": 3.1033570951849296, "fro2": 16.14238166809082, "sigma2": 5.201586907965975, "raw_target": 8.0, "ema_target": 26.350080000000013, "delta": -21.649919999999987}
{"type": "rank_change", "step": -4.0, "layer": "blocks.2.attn.v_proj", "old_rank": 48, "new_rank": 44, "stable_rank": 14.966281293704556, "fro2": 3.988128900527954, "sigma2": 0.2664742612142881, "raw_target": 22.449421940556835, "ema_target": 34.034423661423006, "delta": -13.965576338576994}
{"type": "rank_change", "step": -4.0, "layer": "blocks.2.attn.o_proj", "old_rank": 48, "new_rank": 44, "stable_rank": 9.519410800152505, "fro2": 3.590921640396118, "sigma2": 0.3772209877889168, "raw_target": 14.279116200228756, "ema_target": 30.33653767575775, "delta": -17.66346232424225}
{"type": "rank_change", "step": -4.0, "layer": "blocks.2.mlp.fc1", "old_rank": 49, "new_rank": 45, "stable_rank": 8.92393969270635, "fro2": 2.0512423515319824, "sigma2": 0.22985837342324178, "raw_target": 13.385909539059526, "ema_target": 37.775179198645446, "delta": -11.224820801354554}
{"type": "rank_change", "step": -4.0, "layer": "blocks.2.mlp.fc2", "old_rank": 58, "new_rank": 54, "stable_rank": 16.040561919391024, "fro2": 1.9701464176177979, "sigma2": 0.12282277061818636, "raw_target": 24.060842879086536, "ema_target": 50.4897390991994, "delta": -7.510260900800603}
{"type": "rank_change", "step": -4.0, "layer": "blocks.3.attn.q_proj", "old_rank": 48, "new_rank": 44, "stable_rank": 6.917975517794421, "fro2": 232.62612915039062, "sigma2": 33.62633020062731, "raw_target": 10.376963276691631, "ema_target": 27.01591112534086, "delta": -20.98408887465914}
{"type": "rank_change", "step": -4.0, "layer": "blocks.3.attn.k_proj", "old_rank": 48, "new_rank": 44, "stable_rank": 1.664009361084487, "fro2": 111.48375701904297, "sigma2": 66.99707321943515, "raw_target": 8.0, "ema_target": 26.350080000000013, "delta": -21.649919999999987}
{"type": "rank_change", "step": -4.0, "layer": "blocks.3.attn.v_proj", "old_rank": 48, "new_rank": 44, "stable_rank": 25.430850147819648, "fro2": 10.297046661376953, "sigma2": 0.40490374278546426, "raw_target": 38.14627522172947, "ema_target": 43.43859670742102, "delta": -4.56140329257898}
{"type": "rank_change", "step": -2.0, "layer": "blocks.3.attn.o_proj", "old_rank": 52, "new_rank": 50, "stable_rank": 30.407610471759664, "fro2": 11.435802459716797, "sigma2": 0.3760835520522541, "raw_target": 45.611415707639495, "ema_target": 49.587819568819164, "delta": -2.412180431180836}
{"type": "rank_change", "step": -4.0, "layer": "blocks.3.mlp.fc1", "old_rank": 48, "new_rank": 44, "stable_rank": 18.479956007604414, "fro2": 61.267494201660156, "sigma2": 3.3153484776505593, "raw_target": 27.71993401140662, "ema_target": 35.831877542120885, "delta": -12.168122457879115}
{"type": "rank_change", "step": -2.0, "layer": "blocks.3.mlp.fc2", "old_rank": 51, "new_rank": 49, "stable_rank": 27.606689544914968, "fro2": 12.712333679199219, "sigma2": 0.4604801811694905, "raw_target": 41.41003431737245, "ema_target": 48.973637016515035, "delta": -2.0263629834849652}
{"type": "rank_change", "step": -4.0, "layer": "blocks.4.attn.q_proj", "old_rank": 48, "new_rank": 44, "stable_rank": 10.307784169307576, "fro2": 140.8032684326172, "sigma2": 13.659896832996822, "raw_target": 15.461676253961365, "ema_target": 28.653928691070654, "delta": -19.346071308929346}
{"type": "rank_change", "step": -4.0, "layer": "blocks.4.attn.k_proj", "old_rank": 48, "new_rank": 44, "stable_rank": 2.8751327318966005, "fro2": 97.97801971435547, "sigma2": 34.077737907067785, "raw_target": 8.0, "ema_target": 26.350080000000013, "delta": -21.649919999999987}
{"type": "rank_change", "step": -2.0, "layer": "blocks.4.attn.v_proj", "old_rank": 48, "new_rank": 46, "stable_rank": 28.157653102572347, "fro2": 12.489143371582031, "sigma2": 0.4435434673660552, "raw_target": 42.236479653858524, "ema_target": 45.540515246442105, "delta": -2.459484753557895}
{"type": "rank_change", "step": -4.0, "layer": "blocks.4.mlp.fc1", "old_rank": 48, "new_rank": 44, "stable_rank": 13.431789093503076, "fro2": 132.4755401611328, "sigma2": 9.862836521971076, "raw_target": 20.147683640254613, "ema_target": 37.14806227159844, "delta": -10.851937728401559}
{"type": "rank_change", "step": -4.0, "layer": "blocks.5.attn.q_proj", "old_rank": 48, "new_rank": 44, "stable_rank": 6.4170572306695455, "fro2": 110.10299682617188, "sigma2": 17.157864236550267, "raw_target": 9.625585846004318, "ema_target": 26.675197169200874, "delta": -21.324802830799126}
{"type": "rank_change", "step": -4.0, "layer": "blocks.5.attn.k_proj", "old_rank": 48, "new_rank": 44, "stable_rank": 3.4290859654589845, "fro2": 65.98723602294922, "sigma2": 19.243389245222943, "raw_target": 8.0, "ema_target": 26.350080000000013, "delta": -21.649919999999987}
{"type": "rank_change", "step": -4.0, "layer": "blocks.5.attn.v_proj", "old_rank": 48, "new_rank": 44, "stable_rank": 26.271224734664422, "fro2": 13.945418357849121, "sigma2": 0.5308248182558515, "raw_target": 39.40683710199663, "ema_target": 41.097846524265634, "delta": -6.902153475734366}
{"type": "rank_change", "step": -4.0, "layer": "blocks.5.attn.o_proj", "old_rank": 48, "new_rank": 44, "stable_rank": 14.152147292244425, "fro2": 16.56204605102539, "sigma2": 1.1702850152344126, "raw_target": 21.22822093836664, "ema_target": 36.72587787922571, "delta": -11.274122120774287}
{"type": "rank_change", "step": -4.0, "layer": "blocks.5.mlp.fc1", "old_rank": 48, "new_rank": 44, "stable_rank": 11.380620095746524, "fro2": 212.15805053710938, "sigma2": 18.64204662297766, "raw_target": 17.070930143619787, "ema_target": 37.32845809607274, "delta": -10.671541903927263}
{"type": "rank_change", "step": -4.0, "layer": "blocks.5.mlp.fc2", "old_rank": 48, "new_rank": 44, "stable_rank": 11.164991743576802, "fro2": 46.46363067626953, "sigma2": 4.161546343404154, "raw_target": 16.747487615365202, "ema_target": 34.59861658861201, "delta": -13.40138341138799}
{"type": "train_step", "time": 1765591490.6649349, "step": 5950, "epoch": 5.025337837837838, "lr": 0.00027790103957973494, "loss": 1.5118751525878906, "ppl": 4.535227068693792, "r_min": 44, "r_mean": 45.69444274902344, "r_max": 57, "tokens_per_step": 8192, "tok_per_sec": 74956.88172460083}
{"type": "train_step", "time": 1765591495.192062, "step": 6000, "epoch": 5.0675675675675675, "lr": 0.0002775053259230923, "loss": 1.4535199403762817, "ppl": 4.278146865046241, "r_min": 44, "r_mean": 45.69444274902344, "r_max": 57, "tokens_per_step": 8192, "tok_per_sec": 90476.26893670089}
{"type": "eval", "time": 1765591496.5264509, "step": 6000, "val_loss": 1.458003475666046, "val_ppl": 4.297371151670205, "r_min": 44, "r_mean": 45.69444274902344, "r_max": 57}
{"type": "train_step", "time": 1765591501.274255, "step": 6050, "epoch": 5.109797297297297, "lr": 0.0002771064224346877, "loss": 1.5358152389526367, "ppl": 4.645110862083298, "r_min": 44, "r_mean": 45.69444274902344, "r_max": 57, "tokens_per_step": 8192, "tok_per_sec": 67344.08689915083}
{"type": "train_step", "time": 1765591505.833132, "step": 6100, "epoch": 5.152027027027027, "lr": 0.00027670434042451915, "loss": 1.483370304107666, "ppl": 4.4077762214695015, "r_min": 44, "r_mean": 45.69444274902344, "r_max": 57, "tokens_per_step": 8192, "tok_per_sec": 89847.12058182049}
{"type": "train_step", "time": 1765591510.416019, "step": 6150, "epoch": 5.194256756756757, "lr": 0.00027629909129270455, "loss": 1.4494739770889282, "ppl": 4.2608726089600255, "r_min": 44, "r_mean": 45.69444274902344, "r_max": 57, "tokens_per_step": 8192, "tok_per_sec": 89375.01978308757}
{"type": "train_step", "time": 1765591515.0389519, "step": 6200, "epoch": 5.236486486486487, "lr": 0.0002758906865291581, "loss": 1.4314604997634888, "ppl": 4.184806639982335, "r_min": 44, "r_mean": 45.69444274902344, "r_max": 57, "tokens_per_step": 8192, "tok_per_sec": 88601.0534116281}
{"type": "train_step", "time": 1765591519.638583, "step": 6250, "epoch": 5.278716216216216, "lr": 0.0002754791377132648, "loss": 1.467064380645752, "ppl": 4.336486164433472, "r_min": 44, "r_mean": 45.69444274902344, "r_max": 57, "tokens_per_step": 8192, "tok_per_sec": 89051.0449556216}
{"type": "train_step", "time": 1765591524.2276511, "step": 6300, "epoch": 5.320945945945946, "lr": 0.0002750644565135522, "loss": 1.4394865036010742, "ppl": 4.218529061251811, "r_min": 44, "r_mean": 45.69444274902344, "r_max": 57, "tokens_per_step": 8192, "tok_per_sec": 89255.518539806}
{"type": "train_step", "time": 1765591528.794646, "step": 6350, "epoch": 5.363175675675675, "lr": 0.00027464665468735926, "loss": 1.4514155387878418, "ppl": 4.269153392246053, "r_min": 44, "r_mean": 45.69444274902344, "r_max": 57, "tokens_per_step": 8192, "tok_per_sec": 89686.99826189659}
{"type": "train_step", "time": 1765591533.3584561, "step": 6400, "epoch": 5.405405405405405, "lr": 0.0002742257440805033, "loss": 1.428680181503296, "ppl": 4.173187705318614, "r_min": 44, "r_mean": 45.69444274902344, "r_max": 57, "tokens_per_step": 8192, "tok_per_sec": 89750.95427201079}
{"type": "train_step", "time": 1765591537.914648, "step": 6450, "epoch": 5.447635135135135, "lr": 0.000273801736626944, "loss": 1.4239016771316528, "ppl": 4.153293679325325, "r_min": 44, "r_mean": 45.69444274902344, "r_max": 57, "tokens_per_step": 8192, "tok_per_sec": 89898.84672192714}
{"type": "train_step", "time": 1765591542.472119, "step": 6500, "epoch": 5.489864864864865, "lr": 0.0002733746443484451, "loss": 1.4465981721878052, "ppl": 4.248636772999418, "r_min": 44, "r_mean": 45.69444274902344, "r_max": 57, "tokens_per_step": 8192, "tok_per_sec": 89874.18921799705}
{"type": "eval", "time": 1765591543.795604, "step": 6500, "val_loss": 1.4437910676002503, "val_ppl": 4.236727128851941, "r_min": 44, "r_mean": 45.69444274902344, "r_max": 57}
{"type": "train_step", "time": 1765591548.5111911, "step": 6550, "epoch": 5.532094594594595, "lr": 0.00027294447935423334, "loss": 1.4633831977844238, "ppl": 4.320552111960677, "r_min": 44, "r_mean": 45.69444274902344, "r_max": 57, "tokens_per_step": 8192, "tok_per_sec": 67825.63256766902}
{"type": "train_step", "time": 1765591553.082283, "step": 6600, "epoch": 5.574324324324325, "lr": 0.00027251125384065566, "loss": 1.4365012645721436, "ppl": 4.20595452199449, "r_min": 44, "r_mean": 45.69444274902344, "r_max": 57, "tokens_per_step": 8192, "tok_per_sec": 89605.63666515323}
{"type": "train_step", "time": 1765591557.627511, "step": 6650, "epoch": 5.616554054054054, "lr": 0.0002720749800908325, "loss": 1.431768774986267, "ppl": 4.186096911050641, "r_min": 44, "r_mean": 45.69444274902344, "r_max": 57, "tokens_per_step": 8192, "tok_per_sec": 90117.46509705116}
{"type": "train_step", "time": 1765591562.157071, "step": 6700, "epoch": 5.658783783783784, "lr": 0.00027163567047431067, "loss": 1.4471434354782104, "ppl": 4.250954030366277, "r_min": 44, "r_mean": 45.69444274902344, "r_max": 57, "tokens_per_step": 8192, "tok_per_sec": 90429.10719315337}
{"type": "train_step", "time": 1765591566.666472, "step": 6750, "epoch": 5.701013513513513, "lr": 0.0002711933374467116, "loss": 1.4127428531646729, "ppl": 4.107205429844934, "r_min": 44, "r_mean": 45.69444274902344, "r_max": 57, "tokens_per_step": 8192, "tok_per_sec": 90831.9187696337}
{"type": "train_step", "time": 1765591571.222443, "step": 6800, "epoch": 5.743243243243243, "lr": 0.0002707479935493789, "loss": 1.3975874185562134, "ppl": 4.04542825891416, "r_min": 44, "r_mean": 45.69444274902344, "r_max": 57, "tokens_per_step": 8192, "tok_per_sec": 89903.99344229627}
{"type": "train_step", "time": 1765591575.7736971, "step": 6850, "epoch": 5.785472972972973, "lr": 0.0002702996514090224, "loss": 1.4178199768066406, "ppl": 4.12811124543277, "r_min": 44, "r_mean": 45.69444274902344, "r_max": 57, "tokens_per_step": 8192, "tok_per_sec": 89997.72533469927}
{"type": "train_step", "time": 1765591580.363431, "step": 6900, "epoch": 5.827702702702703, "lr": 0.0002698483237373603, "loss": 1.4428733587265015, "ppl": 4.23284083028823, "r_min": 44, "r_mean": 45.69444274902344, "r_max": 57, "tokens_per_step": 8192, "tok_per_sec": 89242.97683592071}
{"type": "train_step", "time": 1765591584.919071, "step": 6950, "epoch": 5.8699324324324325, "lr": 0.00026939402333075877, "loss": 1.4256579875946045, "ppl": 4.160594561901556, "r_min": 44, "r_mean": 45.69444274902344, "r_max": 57, "tokens_per_step": 8192, "tok_per_sec": 89911.30053918407}
{"type": "train_step", "time": 1765591589.454297, "step": 7000, "epoch": 5.912162162162162, "lr": 0.000268936763069869, "loss": 1.4132421016693115, "ppl": 4.109256457957786, "r_min": 44, "r_mean": 45.69444274902344, "r_max": 57, "tokens_per_step": 8192, "tok_per_sec": 90316.72805762566}
{"type": "eval", "time": 1765591590.814077, "step": 7000, "val_loss": 1.4107344889640807, "val_ppl": 4.09896494321418, "r_min": 44, "r_mean": 45.69444274902344, "r_max": 57}
{"type": "train_step", "time": 1765591595.4903738, "step": 7050, "epoch": 5.954391891891892, "lr": 0.0002684765559192622, "loss": 1.4280670881271362, "ppl": 4.170629935734925, "r_min": 44, "r_mean": 45.69444274902344, "r_max": 57, "tokens_per_step": 8192, "tok_per_sec": 67857.9012497285}
{"type": "train_step", "time": 1765591599.983792, "step": 7100, "epoch": 5.996621621621622, "lr": 0.00026801341492706184, "loss": 1.4511421918869019, "ppl": 4.267986591874543, "r_min": 44, "r_mean": 45.69444274902344, "r_max": 57, "tokens_per_step": 8192, "tok_per_sec": 91157.82130511402}
{"type": "rank_update", "step": 7104, "changed_layers": 30, "total_layers": 36, "r_min": 40, "r_mean": 42.41666793823242, "r_max": 53, "resize_method": "svd", "took_sec": 0.8276369571685791}
{"type": "rank_change", "step": -4.0, "layer": "blocks.0.attn.q_proj", "old_rank": 44, "new_rank": 40, "stable_rank": 3.38356399472267, "fro2": 11.99863052368164, "sigma2": 3.546151486586396, "raw_target": 8.0, "ema_target": 22.96409880100863, "delta": -21.03590119899137}
{"type": "rank_change", "step": -4.0, "layer": "blocks.0.attn.k_proj", "old_rank": 44, "new_rank": 40, "stable_rank": 3.6199493493321677, "fro2": 14.116168975830078, "sigma2": 3.899548744303516, "raw_target": 8.0, "ema_target": 22.68006400000001, "delta": -21.31993599999999}
{"type": "rank_change", "step": -4.0, "layer": "blocks.0.attn.v_proj", "old_rank": 44, "new_rank": 40, "stable_rank": 16.95919725653528, "fro2": 3.74588680267334, "sigma2": 0.22087641156705562, "raw_target": 25.43879588480292, "ema_target": 33.451976236802786, "delta": -10.548023763197214}
{"type": "rank_change", "step": -4.0, "layer": "blocks.0.attn.o_proj", "old_rank": 44, "new_rank": 40, "stable_rank": 13.920490626819129, "fro2": 4.698598861694336, "sigma2": 0.33753111499081356, "raw_target": 20.880735940228693, "ema_target": 32.46621956513872, "delta": -11.533780434861278}
{"type": "rank_change", "step": -4.0, "layer": "blocks.0.mlp.fc1", "old_rank": 51, "new_rank": 47, "stable_rank": 17.12403483560315, "fro2": 3.376845359802246, "sigma2": 0.19719915434538748, "raw_target": 25.686052253404725, "ema_target": 45.696268380690036, "delta": -5.303731619309964}
{"type": "rank_change", "step": -4.0, "layer": "blocks.0.mlp.fc2", "old_rank": 57, "new_rank": 53, "stable_rank": 15.403141680322966, "fro2": 2.9073712825775146, "sigma2": 0.18875182666534673, "raw_target": 23.104712520484448, "ema_target": 49.06166056995251, "delta": -7.938339430047492}
{"type": "rank_change", "step": -4.0, "layer": "blocks.1.attn.q_proj", "old_rank": 44, "new_rank": 40, "stable_rank": 7.0899886192949335, "fro2": 46.934776306152344, "sigma2": 6.619866230465107, "raw_target": 10.6349829289424, "ema_target": 23.592084645149985, "delta": -20.407915354850015}
{"type": "rank_change", "step": -4.0, "layer": "blocks.1.attn.k_proj", "old_rank": 44, "new_rank": 40, "stable_rank": 2.252871616833293, "fro2": 46.70111846923828, "sigma2": 20.729595995511772, "raw_target": 8.0, "ema_target": 22.68006400000001, "delta": -21.31993599999999}
{"type": "rank_change", "step": -4.0, "layer": "blocks.1.attn.v_proj", "old_rank": 44, "new_rank": 40, "stable_rank": 21.646796129732973, "fro2": 5.844534397125244, "sigma2": 0.26999534460573216, "raw_target": 32.47019419459946, "ema_target": 37.712881621936454, "delta": -6.287118378063546}
{"type": "rank_change", "step": -3.0, "layer": "blocks.1.attn.o_proj", "old_rank": 44, "new_rank": 41, "stable_rank": 25.86678806916098, "fro2": 6.907265663146973, "sigma2": 0.2670322030710146, "raw_target": 38.80018210374147, "ema_target": 40.46808418667001, "delta": -3.531915813329988}
{"type": "rank_change", "step": -4.0, "layer": "blocks.1.mlp.fc1", "old_rank": 44, "new_rank": 40, "stable_rank": 12.820700917939961, "fro2": 13.281879425048828, "sigma2": 1.0359713857965858, "raw_target": 19.231051376909942, "ema_target": 31.407939276735444, "delta": -12.592060723264556}
{"type": "rank_change", "step": -4.0, "layer": "blocks.1.mlp.fc2", "old_rank": 53, "new_rank": 49, "stable_rank": 17.61306725262902, "fro2": 5.754238605499268, "sigma2": 0.3267028023474836, "raw_target": 26.419600878943527, "ema_target": 46.447818084264796, "delta": -6.552181915735204}
{"type": "rank_change", "step": -4.0, "layer": "blocks.2.attn.q_proj", "old_rank": 44, "new_rank": 40, "stable_rank": 4.322809131812933, "fro2": 9.987798690795898, "sigma2": 2.3104880051410106, "raw_target": 8.0, "ema_target": 22.68006400000001, "delta": -21.31993599999999}
{"type": "rank_change", "step": -4.0, "layer": "blocks.2.attn.k_proj", "old_rank": 44, "new_rank": 40, "stable_rank": 3.2600694235202488, "fro2": 17.55706024169922, "sigma2": 5.385486604190248, "raw_target": 8.0, "ema_target": 22.68006400000001, "delta": -21.31993599999999}
{"type": "rank_change", "step": -4.0, "layer": "blocks.2.attn.v_proj", "old_rank": 44, "new_rank": 40, "stable_rank": 13.040994655149571, "fro2": 4.2069621086120605, "sigma2": 0.32259517693620765, "raw_target": 19.561491982724355, "ema_target": 31.139837325683274, "delta": -12.860162674316726}
{"type": "rank_change", "step": -4.0, "layer": "blocks.2.attn.o_proj", "old_rank": 44, "new_rank": 40, "stable_rank": 10.329421433331165, "fro2": 3.641289234161377, "sigma2": 0.3525162715423136, "raw_target": 15.494132149996748, "ema_target": 27.36805657060555, "delta": -16.63194342939445}
{"type": "rank_change", "step": -4.0, "layer": "blocks.2.mlp.fc1", "old_rank": 45, "new_rank": 41, "stable_rank": 7.097649599535511, "fro2": 1.6762444972991943, "sigma2": 0.23616894618641027, "raw_target": 10.646474399303266, "ema_target": 32.34943823877701, "delta": -12.650561761222988}
{"type": "rank_change", "step": -4.0, "layer": "blocks.2.mlp.fc2", "old_rank": 54, "new_rank": 50, "stable_rank": 11.370234031832757, "fro2": 1.520890474319458, "sigma2": 0.13376069097251175, "raw_target": 17.055351047749134, "ema_target": 43.80286148890935, "delta": -10.19713851109065}
{"type": "rank_change", "step": -4.0, "layer": "blocks.3.attn.q_proj", "old_rank": 44, "new_rank": 40, "stable_rank": 8.348842156299334, "fro2": 248.95803833007812, "sigma2": 29.819468806072337, "raw_target": 12.523263234449, "ema_target": 24.117381547162488, "delta": -19.882618452837512}
{"type": "rank_change", "step": -4.0, "layer": "blocks.3.attn.k_proj", "old_rank": 44, "new_rank": 40, "stable_rank": 1.8455350085715692, "fro2": 116.92135620117188, "sigma2": 63.3536376387749, "raw_target": 8.0, "ema_target": 22.68006400000001, "delta": -21.31993599999999}
{"type": "rank_change", "step": -4.0, "layer": "blocks.3.mlp.fc1", "old_rank": 44, "new_rank": 40, "stable_rank": 19.807798680571665, "fro2": 77.99806213378906, "sigma2": 3.9377450868487927, "raw_target": 29.711698020857497, "ema_target": 34.60784163786821, "delta": -9.392158362131788}
{"type": "rank_change", "step": -4.0, "layer": "blocks.4.attn.q_proj", "old_rank": 44, "new_rank": 40, "stable_rank": 11.523974380279432, "fro2": 150.96047973632812, "sigma2": 13.09968893018555, "raw_target": 17.285961570419147, "ema_target": 26.380335266940353, "delta": -17.619664733059647}
{"type": "rank_change", "step": -4.0, "layer": "blocks.4.attn.k_proj", "old_rank": 44, "new_rank": 40, "stable_rank": 3.3481848828652, "fro2": 103.50098419189453, "sigma2": 30.912565398671177, "raw_target": 8.0, "ema_target": 22.68006400000001, "delta": -21.31993599999999}
{"type": "rank_change", "step": -4.0, "layer": "blocks.4.mlp.fc1", "old_rank": 44, "new_rank": 40, "stable_rank": 11.481970685124855, "fro2": 180.55325317382812, "sigma2": 15.724935902590232, "raw_target": 17.22295602768728, "ema_target": 33.16304102281621, "delta": -10.83695897718379}
{"type": "rank_change", "step": -4.0, "layer": "blocks.5.attn.q_proj", "old_rank": 44, "new_rank": 40, "stable_rank": 7.590477608277412, "fro2": 120.21195983886719, "sigma2": 15.837206295407725, "raw_target": 11.38571641241612, "ema_target": 23.617301017843925, "delta": -20.382698982156075}
{"type": "rank_change", "step": -4.0, "layer": "blocks.5.attn.k_proj", "old_rank": 44, "new_rank": 40, "stable_rank": 4.218882931061924, "fro2": 72.2981185913086, "sigma2": 17.136791831036135, "raw_target": 8.0, "ema_target": 22.68006400000001, "delta": -21.31993599999999}
{"type": "rank_change", "step": -3.0, "layer": "blocks.5.attn.v_proj", "old_rank": 44, "new_rank": 41, "stable_rank": 26.158280798756895, "fro2": 14.771162986755371, "sigma2": 0.5646840034638103, "raw_target": 39.237421198135344, "ema_target": 40.725761459039575, "delta": -3.2742385409604253}
{"type": "rank_change", "step": -4.0, "layer": "blocks.5.attn.o_proj", "old_rank": 44, "new_rank": 40, "stable_rank": 15.96610043343042, "fro2": 17.481422424316406, "sigma2": 1.0949086996880055, "raw_target": 23.94915065014563, "ema_target": 34.1705324334097, "delta": -9.829467566590303}
{"type": "rank_change", "step": -4.0, "layer": "blocks.5.mlp.fc1", "old_rank": 44, "new_rank": 40, "stable_rank": 10.107603086727961, "fro2": 276.5284729003906, "sigma2": 27.358461786297994, "raw_target": 15.16140463009194, "ema_target": 32.89504740287658, "delta": -11.104952597123422}
{"type": "rank_change", "step": -4.0, "layer": "blocks.5.mlp.fc2", "old_rank": 44, "new_rank": 40, "stable_rank": 11.084043333864182, "fro2": 60.95758056640625, "sigma2": 5.4995797670085835, "raw_target": 16.626065000796274, "ema_target": 31.004106271048865, "delta": -12.995893728951135}
{"type": "train_step", "time": 1765591605.1884701, "step": 7150, "epoch": 6.038851351351352, "lr": 0.00026754735322457375, "loss": 1.4608573913574219, "ppl": 4.3096530039809995, "r_min": 40, "r_mean": 42.41666793823242, "r_max": 53, "tokens_per_step": 8192, "tok_per_sec": 78695.75669981747}
{"type": "train_step", "time": 1765591609.5861208, "step": 7200, "epoch": 6.081081081081081, "lr": 0.00026707838402591395, "loss": 1.4283783435821533, "ppl": 4.171928269099469, "r_min": 40, "r_mean": 42.41666793823242, "r_max": 53, "tokens_per_step": 8192, "tok_per_sec": 93141.16460955772}
{"type": "train_step", "time": 1765591614.02657, "step": 7250, "epoch": 6.1233108108108105, "lr": 0.0002666065206276338, "loss": 1.4192728996276855, "ppl": 4.134113431769947, "r_min": 40, "r_mean": 42.41666793823242, "r_max": 53, "tokens_per_step": 8192, "tok_per_sec": 92244.33564994737}
{"type": "train_step", "time": 1765591618.559755, "step": 7300, "epoch": 6.16554054054054, "lr": 0.000266131776408343, "loss": 1.433131217956543, "ppl": 4.191804116348031, "r_min": 40, "r_mean": 42.41666793823242, "r_max": 53, "tokens_per_step": 8192, "tok_per_sec": 90355.85955373754}
{"type": "train_step", "time": 1765591623.0761259, "step": 7350, "epoch": 6.20777027027027, "lr": 0.0002656541648283306, "loss": 1.426253318786621, "ppl": 4.163072231065281, "r_min": 40, "r_mean": 42.41666793823242, "r_max": 53, "tokens_per_step": 8192, "tok_per_sec": 90692.50369015193}
{"type": "train_step", "time": 1765591627.5256362, "step": 7400, "epoch": 6.25, "lr": 0.00026517369942918287, "loss": 1.4093469381332397, "ppl": 4.093281365040325, "r_min": 40, "r_mean": 42.41666793823242, "r_max": 53, "tokens_per_step": 8192, "tok_per_sec": 92053.79574768238}
{"type": "train_step", "time": 1765591632.082627, "step": 7450, "epoch": 6.29222972972973, "lr": 0.00026469039383339975, "loss": 1.4349920749664307, "ppl": 4.199611726592131, "r_min": 40, "r_mean": 42.41666793823242, "r_max": 53, "tokens_per_step": 8192, "tok_per_sec": 89884.34122281095}
{"type": "train_step", "time": 1765591636.612053, "step": 7500, "epoch": 6.33445945945946, "lr": 0.00026420426174400834, "loss": 1.4104282855987549, "ppl": 4.097710018495106, "r_min": 40, "r_mean": 42.41666793823242, "r_max": 53, "tokens_per_step": 8192, "tok_per_sec": 90430.24482043406}
{"type": "eval", "time": 1765591638.0113852, "step": 7500, "val_loss": 1.411522159576416, "val_ppl": 4.102194849325011, "r_min": 40, "r_mean": 42.41666793823242, "r_max": 53}
{"type": "train_step", "time": 1765591642.740841, "step": 7550, "epoch": 6.3766891891891895, "lr": 0.0002637153169441747, "loss": 1.387885570526123, "ppl": 4.006369904206653, "r_min": 40, "r_mean": 42.41666793823242, "r_max": 53, "tokens_per_step": 8192, "tok_per_sec": 66831.85379786571}
{"type": "train_step", "time": 1765591647.7036932, "step": 7600, "epoch": 6.418918918918919, "lr": 0.0002632235732968128, "loss": 1.4042692184448242, "ppl": 4.072549509482916, "r_min": 40, "r_mean": 42.41666793823242, "r_max": 53, "tokens_per_step": 8192, "tok_per_sec": 82533.47007026784}
{"type": "train_step", "time": 1765591652.5240488, "step": 7650, "epoch": 6.461148648648648, "lr": 0.0002627290447441914, "loss": 1.383903980255127, "ppl": 3.9904498952821106, "r_min": 40, "r_mean": 42.41666793823242, "r_max": 53, "tokens_per_step": 8192, "tok_per_sec": 84975.0594520808}
{"type": "train_step", "time": 1765591656.9828858, "step": 7700, "epoch": 6.503378378378378, "lr": 0.00026223174530753913, "loss": 1.4066236019134521, "ppl": 4.082149148905061, "r_min": 40, "r_mean": 42.41666793823242, "r_max": 53, "tokens_per_step": 8192, "tok_per_sec": 91861.38398730528}
{"type": "train_step", "time": 1765591661.41713, "step": 7750, "epoch": 6.545608108108108, "lr": 0.00026173168908664654, "loss": 1.4151859283447266, "ppl": 4.117251908644507, "r_min": 40, "r_mean": 42.41666793823242, "r_max": 53, "tokens_per_step": 8192, "tok_per_sec": 92371.56764292902}
{"type": "train_step", "time": 1765591665.848802, "step": 7800, "epoch": 6.587837837837838, "lr": 0.00026122889025946664, "loss": 1.4177416563034058, "ppl": 4.127787942343414, "r_min": 40, "r_mean": 42.41666793823242, "r_max": 53, "tokens_per_step": 8192, "tok_per_sec": 92427.34611361839}
{"type": "train_step", "time": 1765591670.312866, "step": 7850, "epoch": 6.6300675675675675, "lr": 0.0002607233630817126, "loss": 1.364861249923706, "ppl": 3.9151797828107036, "r_min": 40, "r_mean": 42.41666793823242, "r_max": 53, "tokens_per_step": 8192, "tok_per_sec": 91754.6505969118}
{"type": "train_step", "time": 1765591674.790646, "step": 7900, "epoch": 6.672297297297297, "lr": 0.000260215121886454, "loss": 1.4189074039459229, "ppl": 4.132602707261178, "r_min": 40, "r_mean": 42.41666793823242, "r_max": 53, "tokens_per_step": 8192, "tok_per_sec": 91474.57490088936}
{"type": "train_step", "time": 1765591679.262594, "step": 7950, "epoch": 6.714527027027027, "lr": 0.0002597041810837099, "loss": 1.3699769973754883, "ppl": 3.935260173117233, "r_min": 40, "r_mean": 42.41666793823242, "r_max": 53, "tokens_per_step": 8192, "tok_per_sec": 91593.3519780716}
{"type": "train_step", "time": 1765591683.830635, "step": 8000, "epoch": 6.756756756756757, "lr": 0.00025919055516004084, "loss": 1.3316540718078613, "ppl": 3.7873026800729988, "r_min": 40, "r_mean": 42.41666793823242, "r_max": 53, "tokens_per_step": 8192, "tok_per_sec": 89665.66240360084}
{"type": "eval", "time": 1765591685.1554291, "step": 8000, "val_loss": 1.4034011697769164, "val_ppl": 4.069015872212669, "r_min": 40, "r_mean": 42.41666793823242, "r_max": 53}
{"type": "train_step", "time": 1765591689.924149, "step": 8050, "epoch": 6.798986486486487, "lr": 0.00025867425867813764, "loss": 1.4027519226074219, "ppl": 4.066374932579065, "r_min": 40, "r_mean": 42.41666793823242, "r_max": 53, "tokens_per_step": 8192, "tok_per_sec": 67219.54518236434}
{"type": "train_step", "time": 1765591694.494227, "step": 8100, "epoch": 6.841216216216216, "lr": 0.00025815530627640873, "loss": 1.3753730058670044, "ppl": 3.956552264918482, "r_min": 40, "r_mean": 42.41666793823242, "r_max": 53, "tokens_per_step": 8192, "tok_per_sec": 89625.71891668496}
{"type": "train_step", "time": 1765591698.963318, "step": 8150, "epoch": 6.883445945945946, "lr": 0.0002576337126685653, "loss": 1.3891910314559937, "ppl": 4.011603478957618, "r_min": 40, "r_mean": 42.41666793823242, "r_max": 53, "tokens_per_step": 8192, "tok_per_sec": 91651.60210140905}
{"type": "train_step", "time": 1765591703.447021, "step": 8200, "epoch": 6.925675675675675, "lr": 0.0002571094926432035, "loss": 1.3822693824768066, "ppl": 3.983932442906541, "r_min": 40, "r_mean": 42.41666793823242, "r_max": 53, "tokens_per_step": 8192, "tok_per_sec": 91353.21993572151}
{"type": "train_step", "time": 1765591707.9600892, "step": 8250, "epoch": 6.967905405405405, "lr": 0.00025658266106338604, "loss": 1.3753894567489624, "ppl": 3.9566173542281398, "r_min": 40, "r_mean": 42.41666793823242, "r_max": 53, "tokens_per_step": 8192, "tok_per_sec": 90759.86333721592}
{"type": "rank_update", "step": 8288, "changed_layers": 29, "total_layers": 36, "r_min": 36, "r_mean": 39.27777862548828, "r_max": 50, "resize_method": "svd", "took_sec": 0.8183670043945312}
{"type": "rank_change", "step": -4.0, "layer": "blocks.0.attn.q_proj", "old_rank": 40, "new_rank": 36, "stable_rank": 3.6854429781253315, "fro2": 12.881924629211426, "sigma2": 3.495353114623313, "raw_target": 8.0, "ema_target": 19.971279040806905, "delta": -20.028720959193095}
{"type": "rank_change", "step": -4.0, "layer": "blocks.0.attn.k_proj", "old_rank": 40, "new_rank": 36, "stable_rank": 4.514828247071267, "fro2": 14.875182151794434, "sigma2": 3.2947393106915115, "raw_target": 8.0, "ema_target": 19.74405120000001, "delta": -20.25594879999999}
{"type": "rank_change", "step": -4.0, "layer": "blocks.0.attn.v_proj", "old_rank": 40, "new_rank": 36, "stable_rank": 15.912041394565822, "fro2": 3.743638515472412, "sigma2": 0.23527077786703732, "raw_target": 23.868062091848735, "ema_target": 31.535193407811974, "delta": -8.464806592188026}
{"type": "rank_change", "step": -4.0, "layer": "blocks.0.attn.o_proj", "old_rank": 40, "new_rank": 36, "stable_rank": 13.872748398984386, "fro2": 4.775367736816406, "sigma2": 0.3442264979330645, "raw_target": 20.80912259847658, "ema_target": 30.134800171806294, "delta": -9.865199828193706}
{"type": "rank_change", "step": -4.0, "layer": "blocks.0.mlp.fc1", "old_rank": 47, "new_rank": 43, "stable_rank": 13.094723290195423, "fro2": 2.7682366371154785, "sigma2": 0.21140091659981408, "raw_target": 19.642084935293134, "ema_target": 40.48543169161066, "delta": -6.514568308389343}
{"type": "rank_change", "step": -4.0, "layer": "blocks.0.mlp.fc2", "old_rank": 53, "new_rank": 49, "stable_rank": 11.624508258926431, "fro2": 2.304180145263672, "sigma2": 0.19821741941206117, "raw_target": 17.436762388389646, "ema_target": 42.73668093363994, "delta": -10.263319066360062}
{"type": "rank_change", "step": -4.0, "layer": "blocks.1.attn.q_proj", "old_rank": 40, "new_rank": 36, "stable_rank": 7.171125448480945, "fro2": 49.80044174194336, "sigma2": 6.944578229457875, "raw_target": 10.756688172721418, "ema_target": 21.025005350664273, "delta": -18.974994649335727}
{"type": "rank_change", "step": -4.0, "layer": "blocks.1.attn.k_proj", "old_rank": 40, "new_rank": 36, "stable_rank": 2.0704811946939907, "fro2": 48.225379943847656, "sigma2": 23.29187053073929, "raw_target": 8.0, "ema_target": 19.74405120000001, "delta": -20.25594879999999}
{"type": "rank_change", "step": -3.0, "layer": "blocks.1.attn.v_proj", "old_rank": 40, "new_rank": 37, "stable_rank": 21.20426639617089, "fro2": 5.902170181274414, "sigma2": 0.27834822761411715, "raw_target": 31.806399594256334, "ema_target": 36.53158521640043, "delta": -3.4684147835995702}
{"type": "rank_change", "step": -4.0, "layer": "blocks.1.mlp.fc1", "old_rank": 40, "new_rank": 36, "stable_rank": 11.722146626985063, "fro2": 13.969080924987793, "sigma2": 1.1916828250218856, "raw_target": 17.583219940477594, "ema_target": 28.642995409483873, "delta": -11.357004590516127}
{"type": "rank_change", "step": -4.0, "layer": "blocks.1.mlp.fc2", "old_rank": 49, "new_rank": 45, "stable_rank": 17.67066906648699, "fro2": 5.356988430023193, "sigma2": 0.3031570696706787, "raw_target": 26.506003599730484, "ema_target": 42.45945518735793, "delta": -6.540544812642068}
{"type": "rank_change", "step": -4.0, "layer": "blocks.2.attn.q_proj", "old_rank": 40, "new_rank": 36, "stable_rank": 3.422867792331636, "fro2": 10.875103950500488, "sigma2": 3.177190758181098, "raw_target": 8.0, "ema_target": 19.74405120000001, "delta": -20.25594879999999}
{"type": "rank_change", "step": -4.0, "layer": "blocks.2.attn.k_proj", "old_rank": 40, "new_rank": 36, "stable_rank": 3.478693978024279, "fro2": 18.594383239746094, "sigma2": 5.3452195917273, "raw_target": 8.0, "ema_target": 19.74405120000001, "delta": -20.25594879999999}
{"type": "rank_change", "step": -4.0, "layer": "blocks.2.attn.v_proj", "old_rank": 40, "new_rank": 36, "stable_rank": 15.358944520409556, "fro2": 4.437736511230469, "sigma2": 0.2889349819412388, "raw_target": 23.038416780614334, "ema_target": 29.519553216669486, "delta": -10.480446783330514}
{"type": "rank_change", "step": -4.0, "layer": "blocks.2.attn.o_proj", "old_rank": 40, "new_rank": 36, "stable_rank": 9.502238386911289, "fro2": 3.7879014015197754, "sigma2": 0.3986325276489566, "raw_target": 14.253357580366934, "ema_target": 24.74511677255783, "delta": -15.254883227442171}
{"type": "rank_change", "step": -4.0, "layer": "blocks.2.mlp.fc1", "old_rank": 41, "new_rank": 37, "stable_rank": 6.40461287848627, "fro2": 1.5629457235336304, "sigma2": 0.24403436853109284, "raw_target": 9.606919317729405, "ema_target": 27.800934454567493, "delta": -13.199065545432507}
{"type": "rank_change", "step": -4.0, "layer": "blocks.2.mlp.fc2", "old_rank": 50, "new_rank": 46, "stable_rank": 8.861731362633352, "fro2": 1.3541395664215088, "sigma2": 0.15280755220295905, "raw_target": 13.292597043950028, "ema_target": 37.70080859991749, "delta": -12.299191400082513}
{"type": "rank_change", "step": -4.0, "layer": "blocks.3.attn.q_proj", "old_rank": 40, "new_rank": 36, "stable_rank": 9.177040369100752, "fro2": 261.85784912109375, "sigma2": 28.53401952017157, "raw_target": 13.765560553651127, "ema_target": 22.047017348460216, "delta": -17.952982651539784}
{"type": "rank_change", "step": -4.0, "layer": "blocks.3.attn.k_proj", "old_rank": 40, "new_rank": 36, "stable_rank": 2.0424227855926507, "fro2": 121.94369506835938, "sigma2": 59.70541256596425, "raw_target": 8.0, "ema_target": 19.74405120000001, "delta": -20.25594879999999}
{"type": "rank_change", "step": -2.0, "layer": "blocks.3.attn.v_proj", "old_rank": 44, "new_rank": 42, "stable_rank": 24.019543018448363, "fro2": 10.146687507629395, "sigma2": 0.4224346508025043, "raw_target": 36.02931452767255, "ema_target": 41.25016473041822, "delta": -2.74983526958178}
{"type": "rank_change", "step": -4.0, "layer": "blocks.3.mlp.fc1", "old_rank": 40, "new_rank": 36, "stable_rank": 12.826050610895932, "fro2": 94.28036499023438, "sigma2": 7.350693344518788, "raw_target": 19.239075916343896, "ema_target": 31.53408849356335, "delta": -8.465911506436651}
{"type": "rank_change", "step": -4.0, "layer": "blocks.4.attn.q_proj", "old_rank": 40, "new_rank": 36, "stable_rank": 12.991043646310922, "fro2": 157.96575927734375, "sigma2": 12.15958959481219, "raw_target": 19.486565469466385, "ema_target": 25.001581307445562, "delta": -14.998418692554438}
{"type": "rank_change", "step": -4.0, "layer": "blocks.4.attn.k_proj", "old_rank": 40, "new_rank": 36, "stable_rank": 3.7489870379942842, "fro2": 108.27848815917969, "sigma2": 28.882065215039802, "raw_target": 8.0, "ema_target": 19.74405120000001, "delta": -20.25594879999999}
{"type": "rank_change", "step": -4.0, "layer": "blocks.4.mlp.fc1", "old_rank": 40, "new_rank": 36, "stable_rank": 10.342636902504358, "fro2": 223.52838134765625, "sigma2": 21.61232027686333, "raw_target": 15.513955353756536, "ema_target": 29.633223889004274, "delta": -10.366776110995726}
{"type": "rank_change", "step": -4.0, "layer": "blocks.5.attn.q_proj", "old_rank": 40, "new_rank": 36, "stable_rank": 10.69397710068331, "fro2": 126.9986801147461, "sigma2": 11.87572021261309, "raw_target": 16.040965651024965, "ema_target": 22.102033944480134, "delta": -17.897966055519866}
{"type": "rank_change", "step": -4.0, "layer": "blocks.5.attn.k_proj", "old_rank": 40, "new_rank": 36, "stable_rank": 4.849544578199874, "fro2": 77.10050201416016, "sigma2": 15.898503606349777, "raw_target": 8.0, "ema_target": 19.74405120000001, "delta": -20.25594879999999}
{"type": "rank_change", "step": -4.0, "layer": "blocks.5.attn.o_proj", "old_rank": 40, "new_rank": 36, "stable_rank": 13.59907212216861, "fro2": 17.725971221923828, "sigma2": 1.3034691577991566, "raw_target": 20.398608183252918, "ema_target": 31.41614758337834, "delta": -8.58385241662166}
{"type": "rank_change", "step": -4.0, "layer": "blocks.5.mlp.fc1", "old_rank": 40, "new_rank": 36, "stable_rank": 9.413610256297076, "fro2": 323.7861328125, "sigma2": 34.3955319906911, "raw_target": 14.120415384445614, "ema_target": 29.140120999190383, "delta": -10.859879000809617}
{"type": "rank_change", "step": -4.0, "layer": "blocks.5.mlp.fc2", "old_rank": 40, "new_rank": 36, "stable_rank": 10.717991066322883, "fro2": 75.9331283569336, "sigma2": 7.084641868040364, "raw_target": 16.076986599484325, "ema_target": 28.01868233673596, "delta": -11.98131766326404}
{"type": "train_step", "time": 1765591713.3603861, "step": 8300, "epoch": 7.010135135135135, "lr": 0.0002560532328662199, "loss": 1.4612810611724854, "ppl": 4.311479260709793, "r_min": 36, "r_mean": 39.27777862548828, "r_max": 50, "tokens_per_step": 8192, "tok_per_sec": 75846.08065925668}
{"type": "train_step", "time": 1765591717.856906, "step": 8350, "epoch": 7.052364864864865, "lr": 0.00025552122306243347, "loss": 1.3979771137237549, "ppl": 4.0470050499712675, "r_min": 36, "r_mean": 39.27777862548828, "r_max": 50, "tokens_per_step": 8192, "tok_per_sec": 91093.6613493651}
{"type": "train_step", "time": 1765591722.406889, "step": 8400, "epoch": 7.094594594594595, "lr": 0.0002549866467359505, "loss": 1.3899569511413574, "ppl": 4.0146772220019145, "r_min": 36, "r_mean": 39.27777862548828, "r_max": 50, "tokens_per_step": 8192, "tok_per_sec": 90021.48367014619}
{"type": "train_step", "time": 1765591726.936445, "step": 8450, "epoch": 7.136824324324325, "lr": 0.0002544495190434628, "loss": 1.427921175956726, "ppl": 4.170021434463975, "r_min": 36, "r_mean": 39.27777862548828, "r_max": 50, "tokens_per_step": 8192, "tok_per_sec": 90428.92631781293}
