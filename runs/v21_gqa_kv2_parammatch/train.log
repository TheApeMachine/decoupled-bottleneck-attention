File wiki.train.tokens could not be read as space-separated integers. Tokenizing as words...
Tokenized 2075677 tokens. Vocab size: 33278
Device: mps
Tokens: train 1,868,110 | val 207,567 | vocab 33,278
Uniform baseline loss log(V): 10.4127 (ppl ~ 33278)
== eval step 0 | train 10.5307 | val 10.5275 | val_ppl 37328.95 | 26.7s
   (new best) 10.5275
step      0/6000 | loss 10.5363 | ppl 37659.04 | tok/s    32299
step     50/6000 | loss 6.4266 | ppl   618.08 | tok/s    29783
step    100/6000 | loss 5.8609 | ppl   351.03 | tok/s    28916
step    150/6000 | loss 5.5174 | ppl   248.98 | tok/s    27194
== eval step 200 | train 5.3370 | val 5.8770 | val_ppl 356.74 | 203.3s
   (new best) 5.8770
step    200/6000 | loss 5.3153 | ppl   203.42 | tok/s    23930
step    250/6000 | loss 5.1308 | ppl   169.16 | tok/s    21764
step    300/6000 | loss 4.8431 | ppl   126.86 | tok/s    23346
step    350/6000 | loss 4.7869 | ppl   119.93 | tok/s    25046
== eval step 400 | train 4.6393 | val 5.6345 | val_ppl 279.93 | 225.5s
   (new best) 5.6345
step    400/6000 | loss 4.7388 | ppl   114.29 | tok/s    24936
step    450/6000 | loss 4.5114 | ppl    91.05 | tok/s    23383
step    500/6000 | loss 4.3890 | ppl    80.56 | tok/s    22403
step    550/6000 | loss 4.2282 | ppl    68.59 | tok/s    22345
== eval step 600 | train 4.1183 | val 5.6320 | val_ppl 279.23 | 230.7s
   (new best) 5.6320
step    600/6000 | loss 4.1141 | ppl    61.20 | tok/s    24026
step    650/6000 | loss 3.8911 | ppl    48.96 | tok/s    22784
step    700/6000 | loss 3.7771 | ppl    43.69 | tok/s    22893
step    750/6000 | loss 3.8482 | ppl    46.91 | tok/s    20850
== eval step 800 | train 3.6832 | val 5.7488 | val_ppl 313.80 | 244.4s
step    800/6000 | loss 3.8099 | ppl    45.14 | tok/s    21344
step    850/6000 | loss 3.4907 | ppl    32.81 | tok/s    26167
step    900/6000 | loss 3.3780 | ppl    29.31 | tok/s    25271
step    950/6000 | loss 3.4241 | ppl    30.70 | tok/s    23074
== eval step 1000 | train 3.2851 | val 5.9425 | val_ppl 380.89 | 221.3s
step   1000/6000 | loss 3.2676 | ppl    26.25 | tok/s    22904
step   1050/6000 | loss 3.1583 | ppl    23.53 | tok/s    24501
step   1100/6000 | loss 3.2074 | ppl    24.72 | tok/s    25301
step   1150/6000 | loss 3.1617 | ppl    23.61 | tok/s    25433
== eval step 1200 | train 2.9080 | val 6.1253 | val_ppl 457.28 | 223.0s
step   1200/6000 | loss 2.8424 | ppl    17.16 | tok/s    22904
step   1250/6000 | loss 2.9845 | ppl    19.78 | tok/s    20812
step   1300/6000 | loss 2.6629 | ppl    14.34 | tok/s    23071
step   1350/6000 | loss 2.6762 | ppl    14.53 | tok/s    22586
== eval step 1400 | train 2.6046 | val 6.4005 | val_ppl 602.13 | 243.9s
step   1400/6000 | loss 2.7336 | ppl    15.39 | tok/s    21851
step   1450/6000 | loss 2.3724 | ppl    10.72 | tok/s    21969
step   1500/6000 | loss 2.4591 | ppl    11.69 | tok/s    24249
step   1550/6000 | loss 2.3257 | ppl    10.23 | tok/s    23307
== eval step 1600 | train 2.2895 | val 6.6003 | val_ppl 735.29 | 224.8s
step   1600/6000 | loss 2.1968 | ppl     9.00 | tok/s    24895
step   1650/6000 | loss 2.2941 | ppl     9.92 | tok/s    24771
step   1700/6000 | loss 2.2170 | ppl     9.18 | tok/s    20822
step   1750/6000 | loss 2.0894 | ppl     8.08 | tok/s    22349
== eval step 1800 | train 2.0178 | val 6.8096 | val_ppl 906.46 | 227.7s
step   1800/6000 | loss 1.9965 | ppl     7.36 | tok/s    25372
step   1850/6000 | loss 2.0761 | ppl     7.97 | tok/s    25303
step   1900/6000 | loss 1.8012 | ppl     6.06 | tok/s    25030
step   1950/6000 | loss 1.8351 | ppl     6.27 | tok/s    25094
== eval step 2000 | train 1.7410 | val 7.0530 | val_ppl 1156.37 | 199.7s
step   2000/6000 | loss 1.8539 | ppl     6.38 | tok/s    31224
step   2050/6000 | loss 1.6708 | ppl     5.32 | tok/s    31504
step   2100/6000 | loss 1.7799 | ppl     5.93 | tok/s    31280
step   2150/6000 | loss 1.5521 | ppl     4.72 | tok/s    28674
== eval step 2200 | train 1.5407 | val 7.2572 | val_ppl 1418.30 | 179.1s
step   2200/6000 | loss 1.5817 | ppl     4.86 | tok/s    29732
step   2250/6000 | loss 1.4836 | ppl     4.41 | tok/s    31626
step   2300/6000 | loss 1.4029 | ppl     4.07 | tok/s    31373
step   2350/6000 | loss 1.3107 | ppl     3.71 | tok/s    30939
== eval step 2400 | train 1.3485 | val 7.4704 | val_ppl 1755.37 | 184.9s
step   2400/6000 | loss 1.4504 | ppl     4.26 | tok/s    26566
step   2450/6000 | loss 1.2820 | ppl     3.60 | tok/s    24239
step   2500/6000 | loss 1.2563 | ppl     3.51 | tok/s    25122
step   2550/6000 | loss 1.1713 | ppl     3.23 | tok/s    25209
== eval step 2600 | train 1.1868 | val 7.6246 | val_ppl 2047.90 | 212.6s
step   2600/6000 | loss 1.1106 | ppl     3.04 | tok/s    26448
step   2650/6000 | loss 1.0796 | ppl     2.94 | tok/s    24491
step   2700/6000 | loss 1.1933 | ppl     3.30 | tok/s    24557
step   2750/6000 | loss 0.9304 | ppl     2.54 | tok/s    25433
== eval step 2800 | train 1.0159 | val 7.8149 | val_ppl 2477.20 | 210.8s
step   2800/6000 | loss 1.0226 | ppl     2.78 | tok/s    26293
step   2850/6000 | loss 0.9565 | ppl     2.60 | tok/s    28586
step   2900/6000 | loss 0.9057 | ppl     2.47 | tok/s    28672
step   2950/6000 | loss 0.9569 | ppl     2.60 | tok/s    28816
== eval step 3000 | train 0.8967 | val 7.9644 | val_ppl 2876.71 | 188.5s
step   3000/6000 | loss 0.9258 | ppl     2.52 | tok/s    28671
step   3050/6000 | loss 0.8960 | ppl     2.45 | tok/s    27928
step   3100/6000 | loss 0.8450 | ppl     2.33 | tok/s    27621
step   3150/6000 | loss 0.7685 | ppl     2.16 | tok/s    28323
== eval step 3200 | train 0.7925 | val 8.1092 | val_ppl 3324.85 | 196.4s
step   3200/6000 | loss 0.7059 | ppl     2.03 | tok/s    26690
step   3250/6000 | loss 0.7871 | ppl     2.20 | tok/s    25367
step   3300/6000 | loss 0.6861 | ppl     1.99 | tok/s    24981
step   3350/6000 | loss 0.7156 | ppl     2.05 | tok/s    25549
== eval step 3400 | train 0.6911 | val 8.2320 | val_ppl 3759.16 | 215.0s
step   3400/6000 | loss 0.7170 | ppl     2.05 | tok/s    23593
step   3450/6000 | loss 0.7163 | ppl     2.05 | tok/s    27613
step   3500/6000 | loss 0.6647 | ppl     1.94 | tok/s    26306
step   3550/6000 | loss 0.6039 | ppl     1.83 | tok/s    25222
== eval step 3600 | train 0.6159 | val 8.3582 | val_ppl 4264.87 | 208.7s
step   3600/6000 | loss 0.6436 | ppl     1.90 | tok/s    24795
step   3650/6000 | loss 0.5965 | ppl     1.82 | tok/s    24257
step   3700/6000 | loss 0.5551 | ppl     1.74 | tok/s    24147
step   3750/6000 | loss 0.5677 | ppl     1.76 | tok/s    24687
== eval step 3800 | train 0.5574 | val 8.4446 | val_ppl 4650.07 | 214.4s
step   3800/6000 | loss 0.5219 | ppl     1.69 | tok/s    26234
step   3850/6000 | loss 0.5356 | ppl     1.71 | tok/s    27048
step   3900/6000 | loss 0.5537 | ppl     1.74 | tok/s    27199
step   3950/6000 | loss 0.5214 | ppl     1.68 | tok/s    24535
== eval step 4000 | train 0.5204 | val 8.5696 | val_ppl 5269.17 | 212.7s
step   4000/6000 | loss 0.4765 | ppl     1.61 | tok/s    22607
step   4050/6000 | loss 0.5263 | ppl     1.69 | tok/s    24465
step   4100/6000 | loss 0.5112 | ppl     1.67 | tok/s    23052
step   4150/6000 | loss 0.4696 | ppl     1.60 | tok/s    25647
== eval step 4200 | train 0.4750 | val 8.6744 | val_ppl 5851.31 | 212.8s
step   4200/6000 | loss 0.4821 | ppl     1.62 | tok/s    27204
step   4250/6000 | loss 0.4645 | ppl     1.59 | tok/s    26199
step   4300/6000 | loss 0.4257 | ppl     1.53 | tok/s    24815
step   4350/6000 | loss 0.4576 | ppl     1.58 | tok/s    24406
== eval step 4400 | train 0.4451 | val 8.7832 | val_ppl 6523.74 | 213.5s
step   4400/6000 | loss 0.4447 | ppl     1.56 | tok/s    24724
step   4450/6000 | loss 0.3917 | ppl     1.48 | tok/s    26052
step   4500/6000 | loss 0.3909 | ppl     1.48 | tok/s    25839
step   4550/6000 | loss 0.4365 | ppl     1.55 | tok/s    26638
== eval step 4600 | train 0.4223 | val 8.8633 | val_ppl 7067.77 | 202.6s
step   4600/6000 | loss 0.3770 | ppl     1.46 | tok/s    27212
step   4650/6000 | loss 0.4198 | ppl     1.52 | tok/s    25961
step   4700/6000 | loss 0.3972 | ppl     1.49 | tok/s    23522
step   4750/6000 | loss 0.4376 | ppl     1.55 | tok/s    22794
== eval step 4800 | train 0.3951 | val 8.9288 | val_ppl 7546.40 | 213.8s
step   4800/6000 | loss 0.4297 | ppl     1.54 | tok/s    27471
step   4850/6000 | loss 0.3995 | ppl     1.49 | tok/s    27849
step   4900/6000 | loss 0.3578 | ppl     1.43 | tok/s    26058
step   4950/6000 | loss 0.4073 | ppl     1.50 | tok/s    26956
== eval step 5000 | train 0.3671 | val 9.0055 | val_ppl 8147.80 | 201.6s
step   5000/6000 | loss 0.3740 | ppl     1.45 | tok/s    26307
step   5050/6000 | loss 0.3733 | ppl     1.45 | tok/s    25920
step   5100/6000 | loss 0.3577 | ppl     1.43 | tok/s    24874
step   5150/6000 | loss 0.3785 | ppl     1.46 | tok/s    23367
== eval step 5200 | train 0.3528 | val 9.0494 | val_ppl 8513.21 | 219.8s
step   5200/6000 | loss 0.3453 | ppl     1.41 | tok/s    23288
step   5250/6000 | loss 0.3462 | ppl     1.41 | tok/s    24318
step   5300/6000 | loss 0.3520 | ppl     1.42 | tok/s    23841
step   5350/6000 | loss 0.3639 | ppl     1.44 | tok/s    23641
== eval step 5400 | train 0.3492 | val 9.1251 | val_ppl 9183.30 | 224.8s
step   5400/6000 | loss 0.3337 | ppl     1.40 | tok/s    23349
step   5450/6000 | loss 0.3471 | ppl     1.41 | tok/s    24398
step   5500/6000 | loss 0.3544 | ppl     1.43 | tok/s    24319
step   5550/6000 | loss 0.3271 | ppl     1.39 | tok/s    24059
== eval step 5600 | train 0.3342 | val 9.2135 | val_ppl 10032.09 | 225.3s
step   5600/6000 | loss 0.3340 | ppl     1.40 | tok/s    22787
step   5650/6000 | loss 0.3131 | ppl     1.37 | tok/s    24054
step   5700/6000 | loss 0.3034 | ppl     1.35 | tok/s    23694
step   5750/6000 | loss 0.3333 | ppl     1.40 | tok/s    22530
== eval step 5800 | train 0.3236 | val 9.2819 | val_ppl 10742.09 | 231.7s
step   5800/6000 | loss 0.3281 | ppl     1.39 | tok/s    22477
step   5850/6000 | loss 0.3058 | ppl     1.36 | tok/s    22442
step   5900/6000 | loss 0.3129 | ppl     1.37 | tok/s    24185
step   5950/6000 | loss 0.2996 | ppl     1.35 | tok/s    24658
== eval step 6000 | train 0.3136 | val 9.3675 | val_ppl 11701.97 | 221.2s
Done. best_val=5.6320