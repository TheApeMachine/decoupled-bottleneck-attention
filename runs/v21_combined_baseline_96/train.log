File wiki.train.tokens could not be read as space-separated integers. Tokenizing as words...
Tokenized 2075677 tokens. Vocab size: 33278
Device: mps
Tokens: train 1,868,110 | val 207,567 | vocab 33,278
Uniform baseline loss log(V): 10.4127 (ppl ~ 33278)
== eval step 0 | train 10.4963 | val 10.4965 | val_ppl 36188.53 | 1.2s
   (new best) 10.4965
step      0/6000 | loss 10.4787 | ppl 35549.51 | tok/s     4915
step     50/6000 | loss 6.6145 | ppl   745.85 | tok/s   115666
step    100/6000 | loss 6.3414 | ppl   567.59 | tok/s   116947
step    150/6000 | loss 6.4260 | ppl   617.72 | tok/s   115779
== eval step 200 | train 6.0771 | val 6.3274 | val_ppl 559.73 | 19.2s
   (new best) 6.3274
step    200/6000 | loss 5.8680 | ppl   353.54 | tok/s   110144
step    250/6000 | loss 5.7462 | ppl   312.99 | tok/s   106071
step    300/6000 | loss 5.9799 | ppl   395.40 | tok/s   108569
step    350/6000 | loss 5.8656 | ppl   352.70 | tok/s   111357
== eval step 400 | train 5.6699 | val 6.0789 | val_ppl 436.54 | 19.8s
   (new best) 6.0789
step    400/6000 | loss 5.5406 | ppl   254.84 | tok/s   111515
step    450/6000 | loss 5.7492 | ppl   313.92 | tok/s   111828
step    500/6000 | loss 5.4777 | ppl   239.29 | tok/s   111961
step    550/6000 | loss 5.3617 | ppl   213.09 | tok/s   113384
== eval step 600 | train 5.4033 | val 5.8862 | val_ppl 360.05 | 19.8s
   (new best) 5.8862
step    600/6000 | loss 4.9387 | ppl   139.58 | tok/s   116217
step    650/6000 | loss 5.3861 | ppl   218.36 | tok/s   120192
step    700/6000 | loss 5.3524 | ppl   211.12 | tok/s   121573
step    750/6000 | loss 5.4205 | ppl   226.00 | tok/s   122510
== eval step 800 | train 5.1861 | val 5.6924 | val_ppl 296.60 | 25.3s
   (new best) 5.6924
step    800/6000 | loss 5.2639 | ppl   193.23 | tok/s   124900
step    850/6000 | loss 5.2854 | ppl   197.44 | tok/s   124835
step    900/6000 | loss 4.9887 | ppl   146.75 | tok/s   124635
step    950/6000 | loss 4.8176 | ppl   123.67 | tok/s   120173
== eval step 1000 | train 5.0018 | val 5.5850 | val_ppl 266.40 | 36.4s
   (new best) 5.5850
step   1000/6000 | loss 5.0626 | ppl   158.00 | tok/s   123481
step   1050/6000 | loss 4.9007 | ppl   134.39 | tok/s   119440
step   1100/6000 | loss 5.0962 | ppl   163.39 | tok/s   116153
step   1150/6000 | loss 4.7157 | ppl   111.69 | tok/s   117259
== eval step 1200 | train 4.6721 | val 5.5674 | val_ppl 261.75 | 40.5s
   (new best) 5.5674
step   1200/6000 | loss 4.7454 | ppl   115.05 | tok/s   116790
step   1250/6000 | loss 4.8901 | ppl   132.96 | tok/s   118730
step   1300/6000 | loss 4.6681 | ppl   106.49 | tok/s   123961
step   1350/6000 | loss 4.6133 | ppl   100.82 | tok/s   120848
== eval step 1400 | train 4.6511 | val 5.5616 | val_ppl 260.25 | 34.2s
   (new best) 5.5616
step   1400/6000 | loss 4.8030 | ppl   121.87 | tok/s   125195
step   1450/6000 | loss 4.6034 | ppl    99.82 | tok/s   124656
step   1500/6000 | loss 4.6569 | ppl   105.31 | tok/s   123202
step   1550/6000 | loss 4.7801 | ppl   119.11 | tok/s   124683
== eval step 1600 | train 4.6058 | val 5.4917 | val_ppl 242.68 | 28.6s
   (new best) 5.4917
step   1600/6000 | loss 4.8012 | ppl   121.66 | tok/s   124327
step   1650/6000 | loss 4.7449 | ppl   115.00 | tok/s   123397
step   1700/6000 | loss 4.6289 | ppl   102.40 | tok/s   124313
step   1750/6000 | loss 4.7837 | ppl   119.55 | tok/s   115479
== eval step 1800 | train 4.4639 | val 5.4800 | val_ppl 239.84 | 27.4s
   (new best) 5.4800
step   1800/6000 | loss 4.4473 | ppl    85.40 | tok/s   113519
step   1850/6000 | loss 4.1303 | ppl    62.19 | tok/s   120139
step   1900/6000 | loss 3.9270 | ppl    50.75 | tok/s   120197
step   1950/6000 | loss 4.1071 | ppl    60.77 | tok/s   116764
== eval step 2000 | train 4.3940 | val 5.4628 | val_ppl 235.77 | 26.7s
   (new best) 5.4628
step   2000/6000 | loss 4.4080 | ppl    82.10 | tok/s   119818
step   2050/6000 | loss 4.3246 | ppl    75.54 | tok/s   118815
step   2100/6000 | loss 4.4189 | ppl    83.01 | tok/s   119363
step   2150/6000 | loss 3.8297 | ppl    46.05 | tok/s   116875
== eval step 2200 | train 4.2337 | val 5.4313 | val_ppl 228.45 | 27.5s
   (new best) 5.4313
step   2200/6000 | loss 4.2785 | ppl    72.13 | tok/s   119675
step   2250/6000 | loss 4.3309 | ppl    76.01 | tok/s   118040
step   2300/6000 | loss 4.3329 | ppl    76.16 | tok/s   120740
step   2350/6000 | loss 4.3272 | ppl    75.73 | tok/s   124168
== eval step 2400 | train 4.1424 | val 5.4811 | val_ppl 240.11 | 24.2s
step   2400/6000 | loss 4.1471 | ppl    63.25 | tok/s   120776
step   2450/6000 | loss 4.1778 | ppl    65.22 | tok/s   120806
step   2500/6000 | loss 3.8045 | ppl    44.90 | tok/s   119314
step   2550/6000 | loss 4.1471 | ppl    63.25 | tok/s   119967
== eval step 2600 | train 4.0693 | val 5.4386 | val_ppl 230.12 | 24.8s
step   2600/6000 | loss 3.9550 | ppl    52.20 | tok/s   120334
step   2650/6000 | loss 3.8157 | ppl    45.41 | tok/s   120068
step   2700/6000 | loss 4.0257 | ppl    56.02 | tok/s   118965
step   2750/6000 | loss 4.0052 | ppl    54.88 | tok/s   119708
== eval step 2800 | train 3.8768 | val 5.5363 | val_ppl 253.73 | 25.0s
step   2800/6000 | loss 3.7975 | ppl    44.59 | tok/s   115250
step   2850/6000 | loss 3.8012 | ppl    44.75 | tok/s   118918
step   2900/6000 | loss 3.8835 | ppl    48.59 | tok/s   117162
step   2950/6000 | loss 3.9459 | ppl    51.72 | tok/s   118979
== eval step 3000 | train 3.7370 | val 5.3272 | val_ppl 205.86 | 25.7s
   (new best) 5.3272
step   3000/6000 | loss 3.7464 | ppl    42.37 | tok/s   117032
step   3050/6000 | loss 3.6336 | ppl    37.85 | tok/s   118605
step   3100/6000 | loss 3.6374 | ppl    37.99 | tok/s   114226
step   3150/6000 | loss 3.2310 | ppl    25.30 | tok/s   120399
== eval step 3200 | train 3.6418 | val 5.3814 | val_ppl 217.33 | 24.9s
step   3200/6000 | loss 4.3307 | ppl    76.00 | tok/s   120246
step   3250/6000 | loss 3.5965 | ppl    36.47 | tok/s   117626
step   3300/6000 | loss 3.1538 | ppl    23.42 | tok/s   118089
step   3350/6000 | loss 3.8759 | ppl    48.23 | tok/s   119462
== eval step 3400 | train 3.6416 | val 5.4943 | val_ppl 243.30 | 24.4s
step   3400/6000 | loss 3.3449 | ppl    28.36 | tok/s   124497
step   3450/6000 | loss 3.3813 | ppl    29.41 | tok/s   124821
step   3500/6000 | loss 3.4964 | ppl    33.00 | tok/s   124361
step   3550/6000 | loss 3.5995 | ppl    36.58 | tok/s   124946
== eval step 3600 | train 3.4889 | val 5.5212 | val_ppl 249.94 | 23.6s
step   3600/6000 | loss 3.6865 | ppl    39.90 | tok/s   124494
step   3650/6000 | loss 3.5470 | ppl    34.71 | tok/s   122324
step   3700/6000 | loss 3.6384 | ppl    38.03 | tok/s   121146
step   3750/6000 | loss 3.4976 | ppl    33.04 | tok/s   120142
== eval step 3800 | train 3.3924 | val 5.4542 | val_ppl 233.74 | 24.1s
step   3800/6000 | loss 3.8377 | ppl    46.42 | tok/s   122064
step   3850/6000 | loss 3.4706 | ppl    32.16 | tok/s   122283
step   3900/6000 | loss 3.8568 | ppl    47.31 | tok/s   124151
step   3950/6000 | loss 3.5446 | ppl    34.63 | tok/s   124600
== eval step 4000 | train 3.3431 | val 5.5588 | val_ppl 259.51 | 24.2s
step   4000/6000 | loss 3.2732 | ppl    26.40 | tok/s   124644
step   4050/6000 | loss 3.2134 | ppl    24.86 | tok/s   125135
step   4100/6000 | loss 3.1677 | ppl    23.75 | tok/s   123916
step   4150/6000 | loss 3.0125 | ppl    20.34 | tok/s   123476
== eval step 4200 | train 3.2616 | val 5.5976 | val_ppl 269.78 | 23.8s
step   4200/6000 | loss 3.1770 | ppl    23.98 | tok/s   124238
step   4250/6000 | loss 3.6548 | ppl    38.66 | tok/s   122093
step   4300/6000 | loss 3.2376 | ppl    25.47 | tok/s   123118
step   4350/6000 | loss 3.0366 | ppl    20.83 | tok/s   122445
== eval step 4400 | train 3.1597 | val 5.5393 | val_ppl 254.49 | 24.0s
step   4400/6000 | loss 2.4497 | ppl    11.58 | tok/s   124059
step   4450/6000 | loss 2.8229 | ppl    16.83 | tok/s   124268
step   4500/6000 | loss 3.2214 | ppl    25.06 | tok/s   123067
step   4550/6000 | loss 2.6627 | ppl    14.34 | tok/s   124880
== eval step 4600 | train 3.0827 | val 5.6875 | val_ppl 295.15 | 24.1s
step   4600/6000 | loss 2.9512 | ppl    19.13 | tok/s   125587
step   4650/6000 | loss 2.9053 | ppl    18.27 | tok/s   123729
step   4700/6000 | loss 3.2181 | ppl    24.98 | tok/s   124086
step   4750/6000 | loss 3.1164 | ppl    22.57 | tok/s   124321
== eval step 4800 | train 3.0022 | val 5.7001 | val_ppl 298.91 | 23.0s
step   4800/6000 | loss 3.2040 | ppl    24.63 | tok/s   122404
step   4850/6000 | loss 2.6238 | ppl    13.79 | tok/s   117965
step   4900/6000 | loss 2.5108 | ppl    12.32 | tok/s   120475
step   4950/6000 | loss 3.3454 | ppl    28.37 | tok/s   119835
== eval step 5000 | train 2.8592 | val 5.7043 | val_ppl 300.15 | 24.7s
step   5000/6000 | loss 2.5763 | ppl    13.15 | tok/s   120588
step   5050/6000 | loss 3.0444 | ppl    21.00 | tok/s   120472
step   5100/6000 | loss 2.5436 | ppl    12.72 | tok/s   120591
step   5150/6000 | loss 2.6028 | ppl    13.50 | tok/s   119724
== eval step 5200 | train 2.7736 | val 5.6608 | val_ppl 287.39 | 24.3s
step   5200/6000 | loss 2.9587 | ppl    19.27 | tok/s   119500
step   5250/6000 | loss 2.8406 | ppl    17.13 | tok/s   118584
step   5300/6000 | loss 2.5814 | ppl    13.22 | tok/s   117987
step   5350/6000 | loss 2.6079 | ppl    13.57 | tok/s   117588
== eval step 5400 | train 2.7130 | val 5.7235 | val_ppl 305.97 | 24.3s
step   5400/6000 | loss 2.3633 | ppl    10.63 | tok/s   120848
step   5450/6000 | loss 2.7774 | ppl    16.08 | tok/s   120823
step   5500/6000 | loss 2.7156 | ppl    15.11 | tok/s   120434
step   5550/6000 | loss 2.2143 | ppl     9.15 | tok/s   119241
== eval step 5600 | train 2.6444 | val 5.7922 | val_ppl 327.75 | 24.3s
step   5600/6000 | loss 2.4037 | ppl    11.06 | tok/s   119093
step   5650/6000 | loss 2.2494 | ppl     9.48 | tok/s   119456
step   5700/6000 | loss 2.0588 | ppl     7.84 | tok/s   117849
step   5750/6000 | loss 2.6807 | ppl    14.60 | tok/s   115573
== eval step 5800 | train 2.6283 | val 5.7353 | val_ppl 309.60 | 24.5s
step   5800/6000 | loss 2.4939 | ppl    12.11 | tok/s   117533
step   5850/6000 | loss 2.6235 | ppl    13.78 | tok/s   117649
step   5900/6000 | loss 1.9104 | ppl     6.76 | tok/s   120485
step   5950/6000 | loss 2.5265 | ppl    12.51 | tok/s   121037
== eval step 6000 | train 2.5488 | val 5.8948 | val_ppl 363.15 | 24.2s
Done. best_val=5.3272