2025-12-19 00:40:50,711 INFO    MainThread:60689 [wandb_setup.py:_flush():80] Current SDK version is 0.23.1
2025-12-19 00:40:50,711 INFO    MainThread:60689 [wandb_setup.py:_flush():80] Configure stats pid to 60689
2025-12-19 00:40:50,711 INFO    MainThread:60689 [wandb_setup.py:_flush():80] Loading settings from /Users/theapemachine/.config/wandb/settings
2025-12-19 00:40:50,711 INFO    MainThread:60689 [wandb_setup.py:_flush():80] Loading settings from /Users/theapemachine/go/src/github.com/theapemachine/experiments/wandb/settings
2025-12-19 00:40:50,711 INFO    MainThread:60689 [wandb_setup.py:_flush():80] Loading settings from environment variables
2025-12-19 00:40:50,711 INFO    MainThread:60689 [wandb_init.py:setup_run_log_directory():714] Logging user logs to runs/1b_train_decoupled_fast/wandb/run-20251219_004050-ifojga3r/logs/debug.log
2025-12-19 00:40:50,712 INFO    MainThread:60689 [wandb_init.py:setup_run_log_directory():715] Logging internal logs to runs/1b_train_decoupled_fast/wandb/run-20251219_004050-ifojga3r/logs/debug-internal.log
2025-12-19 00:40:50,712 INFO    MainThread:60689 [wandb_init.py:init():841] calling init triggers
2025-12-19 00:40:50,712 INFO    MainThread:60689 [wandb_init.py:init():846] wandb.init called with sweep_config: {}
config: {'args': {'size': '1b', 'exp': 'train_decoupled_fast', 'run_root': 'runs', 'run_tag': None, 'print_config': False, 'data': 'fineweb_1b.npy', 'data_format': 'npy', 'data_dtype': 'uint16', 'vocab_size': 50257, 'val_frac': 0.1, 'out_dir': 'runs/1b_train_decoupled_fast', 'seed': 1337, 'device': None, 'compile': True, 'compile_mode': 'reduce-overhead', 'amp': True, 'amp_dtype': 'bf16', 'param_dtype': 'bf16', 'matmul_precision': 'high', 'layers': 18, 'd_model': 2048, 'n_head': 16, 'd_ff': 8192, 'block': 4096, 'embed_dim': 2048, 'attn_mode': 'decoupled', 'kv_head': None, 'attn_dim': 768, 'sem_dim': 256, 'geo_dim': 512, 'no_decoupled_gate': False, 'no_rope': False, 'rope': False, 'rope_base': 10000.0, 'tie_qk': True, 'no_tie_qk': False, 'null_attn': False, 'no_null_attn': False, 'no_learned_temp': False, 'mlp': 'swiglu', 'dropout': 0.0, 'steps': 20000, 'legacy_micro_steps': False, 'batch_size': 8, 'grad_accum': 8, 'batch_by_seq': None, 'batch_schedule': None, 'train_seq_len': 2048, 'seq_schedule': '512@0,1024@200,2048@600,3072@1200,4096@2000', 'eval_seq_len': 512, 'grad_checkpoint': True, 'train_autotune': 'off', 'train_autotune_gbs': 64, 'train_autotune_seq_lens': '512', 'train_autotune_batch_sizes': '8,16,24,32,48,64', 'train_autotune_warmup': 0, 'train_autotune_iters': 1, 'train_autotune_max_driver_gb': 0.0, 'optimizer': 'lion', 'adam_betas': '0.9,0.95', 'adam_eps': 1e-08, 'lion_betas': '0.9,0.99', 'lr': 0.0001, 'lr_schedule': 'cosine', 'warmup_steps': 200, 'min_lr': 0.0, 'opt_foreach': False, 'opt_fused': False, 'weight_decay': 0.1, 'grad_clip': 1.0, 'nan_policy': 'reduce_lr', 'nan_lr_decay': 0.5, 'save_every': 0, 'eval_every': 200, 'eval_iters': 5, 'log_every': 10, 'instrument': 'basic', 'analysis_every': 0, 'analysis_max_tokens': 256, 'analysis_layers': '0,-1', 'analysis_heads': '0', 'analysis_topk': 8, 'analysis_local_window': 32, 'analysis_save_scores': False, 'live': 'auto', 'live_update_every': 1, 'sync_timing': False, 'live_plot': False, 'tb': False, 'wandb': True, 'wandb_project': '1b_decoupled', 'wandb_entity': 'p4n0p71c0n', 'wandb_name': '1b_decoupled', 'wandb_group': None, 'wandb_tags': None, 'wandb_mode': 'online', 'mode': 'train', 'ckpt': None, 'prompt_tokens': '0', 'max_new_tokens': 50, 'temperature': 1.0, 'top_k': None, 'draft_ckpt': None, 'spec_k': 4, 'spec_method': 'reject_sampling', 'spec_extra_token': False, 'spec_disable_below_accept': 0.0, 'kv_cache': 'fp16', 'kv_qblock': 32, 'kv_residual': 128, 'kv_decode_block': 1024, 'kv_fused': 'auto', 'self_opt': 'none', 'self_opt_cache': None, 'self_opt_decode_blocks': '256,512,1024,2048', 'self_opt_block_n': '128', 'self_opt_warps': '4,8', 'self_opt_stages': '2,3', 'self_opt_warmup': 1, 'self_opt_iters': 3, 'self_opt_interval': 256, 'self_opt_hysteresis': 0.03, 'self_opt_verbose': False, 'self_opt_verify': False, 'self_opt_verify_tol': 0.005, 'self_opt_scope': 'all', 'self_opt_residuals': '0,32,64,128', 'self_opt_qblocks': '16,32,64', 'self_opt_k_sem_kinds': 'q4_0,nf4,q8_0,fp16', 'self_opt_k_geo_kinds': 'q8_0,q4_0,fp16', 'self_opt_v_kinds': 'q4_0,q8_0,fp16', 'self_opt_mem_budget_mb': None, 'self_opt_mem_overhead_frac': 0.1, 'self_opt_policy_prefix_len': None, 'self_opt_policy_warmup': 1, 'self_opt_policy_iters': 3, 'self_opt_policy_hysteresis': 0.02, 'self_opt_prefer_low_mem_within': 0.02, 'self_opt_policy_quality': False, 'self_opt_calib_tokens': None, 'self_opt_calib_prefill': 128, 'self_opt_calib_decode': 32, 'self_opt_quality_tol': 0.5, 'self_opt_quality_delta_nll_tol': 0.02, 'self_opt_quality_ppl_ratio_tol': 1.02, 'self_opt_quality_kl_tol': None, 'self_opt_quality_kl': False, 'self_opt_layerwise_cache': False, 'kv_cache_k': None, 'kv_cache_v': None, 'kv_cache_k_sem': None, 'kv_cache_k_geo': None, 'kv_qblock_k': None, 'kv_qblock_v': None, 'kv_qblock_k_sem': None, 'kv_qblock_k_geo': None, 'tokenizer': 'word'}, 'config': {'vocab_size': 50257, 'block_size': 4096, 'n_layer': 18, 'n_head': 16, 'kv_head': None, 'd_model': 2048, 'd_ff': 8192, 'embed_dim': 2048, 'attn_mode': 'decoupled', 'attn_dim': 768, 'sem_dim': 256, 'geo_dim': 512, 'decoupled_gate': True, 'rope': True, 'rope_base': 10000.0, 'tie_qk': True, 'null_attn': False, 'learned_temp': True, 'mlp': 'swiglu', 'dropout': 0.0}, '_wandb': {}}
2025-12-19 00:40:50,712 INFO    MainThread:60689 [wandb_init.py:init():889] starting backend
2025-12-19 00:40:51,419 INFO    MainThread:60689 [wandb_init.py:init():892] sending inform_init request
2025-12-19 00:40:51,458 INFO    MainThread:60689 [wandb_init.py:init():900] backend started and connected
2025-12-19 00:40:51,469 INFO    MainThread:60689 [wandb_init.py:init():970] updated telemetry
2025-12-19 00:40:51,509 INFO    MainThread:60689 [wandb_init.py:init():994] communicating run to backend with 90.0 second timeout
2025-12-19 00:40:52,582 INFO    MainThread:60689 [wandb_init.py:init():1041] starting run threads in backend
2025-12-19 00:40:52,623 INFO    MainThread:60689 [wandb_run.py:_console_start():2521] atexit reg
2025-12-19 00:40:52,623 INFO    MainThread:60689 [wandb_run.py:_redirect():2369] redirect: wrap_raw
2025-12-19 00:40:52,623 INFO    MainThread:60689 [wandb_run.py:_redirect():2438] Wrapping output streams.
2025-12-19 00:40:52,623 INFO    MainThread:60689 [wandb_run.py:_redirect():2461] Redirects installed.
2025-12-19 00:40:52,624 INFO    MainThread:60689 [wandb_init.py:init():1081] run started, returning control to user process
2025-12-19 00:42:12,978 INFO    wandb-AsyncioManager-main:60689 [service_client.py:_forward_responses():80] Reached EOF.
2025-12-19 00:42:12,978 INFO    wandb-AsyncioManager-main:60689 [mailbox.py:close():137] Closing mailbox, abandoning 1 handles.
