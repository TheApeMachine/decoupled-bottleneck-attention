{"type":"meta","step":0,"env":{"python":"3.12.12","torch":"2.9.1","device":"mps","cuda_available":false},"argv":["/Users/theapemachine/go/src/github.com/theapemachine/experiments/production/cli.py","--mode","train","--size","1b","--exp","train_decoupled_fast","--data","fineweb_1b.npy","--data-format","npy","--vocab-size","50257","--block","4096","--train-seq-len","2048","--seq-schedule","512@0,1024@200,2048@600,3072@1200,4096@2000","--steps","20000","--log-every","10","--eval-every","200","--eval-iters","5","--eval-seq-len","512","--analysis-every","0","--instrument","basic","--batch-size","8","--grad-accum","8","--wandb","--wandb-entity","p4n0p71c0n","--wandb-project","1b_decoupled","--wandb-name","1b_decoupled","--wandb-mode","online"],"args":{"size":"1b","exp":"train_decoupled_fast","run_root":"runs","run_tag":null,"print_config":false,"data":"fineweb_1b.npy","data_format":"npy","data_dtype":"uint16","vocab_size":50257,"val_frac":0.1,"out_dir":"runs/1b_train_decoupled_fast","seed":1337,"device":null,"compile":true,"no_compile":false,"compile_mode":"reduce-overhead","amp":true,"no_amp":false,"amp_dtype":"bf16","param_dtype":"bf16","matmul_precision":"high","layers":18,"d_model":2048,"n_head":16,"d_ff":8192,"block":4096,"embed_dim":2048,"attn_mode":"decoupled","kv_head":null,"attn_dim":768,"sem_dim":256,"geo_dim":512,"no_decoupled_gate":false,"no_rope":false,"rope":false,"rope_base":10000.0,"tie_qk":true,"no_tie_qk":false,"null_attn":false,"no_null_attn":false,"no_learned_temp":false,"mlp":"swiglu","dropout":0.0,"steps":20000,"legacy_micro_steps":false,"batch_size":8,"grad_accum":8,"batch_by_seq":null,"batch_schedule":null,"train_seq_len":2048,"seq_schedule":"512@0,1024@200,2048@600,3072@1200,4096@2000","eval_seq_len":512,"grad_checkpoint":true,"no_grad_checkpoint":false,"train_autotune":"off","train_autotune_gbs":64,"train_autotune_seq_lens":"512","train_autotune_batch_sizes":"8,16,24,32,48,64","train_autotune_warmup":0,"train_autotune_iters":1,"train_autotune_max_driver_gb":0.0,"optimizer":"lion","adam_betas":"0.9,0.95","adam_eps":1e-08,"lion_betas":"0.9,0.99","lr":0.0001,"lr_schedule":"cosine","warmup_steps":200,"min_lr":0.0,"opt_foreach":false,"opt_fused":false,"weight_decay":0.1,"grad_clip":1.0,"nan_policy":"reduce_lr","nan_lr_decay":0.5,"save_every":0,"eval_every":200,"eval_iters":5,"log_every":10,"instrument":"basic","analysis_every":0,"analysis_max_tokens":256,"analysis_layers":"0,-1","analysis_heads":"0","analysis_topk":8,"analysis_local_window":32,"analysis_save_scores":false,"live":"auto","live_update_every":1,"sync_timing":false,"live_plot":false,"tb":false,"wandb":true,"wandb_project":"1b_decoupled","wandb_entity":"p4n0p71c0n","wandb_name":"1b_decoupled","wandb_group":null,"wandb_tags":null,"wandb_mode":"online","mode":"train","ckpt":null,"prompt_tokens":"0","max_new_tokens":50,"temperature":1.0,"top_k":null,"draft_ckpt":null,"spec_k":4,"spec_method":"reject_sampling","spec_extra_token":false,"spec_disable_below_accept":0.0,"kv_cache":"fp16","kv_qblock":32,"kv_residual":128,"kv_decode_block":1024,"kv_fused":"auto","self_opt":"none","self_opt_cache":null,"self_opt_decode_blocks":"256,512,1024,2048","self_opt_block_n":"128","self_opt_warps":"4,8","self_opt_stages":"2,3","self_opt_warmup":1,"self_opt_iters":3,"self_opt_interval":256,"self_opt_hysteresis":0.03,"self_opt_verbose":false,"self_opt_verify":false,"self_opt_verify_tol":0.005,"self_opt_scope":"all","self_opt_residuals":"0,32,64,128","self_opt_qblocks":"16,32,64","self_opt_k_sem_kinds":"q4_0,nf4,q8_0,fp16","self_opt_k_geo_kinds":"q8_0,q4_0,fp16","self_opt_v_kinds":"q4_0,q8_0,fp16","self_opt_mem_budget_mb":null,"self_opt_mem_overhead_frac":0.1,"self_opt_policy_prefix_len":null,"self_opt_policy_warmup":1,"self_opt_policy_iters":3,"self_opt_policy_hysteresis":0.02,"self_opt_prefer_low_mem_within":0.02,"self_opt_policy_quality":false,"self_opt_calib_tokens":null,"self_opt_calib_prefill":128,"self_opt_calib_decode":32,"self_opt_quality_tol":0.5,"self_opt_quality_delta_nll_tol":0.02,"self_opt_quality_ppl_ratio_tol":1.02,"self_opt_quality_kl_tol":null,"self_opt_quality_kl":false,"self_opt_layerwise_cache":false,"kv_cache_k":null,"kv_cache_v":null,"kv_cache_k_sem":null,"kv_cache_k_geo":null,"kv_qblock_k":null,"kv_qblock_v":null,"kv_qblock_k_sem":null,"kv_qblock_k_geo":null,"tokenizer":"word"},"config":{"vocab_size":50257,"block_size":4096,"n_layer":18,"n_head":16,"kv_head":null,"d_model":2048,"d_ff":8192,"embed_dim":2048,"attn_mode":"decoupled","attn_dim":768,"sem_dim":256,"geo_dim":512,"decoupled_gate":true,"rope":true,"rope_base":10000.0,"tie_qk":true,"null_attn":false,"learned_temp":true,"mlp":"swiglu","dropout":0.0},"wall_time":"2025-12-20T10:59:01+01:00"}
{"type":"train","step":1,"loss":11.243401527404785,"ppl":76374.2997155571,"lr":5e-07,"tok_s":1285.6411334005322,"seq_len":512,"gbs":64,"ms_step":25487.672375049442,"ms_fwd":4437.9347920184955,"ms_bwd":15055.59687607456,"ms_opt":770.9098330233246,"mps_mem_alloc_bytes":7449845248.0,"mps_mem_driver_bytes":15183708160.0,"wall_time":"2025-12-20T10:59:29+01:00"}
{"type":"train","step":10,"loss":11.14329719543457,"ppl":69099.11453607903,"lr":5e-06,"tok_s":1082.9439662242285,"seq_len":512,"gbs":64,"ms_step":30258.259911866237,"ms_fwd":5200.08774566102,"ms_bwd":17963.969916557995,"ms_opt":692.765106447041,"mps_mem_alloc_bytes":7449845248.0,"mps_mem_driver_bytes":18488819712.0,"wall_time":"2025-12-20T11:04:02+01:00"}
