{"type":"meta","step":0,"env":{"python":"3.12.12","torch":"2.9.1","device":"mps","cuda_available":false},"argv":["main.py","--mode","train","--exp","paper_baseline","--data","fineweb_100m.npy","--out-dir","runs/mac_fw100m_l12_baseline_s1337","--seed","1337","--steps","6000"],"args":{"mode":"train","exp":"paper_baseline","result":null,"size":null,"data":"fineweb_100m.npy","ckpt":null,"out_dir":"runs/mac_fw100m_l12_baseline_s1337","resume":false,"resume_path":null,"seed":1337,"steps":6000,"prompt_tokens":"0","max_new_tokens":50,"temperature":1.0,"top_k":null,"wandb":true,"device_type":"mps","exp_source":"exp","layers":12,"instrument":"rich","live_plot":false,"tb":false,"wandb_project":"production","wandb_entity":"p4n0p71c0n","wandb_mode":"auto","wandb_name":null,"wandb_group":null,"wandb_tags":null,"kv_cache":"fp16","kv_qblock":32,"kv_residual":128,"kv_decode_block":1024,"kv_fused":"auto","dataset_tokens":100000000,"dataset_tokens_source":"filename","tokens_per_param":20.0,"target_params":5000000,"target_params_source":"dataset_tokens/20","layers_source":"out_dir","tokenizer":"tiktoken","val_frac":0.1,"data_format":"auto","data_dtype":"int64","d_model":256,"n_head":2,"d_ff":1024,"embed_dim":256,"attn_mode":"standard","attn_dim":256,"sem_dim":0,"geo_dim":0,"kv_head":null,"rope_base":10000.0,"tie_qk":false,"null_attn":false,"no_rope":false,"no_decoupled_gate":false,"no_learned_temp":false,"mlp":"swiglu","dropout":0.0,"block":512,"optimizer":"adamw","weight_decay":0.1,"lr":0.0005095939393902741,"min_lr":5.095939393902742e-05,"lr_schedule":"cosine","warmup_steps":0,"adam_eps":1e-08,"adam_betas":"0.9,0.95","lion_betas":"0.9,0.99","opt_foreach":false,"opt_fused":false,"eval_iters":20,"eval_every":0,"save_every":0,"log_every":10,"selfopt_summary":{"mode":"train","device_type":"mps","data":"fineweb_100m.npy","exp":"paper_baseline","exp_source":"exp","dataset_tokens":100000000,"dataset_tokens_source":"filename","target_params":5000000,"target_params_source":"dataset_tokens/20","tokens_per_param":20.0,"layers":12,"layers_source":"out_dir","block":512,"d_model":256,"n_head":2,"head_dim":128,"d_ff":1024,"embed_dim":256,"attn_mode":"standard","attn_dim":256,"sem_dim":0,"geo_dim":0,"rope":true,"tie_qk":false,"null_attn":false,"optimizer":"adamw","lr":0.0005095939393902741,"weight_decay":0.1,"lr_schedule":"cosine","warmup_steps":0,"min_lr":5.095939393902742e-05,"steps":6000,"out_dir":"runs/mac_fw100m_l12_baseline_s1337"},"vocab_size":50257},"config":{"device":"mps","vocab_size":50257,"block_size":512,"head_policy":"standard","n_layer":12,"n_head":4,"kv_head":null,"d_model":128,"dim_multiplier":0,"d_ff":600,"embed_dim":32,"attn_mode":"standard","attn_dim":104,"head_dim":32,"sem_dim":104,"geo_dim":0,"decoupled_gate":true,"rope":true,"rope_base":10000.0,"tie_qk":false,"null_attn":false,"learned_temp":true,"mlp":"swiglu","dropout":0.0},"wall_time":"2025-12-22T15:51:11+01:00"}
{"type":"selfopt_precision","device":"mps","param_dtype":"torch.float32","amp_enabled":true,"amp_dtype":"torch.bfloat16","dt_s":0.027100584004074335,"wall_time":"2025-12-22T15:51:14+01:00"}
{"type":"selfopt_batch_plan","device":"mps","train_seq_len":512,"seq_lens":[512],"plan":{"512":[8,37]},"dt_s":0.00014650006778538227,"wall_time":"2025-12-22T15:51:14+01:00"}
{"type":"selfopt_compile_plan","device":"mps","enabled":false,"mode":"reduce-overhead","train_seq_len":512,"batch_size":8,"grad_accum":37,"dt_s":7.54169886931777e-05,"wall_time":"2025-12-22T15:51:14+01:00"}
{"type":"selfopt_runtime_plan","device":"mps","train_seq_len":512,"eval_seq_len":512,"plan":{"param_dtype":"torch.float32","amp_enabled":true,"amp_dtype":"torch.bfloat16","train_seq_len":512,"eval_seq_len":512,"batch_plan":{"by_seq":{"512":[8,37]},"target_gbs":0,"warmup":1,"iters":2},"compile_plan":{"enabled":false,"mode":"reduce-overhead","warmup":1,"iters":2,"hysteresis":0.03},"metrics":{"t_precision_s":0.027100584004074335,"t_batch_tune_s":0.00014650006778538227,"t_compile_tune_s":7.54169886931777e-05}},"wall_time":"2025-12-22T15:51:14+01:00"}
{"type":"train","step":0,"loss":10.817891120910645,"lr":5.095939393902741e-06,"tok_s":41492.56311371723,"seq_len":512.0,"gbs":151552.0,"ms_step":3652.5099590653554,"wall_time":"2025-12-22T15:51:18+01:00"}
{"type":"train","step":10,"loss":10.796287536621094,"lr":5.605533333293016e-05,"tok_s":43246.46134475145,"seq_len":512.0,"gbs":151552.0,"ms_step":3504.379209014587,"wall_time":"2025-12-22T15:51:53+01:00"}
{"type":"train","step":20,"loss":10.787447929382324,"lr":0.00010701472727195757,"tok_s":42238.856533397426,"seq_len":512.0,"gbs":151552.0,"ms_step":3587.975916918367,"wall_time":"2025-12-22T15:52:29+01:00"}
