{"type":"meta","step":0,"env":{"time":"2025-12-16T14:16:39+01:00","python":"3.12.12 (main, Oct  9 2025, 11:07:00) [Clang 17.0.0 (clang-1700.0.13.3)]","platform":"macOS-15.6-arm64-arm-64bit","torch":"2.9.1","device":"mps","triton_available":false},"argv":["v27_transformer_decoupled_bottleneck_instrumented.py","--mode","train","--data","fineweb_100m.tokens","--data-format","text","--size","tiny","--exp","paper_bottleneck","--live-plot"],"args":{"size":"tiny","exp":"paper_bottleneck","run_root":"runs","run_tag":null,"print_config":false,"data":"fineweb_100m.tokens","data_format":"text","data_dtype":"uint16","vocab_size":null,"val_frac":0.1,"out_dir":"runs/tiny_bottleneck","seed":1337,"device":null,"compile":false,"compile_mode":"default","amp":false,"amp_dtype":"bf16","layers":6,"d_model":512,"n_head":8,"d_ff":2048,"block":1024,"embed_dim":512,"attn_mode":"bottleneck","kv_head":null,"attn_dim":96,"sem_dim":32,"geo_dim":64,"no_rope":false,"rope":false,"rope_base":10000.0,"tie_qk":false,"no_tie_qk":false,"null_attn":true,"no_null_attn":false,"no_learned_temp":false,"mlp":"swiglu","dropout":0.0,"steps":6000,"batch_size":16,"lr":0.0003,"weight_decay":0.1,"grad_clip":1.0,"eval_every":200,"eval_iters":20,"log_every":100,"instrument":"full","analysis_every":100,"analysis_max_tokens":256,"analysis_layers":"0,-1","analysis_heads":"0","analysis_topk":8,"analysis_local_window":32,"analysis_save_scores":false,"live_plot":true,"tb":false,"mode":"train","ckpt":null,"prompt_tokens":"0","max_new_tokens":50,"temperature":1.0,"top_k":null,"kv_cache":"fp16","kv_qblock":32,"kv_residual":128,"kv_decode_block":1024,"kv_fused":"auto","self_opt":"none","self_opt_cache":null,"self_opt_decode_blocks":"256,512,1024,2048","self_opt_block_n":"128","self_opt_warps":"4,8","self_opt_stages":"2,3","self_opt_warmup":1,"self_opt_iters":3,"self_opt_interval":256,"self_opt_hysteresis":0.03,"self_opt_verbose":false,"self_opt_verify":false,"self_opt_verify_tol":0.005,"self_opt_scope":"all","self_opt_residuals":"0,32,64,128","self_opt_qblocks":"16,32,64","self_opt_k_sem_kinds":"q4_0,nf4,q8_0,fp16","self_opt_k_geo_kinds":"q8_0,q4_0,fp16","self_opt_v_kinds":"q4_0,q8_0,fp16","self_opt_mem_budget_mb":null,"self_opt_mem_overhead_frac":0.1,"self_opt_policy_prefix_len":null,"self_opt_policy_warmup":1,"self_opt_policy_iters":3,"self_opt_policy_hysteresis":0.02,"self_opt_prefer_low_mem_within":0.02,"self_opt_policy_quality":false,"self_opt_calib_tokens":null,"self_opt_calib_prefill":64,"self_opt_calib_decode":8,"self_opt_quality_tol":0.5,"kv_cache_k":null,"kv_cache_v":null,"kv_cache_k_sem":null,"kv_cache_k_geo":null,"kv_qblock_k":null,"kv_qblock_v":null,"kv_qblock_k_sem":null,"kv_qblock_k_geo":null,"tokenizer":"word"},"config":{"vocab_size":50257,"block_size":1024,"n_layer":6,"n_head":8,"kv_head":null,"d_model":512,"d_ff":2048,"embed_dim":512,"attn_mode":"bottleneck","attn_dim":96,"sem_dim":32,"geo_dim":64,"rope":true,"rope_base":10000.0,"tie_qk":false,"null_attn":true,"learned_temp":true,"mlp":"swiglu","dropout":0.0},"wall_time":"2025-12-16T14:16:39+01:00"}
{"type":"mem","step":0,"kv_ctx_bytes":2359296,"kv_128k_bytes":294912000,"data_format":"text","data_dtype":"uint16","n_tokens_total":100002129,"n_tokens_train":90001916,"n_tokens_val":10000213,"vocab_size":50257,"wall_time":"2025-12-16T14:16:40+01:00"}
{"type":"eval","step":0,"train_loss":10.922252559661866,"val_loss":10.92243824005127,"val_ppl":55405.72684527974,"wall_time":"2025-12-16T14:16:53+01:00"}
{"type":"analysis","step":0,"error":"shape '[1, 8, 256, -1]' is invalid for input of size 63360","wall_time":"2025-12-16T14:16:53+01:00"}
{"type":"train","step":0,"loss":10.92303466796875,"ppl":55438.782224154085,"tok_s":16434.47140746105,"grad_norm_embed":1.0967116992385204,"grad_norm_attn":1.040273394564449,"grad_norm_ffn":1.4381893341235858,"grad_norm_attn_sem":0.0,"grad_norm_attn_geo":0.0,"grad_clip_total_norm":2.0911402702331543,"wall_time":"2025-12-16T14:16:54+01:00"}
{"type":"analysis","step":100,"error":"shape '[1, 8, 256, -1]' is invalid for input of size 63360","wall_time":"2025-12-16T14:18:28+01:00"}
{"type":"train","step":100,"loss":6.653390407562256,"ppl":775.4088259053658,"tok_s":17323.14903629494,"grad_norm_embed":0.4223035119604641,"grad_norm_attn":0.39252007154058205,"grad_norm_ffn":0.3070394443690636,"grad_norm_attn_sem":0.0,"grad_norm_attn_geo":0.0,"grad_clip_total_norm":0.6543287038803101,"wall_time":"2025-12-16T14:18:29+01:00"}
{"type":"eval","step":200,"train_loss":6.3285695791244505,"val_loss":6.291618680953979,"val_ppl":540.0267530163413,"wall_time":"2025-12-16T14:20:26+01:00"}
{"type":"analysis","step":200,"error":"shape '[1, 8, 256, -1]' is invalid for input of size 63360","wall_time":"2025-12-16T14:20:26+01:00"}
{"type":"train","step":200,"loss":6.176434516906738,"ppl":481.2729231113327,"tok_s":15980.591920050741,"grad_norm_embed":0.39247980357405843,"grad_norm_attn":0.3330410008408149,"grad_norm_ffn":0.3255629138966902,"grad_norm_attn_sem":0.0,"grad_norm_attn_geo":0.0,"grad_clip_total_norm":0.6097524762153625,"wall_time":"2025-12-16T14:20:27+01:00"}
{"type":"analysis","step":300,"error":"shape '[1, 8, 256, -1]' is invalid for input of size 63360","wall_time":"2025-12-16T14:22:09+01:00"}
{"type":"train","step":300,"loss":6.112176895141602,"ppl":451.3201231523173,"tok_s":16028.302862089384,"grad_norm_embed":0.435572020484811,"grad_norm_attn":0.4486252739547867,"grad_norm_ffn":0.4094254008031495,"grad_norm_attn_sem":0.0,"grad_norm_attn_geo":0.0,"grad_clip_total_norm":0.7484790682792664,"wall_time":"2025-12-16T14:22:10+01:00"}
{"type":"eval","step":400,"train_loss":5.8947659730911255,"val_loss":5.819221830368042,"val_ppl":336.70993421103077,"wall_time":"2025-12-16T14:24:13+01:00"}
{"type":"analysis","step":400,"error":"shape '[1, 8, 256, -1]' is invalid for input of size 63360","wall_time":"2025-12-16T14:24:13+01:00"}
{"type":"train","step":400,"loss":6.0091423988342285,"ppl":407.13401190844195,"tok_s":15247.53040568092,"grad_norm_embed":0.39809189561501357,"grad_norm_attn":0.49243367984059044,"grad_norm_ffn":0.40258587946022195,"grad_norm_attn_sem":0.0,"grad_norm_attn_geo":0.0,"grad_clip_total_norm":0.7517595887184143,"wall_time":"2025-12-16T14:24:14+01:00"}
{"type":"analysis","step":500,"error":"shape '[1, 8, 256, -1]' is invalid for input of size 63360","wall_time":"2025-12-16T14:25:52+01:00"}
{"type":"train","step":500,"loss":5.813055038452148,"ppl":334.6399033955382,"tok_s":16561.755845415857,"grad_norm_embed":0.34194740250531447,"grad_norm_attn":0.4259849278398007,"grad_norm_ffn":0.3678517876549735,"grad_norm_attn_sem":0.0,"grad_norm_attn_geo":0.0,"grad_clip_total_norm":0.6595320105552673,"wall_time":"2025-12-16T14:25:53+01:00"}
{"type":"eval","step":600,"train_loss":5.59790072441101,"val_loss":5.553228044509888,"val_ppl":258.06927187170686,"wall_time":"2025-12-16T14:27:48+01:00"}
{"type":"analysis","step":600,"error":"shape '[1, 8, 256, -1]' is invalid for input of size 63360","wall_time":"2025-12-16T14:27:48+01:00"}
{"type":"train","step":600,"loss":5.501053333282471,"ppl":244.94981021229592,"tok_s":16296.070963896627,"grad_norm_embed":0.3620304190305509,"grad_norm_attn":0.4114586783226849,"grad_norm_ffn":0.40424667440642903,"grad_norm_attn_sem":0.0,"grad_norm_attn_geo":0.0,"grad_clip_total_norm":0.6818071007728577,"wall_time":"2025-12-16T14:27:49+01:00"}
{"type":"analysis","step":700,"error":"shape '[1, 8, 256, -1]' is invalid for input of size 63360","wall_time":"2025-12-16T14:29:31+01:00"}
{"type":"train","step":700,"loss":5.520668029785156,"ppl":249.8018565439,"tok_s":16051.194491830904,"grad_norm_embed":0.39219063761394507,"grad_norm_attn":0.41135127160947504,"grad_norm_ffn":0.42950746980482024,"grad_norm_attn_sem":0.0,"grad_norm_attn_geo":0.0,"grad_clip_total_norm":0.7131774425506592,"wall_time":"2025-12-16T14:29:32+01:00"}
{"type":"eval","step":800,"train_loss":5.408497786521911,"val_loss":5.38742949962616,"val_ppl":218.64064673946433,"wall_time":"2025-12-16T14:31:29+01:00"}
{"type":"analysis","step":800,"error":"shape '[1, 8, 256, -1]' is invalid for input of size 63360","wall_time":"2025-12-16T14:31:29+01:00"}
{"type":"train","step":800,"loss":5.0508527755737305,"ppl":156.1555733810025,"tok_s":15894.773856632008,"grad_norm_embed":0.3250846101590249,"grad_norm_attn":0.4989548244691833,"grad_norm_ffn":0.39397019325214994,"grad_norm_attn_sem":0.0,"grad_norm_attn_geo":0.0,"grad_clip_total_norm":0.7152763605117798,"wall_time":"2025-12-16T14:31:30+01:00"}
{"type":"analysis","step":900,"error":"shape '[1, 8, 256, -1]' is invalid for input of size 63360","wall_time":"2025-12-16T14:33:14+01:00"}
{"type":"train","step":900,"loss":5.379746913909912,"ppl":216.967357055629,"tok_s":15698.07225839304,"grad_norm_embed":0.33638160758827423,"grad_norm_attn":0.36614622747502645,"grad_norm_ffn":0.39420867529528647,"grad_norm_attn_sem":0.0,"grad_norm_attn_geo":0.0,"grad_clip_total_norm":0.6352564096450806,"wall_time":"2025-12-16T14:33:15+01:00"}
{"type":"eval","step":1000,"train_loss":5.28838529586792,"val_loss":5.205180025100708,"val_ppl":182.21367285107846,"wall_time":"2025-12-16T14:35:20+01:00"}
{"type":"analysis","step":1000,"error":"shape '[1, 8, 256, -1]' is invalid for input of size 63360","wall_time":"2025-12-16T14:35:20+01:00"}
{"type":"train","step":1000,"loss":5.182251930236816,"ppl":178.0833911580106,"tok_s":14952.84731786579,"grad_norm_embed":0.3746715537806852,"grad_norm_attn":0.4698424015535821,"grad_norm_ffn":0.4204355447083474,"grad_norm_attn_sem":0.0,"grad_norm_attn_geo":0.0,"grad_clip_total_norm":0.7343772053718567,"wall_time":"2025-12-16T14:35:21+01:00"}
{"type":"analysis","step":1100,"error":"shape '[1, 8, 256, -1]' is invalid for input of size 63360","wall_time":"2025-12-16T14:37:11+01:00"}
{"type":"train","step":1100,"loss":5.280989646911621,"ppl":196.56430838663292,"tok_s":14873.651188190197,"grad_norm_embed":0.3887784035539153,"grad_norm_attn":0.4601728127855989,"grad_norm_ffn":0.44617409915717043,"grad_norm_attn_sem":0.0,"grad_norm_attn_geo":0.0,"grad_clip_total_norm":0.7502882480621338,"wall_time":"2025-12-16T14:37:12+01:00"}
{"type":"eval","step":1200,"train_loss":5.106805896759033,"val_loss":5.095829725265503,"val_ppl":163.3393151715955,"wall_time":"2025-12-16T14:39:14+01:00"}
{"type":"analysis","step":1200,"error":"shape '[1, 8, 256, -1]' is invalid for input of size 63360","wall_time":"2025-12-16T14:39:14+01:00"}
{"type":"train","step":1200,"loss":5.216609954833984,"ppl":184.30831030351254,"tok_s":15201.728155879955,"grad_norm_embed":0.32995117725827655,"grad_norm_attn":0.38453950684864724,"grad_norm_ffn":0.3984953123112193,"grad_norm_attn_sem":0.0,"grad_norm_attn_geo":0.0,"grad_clip_total_norm":0.6452941298484802,"wall_time":"2025-12-16T14:39:15+01:00"}
{"type":"analysis","step":1300,"error":"shape '[1, 8, 256, -1]' is invalid for input of size 63360","wall_time":"2025-12-16T14:41:02+01:00"}
{"type":"train","step":1300,"loss":5.06067419052124,"ppl":157.69679817879356,"tok_s":15273.483627408772,"grad_norm_embed":0.3392411512852724,"grad_norm_attn":0.40067885013429977,"grad_norm_ffn":0.4044220570479963,"grad_norm_attn_sem":0.0,"grad_norm_attn_geo":0.0,"grad_clip_total_norm":0.6634098887443542,"wall_time":"2025-12-16T14:41:03+01:00"}
{"type":"eval","step":1400,"train_loss":5.022572565078735,"val_loss":5.040595197677613,"val_ppl":154.56198258681934,"wall_time":"2025-12-16T14:43:04+01:00"}
{"type":"analysis","step":1400,"error":"shape '[1, 8, 256, -1]' is invalid for input of size 63360","wall_time":"2025-12-16T14:43:05+01:00"}
{"type":"train","step":1400,"loss":5.016295433044434,"ppl":150.85142816998854,"tok_s":15277.895312320741,"grad_norm_embed":0.3674473350442798,"grad_norm_attn":0.4216544691569991,"grad_norm_ffn":0.4261355353341939,"grad_norm_attn_sem":0.0,"grad_norm_attn_geo":0.0,"grad_clip_total_norm":0.7037892937660217,"wall_time":"2025-12-16T14:43:06+01:00"}
{"type":"analysis","step":1500,"error":"shape '[1, 8, 256, -1]' is invalid for input of size 63360","wall_time":"2025-12-16T14:44:51+01:00"}
{"type":"train","step":1500,"loss":5.0660786628723145,"ppl":158.55137334828365,"tok_s":15489.112861743806,"grad_norm_embed":0.37113791755045583,"grad_norm_attn":0.39329290764301655,"grad_norm_ffn":0.44417691057387365,"grad_norm_attn_sem":0.0,"grad_norm_attn_geo":0.0,"grad_clip_total_norm":0.7003912329673767,"wall_time":"2025-12-16T14:44:52+01:00"}
{"type":"eval","step":1600,"train_loss":4.930933737754822,"val_loss":4.929272532463074,"val_ppl":138.2788823439232,"wall_time":"2025-12-16T14:46:52+01:00"}
{"type":"analysis","step":1600,"error":"shape '[1, 8, 256, -1]' is invalid for input of size 63360","wall_time":"2025-12-16T14:46:52+01:00"}
{"type":"train","step":1600,"loss":4.9698805809021,"ppl":144.0096888368935,"tok_s":15449.44342045764,"grad_norm_embed":0.347534897873528,"grad_norm_attn":0.45244093639130173,"grad_norm_ffn":0.45423502088919226,"grad_norm_attn_sem":0.0,"grad_norm_attn_geo":0.0,"grad_clip_total_norm":0.7301244735717773,"wall_time":"2025-12-16T14:46:53+01:00"}
{"type":"analysis","step":1700,"error":"shape '[1, 8, 256, -1]' is invalid for input of size 63360","wall_time":"2025-12-16T14:48:39+01:00"}
{"type":"train","step":1700,"loss":4.86762809753418,"ppl":130.01217469027083,"tok_s":15443.325041157494,"grad_norm_embed":0.33824309118423074,"grad_norm_attn":0.3568143805362203,"grad_norm_ffn":0.39078045314824256,"grad_norm_attn_sem":0.0,"grad_norm_attn_geo":0.0,"grad_clip_total_norm":0.6285470128059387,"wall_time":"2025-12-16T14:48:40+01:00"}
{"type":"eval","step":1800,"train_loss":4.895823192596436,"val_loss":4.863332962989807,"val_ppl":129.45495243648963,"wall_time":"2025-12-16T14:50:39+01:00"}
{"type":"analysis","step":1800,"error":"shape '[1, 8, 256, -1]' is invalid for input of size 63360","wall_time":"2025-12-16T14:50:39+01:00"}
{"type":"train","step":1800,"loss":4.942274570465088,"ppl":140.08852867846875,"tok_s":15794.672133816166,"grad_norm_embed":0.38411289365579987,"grad_norm_attn":0.48218625114485986,"grad_norm_ffn":0.48054084004405184,"grad_norm_attn_sem":0.0,"grad_norm_attn_geo":0.0,"grad_clip_total_norm":0.7826154828071594,"wall_time":"2025-12-16T14:50:40+01:00"}
{"type":"analysis","step":1900,"error":"shape '[1, 8, 256, -1]' is invalid for input of size 63360","wall_time":"2025-12-16T14:52:19+01:00"}
{"type":"train","step":1900,"loss":4.878133773803711,"ppl":131.3852403717772,"tok_s":16536.36748148337,"grad_norm_embed":0.363009053462863,"grad_norm_attn":0.4570594719809964,"grad_norm_ffn":0.4445151287358546,"grad_norm_attn_sem":0.0,"grad_norm_attn_geo":0.0,"grad_clip_total_norm":0.7346590757369995,"wall_time":"2025-12-16T14:52:20+01:00"}
{"type":"eval","step":2000,"train_loss":4.809915351867676,"val_loss":4.80823848247528,"val_ppl":122.51561392508178,"wall_time":"2025-12-16T14:54:22+01:00"}
{"type":"analysis","step":2000,"error":"shape '[1, 8, 256, -1]' is invalid for input of size 63360","wall_time":"2025-12-16T14:54:22+01:00"}
{"type":"train","step":2000,"loss":4.840160846710205,"ppl":126.48969554535635,"tok_s":15298.445817452319,"grad_norm_embed":0.34276152587364905,"grad_norm_attn":0.40236683105083876,"grad_norm_ffn":0.4049106519552483,"grad_norm_attn_sem":0.0,"grad_norm_attn_geo":0.0,"grad_clip_total_norm":0.6665821671485901,"wall_time":"2025-12-16T14:54:23+01:00"}
{"type":"analysis","step":2100,"error":"shape '[1, 8, 256, -1]' is invalid for input of size 63360","wall_time":"2025-12-16T14:56:01+01:00"}
{"type":"train","step":2100,"loss":4.767990589141846,"ppl":117.68253165926224,"tok_s":16677.658400585577,"grad_norm_embed":0.3471930557822788,"grad_norm_attn":0.4660897312759064,"grad_norm_ffn":0.4465093522874182,"grad_norm_attn_sem":0.0,"grad_norm_attn_geo":0.0,"grad_clip_total_norm":0.7339118719100952,"wall_time":"2025-12-16T14:56:02+01:00"}
{"type":"eval","step":2200,"train_loss":4.803919529914856,"val_loss":4.752621173858643,"val_ppl":115.8876484433538,"wall_time":"2025-12-16T14:58:01+01:00"}
{"type":"analysis","step":2200,"error":"shape '[1, 8, 256, -1]' is invalid for input of size 63360","wall_time":"2025-12-16T14:58:01+01:00"}
{"type":"train","step":2200,"loss":4.688397407531738,"ppl":108.67887223062135,"tok_s":15588.261256674943,"grad_norm_embed":0.38692145381455206,"grad_norm_attn":0.47933090023894764,"grad_norm_ffn":0.4761602094213322,"grad_norm_attn_sem":0.0,"grad_norm_attn_geo":0.0,"grad_clip_total_norm":0.7794803977012634,"wall_time":"2025-12-16T14:58:02+01:00"}
{"type":"analysis","step":2300,"error":"shape '[1, 8, 256, -1]' is invalid for input of size 63360","wall_time":"2025-12-16T14:59:46+01:00"}
{"type":"train","step":2300,"loss":4.741445064544678,"ppl":114.59968602668891,"tok_s":15650.159486519458,"grad_norm_embed":0.3583426367121238,"grad_norm_attn":0.4292733798454274,"grad_norm_ffn":0.4166605896183743,"grad_norm_attn_sem":0.0,"grad_norm_attn_geo":0.0,"grad_clip_total_norm":0.6982334852218628,"wall_time":"2025-12-16T14:59:47+01:00"}
{"type":"eval","step":2400,"train_loss":4.706934022903442,"val_loss":4.69497332572937,"val_ppl":109.39589054730365,"wall_time":"2025-12-16T15:01:40+01:00"}
{"type":"analysis","step":2400,"error":"shape '[1, 8, 256, -1]' is invalid for input of size 63360","wall_time":"2025-12-16T15:01:40+01:00"}
{"type":"train","step":2400,"loss":4.6874847412109375,"ppl":108.57972993295368,"tok_s":16567.353339027704,"grad_norm_embed":0.3385443785143101,"grad_norm_attn":0.4061361177244487,"grad_norm_ffn":0.41820423954591224,"grad_norm_attn_sem":0.0,"grad_norm_attn_geo":0.0,"grad_clip_total_norm":0.6748638153076172,"wall_time":"2025-12-16T15:01:41+01:00"}
{"type":"analysis","step":2500,"error":"shape '[1, 8, 256, -1]' is invalid for input of size 63360","wall_time":"2025-12-16T15:03:24+01:00"}
{"type":"train","step":2500,"loss":4.604017734527588,"ppl":99.88482123566507,"tok_s":15752.986327383453,"grad_norm_embed":0.35444859428444503,"grad_norm_attn":0.40206597209584916,"grad_norm_ffn":0.4298968942823768,"grad_norm_attn_sem":0.0,"grad_norm_attn_geo":0.0,"grad_clip_total_norm":0.6878865361213684,"wall_time":"2025-12-16T15:03:25+01:00"}
{"type":"eval","step":2600,"train_loss":4.673435759544373,"val_loss":4.6792675971984865,"val_ppl":107.69117036595506,"wall_time":"2025-12-16T15:05:22+01:00"}
{"type":"analysis","step":2600,"error":"shape '[1, 8, 256, -1]' is invalid for input of size 63360","wall_time":"2025-12-16T15:05:22+01:00"}
{"type":"train","step":2600,"loss":4.551791191101074,"ppl":94.80206494093032,"tok_s":15929.233705049268,"grad_norm_embed":0.35223271804851014,"grad_norm_attn":0.44770911986152656,"grad_norm_ffn":0.4414952929955367,"grad_norm_attn_sem":0.0,"grad_norm_attn_geo":0.0,"grad_clip_total_norm":0.7213876247406006,"wall_time":"2025-12-16T15:05:23+01:00"}
{"type":"analysis","step":2700,"error":"shape '[1, 8, 256, -1]' is invalid for input of size 63360","wall_time":"2025-12-16T15:06:59+01:00"}
{"type":"train","step":2700,"loss":4.757689952850342,"ppl":116.47654856259705,"tok_s":16879.773191304223,"grad_norm_embed":0.35352353882757076,"grad_norm_attn":0.4059576444230022,"grad_norm_ffn":0.42251475655356546,"grad_norm_attn_sem":0.0,"grad_norm_attn_geo":0.0,"grad_clip_total_norm":0.68510502576828,"wall_time":"2025-12-16T15:07:00+01:00"}
{"type":"eval","step":2800,"train_loss":4.619201016426087,"val_loss":4.639611911773682,"val_ppl":103.50417103760861,"wall_time":"2025-12-16T15:08:50+01:00"}
{"type":"analysis","step":2800,"error":"shape '[1, 8, 256, -1]' is invalid for input of size 63360","wall_time":"2025-12-16T15:08:50+01:00"}
{"type":"train","step":2800,"loss":4.821287155151367,"ppl":124.12475581980621,"tok_s":17003.511357238207,"grad_norm_embed":0.35081128287091484,"grad_norm_attn":0.4154751273609539,"grad_norm_ffn":0.4231256748420174,"grad_norm_attn_sem":0.0,"grad_norm_attn_geo":0.0,"grad_clip_total_norm":0.6898924112319946,"wall_time":"2025-12-16T15:08:51+01:00"}
{"type":"analysis","step":2900,"error":"shape '[1, 8, 256, -1]' is invalid for input of size 63360","wall_time":"2025-12-16T15:10:25+01:00"}
{"type":"train","step":2900,"loss":4.616143703460693,"ppl":101.10339473559739,"tok_s":17433.65990600238,"grad_norm_embed":0.38431363740220115,"grad_norm_attn":0.42924348791237743,"grad_norm_ffn":0.46678994434989546,"grad_norm_attn_sem":0.0,"grad_norm_attn_geo":0.0,"grad_clip_total_norm":0.7421831488609314,"wall_time":"2025-12-16T15:10:26+01:00"}
{"type":"eval","step":3000,"train_loss":4.577121829986572,"val_loss":4.636533641815186,"val_ppl":103.18604714414174,"wall_time":"2025-12-16T15:12:13+01:00"}
{"type":"analysis","step":3000,"error":"shape '[1, 8, 256, -1]' is invalid for input of size 63360","wall_time":"2025-12-16T15:12:13+01:00"}
{"type":"train","step":3000,"loss":4.591649532318115,"ppl":98.65703398091019,"tok_s":17427.217118437362,"grad_norm_embed":0.3792138375120099,"grad_norm_attn":0.4254531936822569,"grad_norm_ffn":0.446844077207479,"grad_norm_attn_sem":0.0,"grad_norm_attn_geo":0.0,"grad_clip_total_norm":0.7249571084976196,"wall_time":"2025-12-16T15:12:14+01:00"}
{"type":"analysis","step":3100,"error":"shape '[1, 8, 256, -1]' is invalid for input of size 63360","wall_time":"2025-12-16T15:13:48+01:00"}
{"type":"train","step":3100,"loss":4.44878625869751,"ppl":85.52307808958412,"tok_s":17316.436036037834,"grad_norm_embed":0.35765185018877077,"grad_norm_attn":0.4212543562973445,"grad_norm_ffn":0.4143643442992926,"grad_norm_attn_sem":0.0,"grad_norm_attn_geo":0.0,"grad_clip_total_norm":0.6915349364280701,"wall_time":"2025-12-16T15:13:49+01:00"}
{"type":"eval","step":3200,"train_loss":4.573485732078552,"val_loss":4.604637098312378,"val_ppl":99.94670543902761,"wall_time":"2025-12-16T15:15:37+01:00"}
{"type":"analysis","step":3200,"error":"shape '[1, 8, 256, -1]' is invalid for input of size 63360","wall_time":"2025-12-16T15:15:37+01:00"}
{"type":"train","step":3200,"loss":4.724532604217529,"ppl":112.6778209261408,"tok_s":17389.206626538624,"grad_norm_embed":0.35775639039922524,"grad_norm_attn":0.40731347018973796,"grad_norm_ffn":0.4426460435583054,"grad_norm_attn_sem":0.0,"grad_norm_attn_geo":0.0,"grad_clip_total_norm":0.7005516290664673,"wall_time":"2025-12-16T15:15:38+01:00"}
{"type":"analysis","step":3300,"error":"shape '[1, 8, 256, -1]' is invalid for input of size 63360","wall_time":"2025-12-16T15:17:12+01:00"}
{"type":"train","step":3300,"loss":4.495068550109863,"ppl":89.57430910342008,"tok_s":17347.3298108595,"grad_norm_embed":0.3482556052198435,"grad_norm_attn":0.40740607612134255,"grad_norm_ffn":0.42545576735255314,"grad_norm_attn_sem":0.0,"grad_norm_attn_geo":0.0,"grad_clip_total_norm":0.6851339936256409,"wall_time":"2025-12-16T15:17:13+01:00"}
{"type":"eval","step":3400,"train_loss":4.508240413665772,"val_loss":4.562557649612427,"val_ppl":95.82826177999955,"wall_time":"2025-12-16T15:19:00+01:00"}
{"type":"analysis","step":3400,"error":"shape '[1, 8, 256, -1]' is invalid for input of size 63360","wall_time":"2025-12-16T15:19:00+01:00"}
{"type":"train","step":3400,"loss":4.604340553283691,"ppl":99.91707113456604,"tok_s":17429.761416403115,"grad_norm_embed":0.361124940397496,"grad_norm_attn":0.3816902272556186,"grad_norm_ffn":0.42285233942449435,"grad_norm_attn_sem":0.0,"grad_norm_attn_geo":0.0,"grad_clip_total_norm":0.6751466989517212,"wall_time":"2025-12-16T15:19:01+01:00"}
{"type":"analysis","step":3500,"error":"shape '[1, 8, 256, -1]' is invalid for input of size 63360","wall_time":"2025-12-16T15:20:35+01:00"}
{"type":"train","step":3500,"loss":4.768662929534912,"ppl":117.76168098351741,"tok_s":17441.303067338933,"grad_norm_embed":0.369878082744699,"grad_norm_attn":0.46157373931303897,"grad_norm_ffn":0.4546801526542747,"grad_norm_attn_sem":0.0,"grad_norm_attn_geo":0.0,"grad_clip_total_norm":0.7471651434898376,"wall_time":"2025-12-16T15:20:36+01:00"}
{"type":"eval","step":3600,"train_loss":4.477907276153564,"val_loss":4.508596658706665,"val_ppl":90.79431365548803,"wall_time":"2025-12-16T15:22:23+01:00"}
{"type":"analysis","step":3600,"error":"shape '[1, 8, 256, -1]' is invalid for input of size 63360","wall_time":"2025-12-16T15:22:23+01:00"}
{"type":"train","step":3600,"loss":4.4081196784973145,"ppl":82.11491580817335,"tok_s":17435.614781616754,"grad_norm_embed":0.3926508632097625,"grad_norm_attn":0.4444705487717116,"grad_norm_ffn":0.44907776029841484,"grad_norm_attn_sem":0.0,"grad_norm_attn_geo":0.0,"grad_clip_total_norm":0.7447763085365295,"wall_time":"2025-12-16T15:22:24+01:00"}
{"type":"analysis","step":3700,"error":"shape '[1, 8, 256, -1]' is invalid for input of size 63360","wall_time":"2025-12-16T15:23:57+01:00"}
{"type":"train","step":3700,"loss":4.437965393066406,"ppl":84.60263333901078,"tok_s":17458.7354262687,"grad_norm_embed":0.4123062097619822,"grad_norm_attn":0.43112417633209743,"grad_norm_ffn":0.42813375032925416,"grad_norm_attn_sem":0.0,"grad_norm_attn_geo":0.0,"grad_clip_total_norm":0.7352108359336853,"wall_time":"2025-12-16T15:23:58+01:00"}
{"type":"eval","step":3800,"train_loss":4.484561562538147,"val_loss":4.490920996665954,"val_ppl":89.20356424274304,"wall_time":"2025-12-16T15:25:45+01:00"}
{"type":"analysis","step":3800,"error":"shape '[1, 8, 256, -1]' is invalid for input of size 63360","wall_time":"2025-12-16T15:25:45+01:00"}
{"type":"train","step":3800,"loss":4.445954322814941,"ppl":85.28122483404663,"tok_s":17481.541947439575,"grad_norm_embed":0.39385187556822787,"grad_norm_attn":0.4439383415825359,"grad_norm_ffn":0.4500753228325961,"grad_norm_attn_sem":0.0,"grad_norm_attn_geo":0.0,"grad_clip_total_norm":0.7455455660820007,"wall_time":"2025-12-16T15:25:46+01:00"}
{"type":"analysis","step":3900,"error":"shape '[1, 8, 256, -1]' is invalid for input of size 63360","wall_time":"2025-12-16T15:27:19+01:00"}
{"type":"train","step":3900,"loss":4.338403701782227,"ppl":76.58518890982633,"tok_s":17502.615934102494,"grad_norm_embed":0.36841993268997225,"grad_norm_attn":0.3903297888020269,"grad_norm_ffn":0.4274069695722912,"grad_norm_attn_sem":0.0,"grad_norm_attn_geo":0.0,"grad_clip_total_norm":0.686774492263794,"wall_time":"2025-12-16T15:27:20+01:00"}
{"type":"eval","step":4000,"train_loss":4.428047943115234,"val_loss":4.4975135087966915,"val_ppl":89.79358253659026,"wall_time":"2025-12-16T15:29:07+01:00"}
{"type":"analysis","step":4000,"error":"shape '[1, 8, 256, -1]' is invalid for input of size 63360","wall_time":"2025-12-16T15:29:07+01:00"}
{"type":"train","step":4000,"loss":4.541943550109863,"ppl":93.8730699522408,"tok_s":17499.428166689006,"grad_norm_embed":0.3764908481032715,"grad_norm_attn":0.4056975433968938,"grad_norm_ffn":0.42522132272240615,"grad_norm_attn_sem":0.0,"grad_norm_attn_geo":0.0,"grad_clip_total_norm":0.6987574696540833,"wall_time":"2025-12-16T15:29:08+01:00"}
{"type":"analysis","step":4100,"error":"shape '[1, 8, 256, -1]' is invalid for input of size 63360","wall_time":"2025-12-16T15:30:41+01:00"}
{"type":"train","step":4100,"loss":4.424128532409668,"ppl":83.4400602201008,"tok_s":17597.643352366238,"grad_norm_embed":0.35764195488209133,"grad_norm_attn":0.4057126793749807,"grad_norm_ffn":0.4118414579718172,"grad_norm_attn_sem":0.0,"grad_norm_attn_geo":0.0,"grad_clip_total_norm":0.6807594895362854,"wall_time":"2025-12-16T15:30:42+01:00"}
{"type":"eval","step":4200,"train_loss":4.436781501770019,"val_loss":4.474098491668701,"val_ppl":87.71548851141803,"wall_time":"2025-12-16T15:32:28+01:00"}
{"type":"analysis","step":4200,"error":"shape '[1, 8, 256, -1]' is invalid for input of size 63360","wall_time":"2025-12-16T15:32:28+01:00"}
{"type":"train","step":4200,"loss":4.273301124572754,"ppl":71.75812757799085,"tok_s":17472.793712518847,"grad_norm_embed":0.33996744206861834,"grad_norm_attn":0.40848895528550977,"grad_norm_ffn":0.4142847353213925,"grad_norm_attn_sem":0.0,"grad_norm_attn_geo":0.0,"grad_clip_total_norm":0.6746768951416016,"wall_time":"2025-12-16T15:32:29+01:00"}
{"type":"analysis","step":4300,"error":"shape '[1, 8, 256, -1]' is invalid for input of size 63360","wall_time":"2025-12-16T15:34:02+01:00"}
{"type":"train","step":4300,"loss":4.390501976013184,"ppl":80.68090869808158,"tok_s":17549.160063913037,"grad_norm_embed":0.3464600848055985,"grad_norm_attn":0.3999579800318092,"grad_norm_ffn":0.4045078422836215,"grad_norm_attn_sem":0.0,"grad_norm_attn_geo":0.0,"grad_clip_total_norm":0.6668870449066162,"wall_time":"2025-12-16T15:34:03+01:00"}
{"type":"eval","step":4400,"train_loss":4.435110688209534,"val_loss":4.441284561157227,"val_ppl":84.88391024442089,"wall_time":"2025-12-16T15:35:50+01:00"}
{"type":"analysis","step":4400,"error":"shape '[1, 8, 256, -1]' is invalid for input of size 63360","wall_time":"2025-12-16T15:35:50+01:00"}
{"type":"train","step":4400,"loss":4.563146591186523,"ppl":95.88471564971888,"tok_s":17528.491824147433,"grad_norm_embed":0.3768804608608903,"grad_norm_attn":0.44399423373807967,"grad_norm_ffn":0.42944773790513985,"grad_norm_attn_sem":0.0,"grad_norm_attn_geo":0.0,"grad_clip_total_norm":0.7248614430427551,"wall_time":"2025-12-16T15:35:51+01:00"}
{"type":"analysis","step":4500,"error":"shape '[1, 8, 256, -1]' is invalid for input of size 63360","wall_time":"2025-12-16T15:37:24+01:00"}
{"type":"train","step":4500,"loss":4.496275901794434,"ppl":89.68252210884236,"tok_s":17571.117526674756,"grad_norm_embed":0.3753183126515611,"grad_norm_attn":0.4102304663209619,"grad_norm_ffn":0.43315325197092314,"grad_norm_attn_sem":0.0,"grad_norm_attn_geo":0.0,"grad_clip_total_norm":0.7055952548980713,"wall_time":"2025-12-16T15:37:25+01:00"}
{"type":"eval","step":4600,"train_loss":4.394544196128845,"val_loss":4.454174947738648,"val_ppl":85.98517930492112,"wall_time":"2025-12-16T15:39:11+01:00"}
{"type":"analysis","step":4600,"error":"shape '[1, 8, 256, -1]' is invalid for input of size 63360","wall_time":"2025-12-16T15:39:11+01:00"}
{"type":"train","step":4600,"loss":4.299762725830078,"ppl":73.68230871667176,"tok_s":17585.18451867485,"grad_norm_embed":0.36867174514344636,"grad_norm_attn":0.4157942519546793,"grad_norm_ffn":0.43973917711067784,"grad_norm_attn_sem":0.0,"grad_norm_attn_geo":0.0,"grad_clip_total_norm":0.7095298767089844,"wall_time":"2025-12-16T15:39:12+01:00"}
{"type":"analysis","step":4700,"error":"shape '[1, 8, 256, -1]' is invalid for input of size 63360","wall_time":"2025-12-16T15:40:45+01:00"}
{"type":"train","step":4700,"loss":4.446153163909912,"ppl":85.29818393220002,"tok_s":17567.57830267612,"grad_norm_embed":0.34991071277418584,"grad_norm_attn":0.4330043388624865,"grad_norm_ffn":0.4310860744927125,"grad_norm_attn_sem":0.0,"grad_norm_attn_geo":0.0,"grad_clip_total_norm":0.7050836086273193,"wall_time":"2025-12-16T15:40:46+01:00"}
{"type":"eval","step":4800,"train_loss":4.417576622962952,"val_loss":4.3938223361969,"val_ppl":80.94924361266386,"wall_time":"2025-12-16T15:42:32+01:00"}
{"type":"analysis","step":4800,"error":"shape '[1, 8, 256, -1]' is invalid for input of size 63360","wall_time":"2025-12-16T15:42:32+01:00"}
{"type":"train","step":4800,"loss":4.309318542480469,"ppl":74.38977818997299,"tok_s":17606.404266611495,"grad_norm_embed":0.36067619277715623,"grad_norm_attn":0.4386261373120775,"grad_norm_ffn":0.43190606292778244,"grad_norm_attn_sem":0.0,"grad_norm_attn_geo":0.0,"grad_clip_total_norm":0.714328944683075,"wall_time":"2025-12-16T15:42:33+01:00"}
{"type":"analysis","step":4900,"error":"shape '[1, 8, 256, -1]' is invalid for input of size 63360","wall_time":"2025-12-16T15:44:06+01:00"}
{"type":"train","step":4900,"loss":4.269660949707031,"ppl":71.4973902981328,"tok_s":17628.776637830742,"grad_norm_embed":0.37336753125889405,"grad_norm_attn":0.42750931435818945,"grad_norm_ffn":0.43617413453608883,"grad_norm_attn_sem":0.0,"grad_norm_attn_geo":0.0,"grad_clip_total_norm":0.7167688608169556,"wall_time":"2025-12-16T15:44:07+01:00"}
{"type":"eval","step":5000,"train_loss":4.359776973724365,"val_loss":4.393133234977722,"val_ppl":80.8934806055836,"wall_time":"2025-12-16T15:45:53+01:00"}
{"type":"analysis","step":5000,"error":"shape '[1, 8, 256, -1]' is invalid for input of size 63360","wall_time":"2025-12-16T15:45:53+01:00"}
{"type":"train","step":5000,"loss":4.704531669616699,"ppl":110.44654735941627,"tok_s":17649.06897678507,"grad_norm_embed":0.3958863883685554,"grad_norm_attn":0.4527467420577305,"grad_norm_ffn":0.46900482056355897,"grad_norm_attn_sem":0.0,"grad_norm_attn_geo":0.0,"grad_clip_total_norm":0.76369309425354,"wall_time":"2025-12-16T15:45:54+01:00"}
{"type":"analysis","step":5100,"error":"shape '[1, 8, 256, -1]' is invalid for input of size 63360","wall_time":"2025-12-16T15:47:26+01:00"}
{"type":"train","step":5100,"loss":4.332212448120117,"ppl":76.11249537125077,"tok_s":17625.87023869924,"grad_norm_embed":0.37199535265578126,"grad_norm_attn":0.4197671644288543,"grad_norm_ffn":0.42649120780424354,"grad_norm_attn_sem":0.0,"grad_norm_attn_geo":0.0,"grad_clip_total_norm":0.7055444121360779,"wall_time":"2025-12-16T15:47:27+01:00"}
{"type":"eval","step":5200,"train_loss":4.313018798828125,"val_loss":4.3882030010223385,"val_ppl":80.49563835429005,"wall_time":"2025-12-16T15:49:13+01:00"}
{"type":"analysis","step":5200,"error":"shape '[1, 8, 256, -1]' is invalid for input of size 63360","wall_time":"2025-12-16T15:49:14+01:00"}
{"type":"train","step":5200,"loss":4.3412346839904785,"ppl":76.80230740133166,"tok_s":17578.61276778747,"grad_norm_embed":0.3378216447042378,"grad_norm_attn":0.38336144827496826,"grad_norm_ffn":0.40783499300794585,"grad_norm_attn_sem":0.0,"grad_norm_attn_geo":0.0,"grad_clip_total_norm":0.6544680595397949,"wall_time":"2025-12-16T15:49:14+01:00"}
{"type":"analysis","step":5300,"error":"shape '[1, 8, 256, -1]' is invalid for input of size 63360","wall_time":"2025-12-16T15:50:47+01:00"}
{"type":"train","step":5300,"loss":4.211545467376709,"ppl":67.46071762597354,"tok_s":17637.028321554004,"grad_norm_embed":0.3492650302200465,"grad_norm_attn":0.42616600296009705,"grad_norm_ffn":0.4215897328563786,"grad_norm_attn_sem":0.0,"grad_norm_attn_geo":0.0,"grad_clip_total_norm":0.6948772072792053,"wall_time":"2025-12-16T15:50:48+01:00"}
{"type":"eval","step":5400,"train_loss":4.311022186279297,"val_loss":4.350816011428833,"val_ppl":77.54171203898646,"wall_time":"2025-12-16T15:52:34+01:00"}
{"type":"analysis","step":5400,"error":"shape '[1, 8, 256, -1]' is invalid for input of size 63360","wall_time":"2025-12-16T15:52:34+01:00"}
{"type":"train","step":5400,"loss":4.305427551269531,"ppl":74.10089061084311,"tok_s":17595.894008860756,"grad_norm_embed":0.35912575578726225,"grad_norm_attn":0.40520793778991043,"grad_norm_ffn":0.42519999833563,"grad_norm_attn_sem":0.0,"grad_norm_attn_geo":0.0,"grad_clip_total_norm":0.6892014741897583,"wall_time":"2025-12-16T15:52:35+01:00"}
{"type":"analysis","step":5500,"error":"shape '[1, 8, 256, -1]' is invalid for input of size 63360","wall_time":"2025-12-16T15:54:08+01:00"}
{"type":"train","step":5500,"loss":4.220209121704102,"ppl":68.04771305531027,"tok_s":17647.59177978366,"grad_norm_embed":0.37591698905312554,"grad_norm_attn":0.4143743925342233,"grad_norm_ffn":0.44197442454803987,"grad_norm_attn_sem":0.0,"grad_norm_attn_geo":0.0,"grad_clip_total_norm":0.7138540148735046,"wall_time":"2025-12-16T15:54:09+01:00"}
{"type":"eval","step":5600,"train_loss":4.2927991390228275,"val_loss":4.334959006309509,"val_ppl":76.32183011215675,"wall_time":"2025-12-16T15:55:56+01:00"}
{"type":"analysis","step":5600,"error":"shape '[1, 8, 256, -1]' is invalid for input of size 63360","wall_time":"2025-12-16T15:55:56+01:00"}
{"type":"train","step":5600,"loss":4.411770343780518,"ppl":82.41523773442098,"tok_s":17429.02807707693,"grad_norm_embed":0.35103636684812817,"grad_norm_attn":0.4342808919319504,"grad_norm_ffn":0.42285967801435626,"grad_norm_attn_sem":0.0,"grad_norm_attn_geo":0.0,"grad_clip_total_norm":0.7016597986221313,"wall_time":"2025-12-16T15:55:57+01:00"}
{"type":"analysis","step":5700,"error":"shape '[1, 8, 256, -1]' is invalid for input of size 63360","wall_time":"2025-12-16T15:57:30+01:00"}
{"type":"train","step":5700,"loss":4.272027015686035,"ppl":71.6667581296229,"tok_s":17427.541208713872,"grad_norm_embed":0.36033202327695385,"grad_norm_attn":0.4060458975598942,"grad_norm_ffn":0.41733028487885193,"grad_norm_attn_sem":0.0,"grad_norm_attn_geo":0.0,"grad_clip_total_norm":0.6857116222381592,"wall_time":"2025-12-16T15:57:31+01:00"}
{"type":"eval","step":5800,"train_loss":4.276241326332093,"val_loss":4.33490834236145,"val_ppl":76.31796344487131,"wall_time":"2025-12-16T15:59:18+01:00"}
{"type":"analysis","step":5800,"error":"shape '[1, 8, 256, -1]' is invalid for input of size 63360","wall_time":"2025-12-16T15:59:19+01:00"}
{"type":"train","step":5800,"loss":4.1885833740234375,"ppl":65.92932757664931,"tok_s":17490.55616317234,"grad_norm_embed":0.41177748925236735,"grad_norm_attn":0.44749879350971394,"grad_norm_ffn":0.4738654725356071,"grad_norm_attn_sem":0.0,"grad_norm_attn_geo":0.0,"grad_clip_total_norm":0.7720212936401367,"wall_time":"2025-12-16T15:59:19+01:00"}
{"type":"analysis","step":5900,"error":"shape '[1, 8, 256, -1]' is invalid for input of size 63360","wall_time":"2025-12-16T16:00:53+01:00"}
{"type":"train","step":5900,"loss":4.285787582397461,"ppl":72.65974973064708,"tok_s":17480.72389205644,"grad_norm_embed":0.35670491001652194,"grad_norm_attn":0.41284646320486545,"grad_norm_ffn":0.4150342840031816,"grad_norm_attn_sem":0.0,"grad_norm_attn_geo":0.0,"grad_clip_total_norm":0.6863793730735779,"wall_time":"2025-12-16T16:00:54+01:00"}
{"type":"eval","step":6000,"train_loss":4.254402732849121,"val_loss":4.34056978225708,"val_ppl":76.75125838718121,"wall_time":"2025-12-16T16:02:41+01:00"}
{"type":"analysis","step":6000,"error":"shape '[1, 8, 256, -1]' is invalid for input of size 63360","wall_time":"2025-12-16T16:02:41+01:00"}
